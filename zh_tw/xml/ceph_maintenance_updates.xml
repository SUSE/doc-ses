<?xml version="1.0" encoding="UTF-8"?>
<appendix xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_maintenance_updates.xml" version="5.0">
 <title>以上游「Nautilus」小數點版本為基礎的 Ceph 維護更新</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/master/xml/</dm:editurl>
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>編輯</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  SUSE Enterprise Storage 6 中的幾個關鍵套件均以 Ceph 的 Nautilus 版本系列為基礎。當 Ceph 專案 (<link xlink:href="https://github.com/ceph/ceph"/>) 在 Nautilus 系列中發佈新的小數點版本時，SUSE Enterprise Storage 6 即會更新，以確保產品套用最新的上游錯誤修復並可進行功能向後移植。
 </para>
 <para>
  本章簡要介紹有關已經或計劃在產品中包含的每個上游小數點版本中的重要變更。
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.4 小數點版本</bridgehead>
 <para>
  此小數點版本修復了 14.2.3 小數點版本中發現的一個嚴重的迴歸問題。此迴歸問題未對 SUSE Enterprise Storage 客戶產生影響，因為我們未隨附以 14.2.3 為基礎的版本。
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.3 小數點版本</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    修復了拒絕服務弱點，如果存在該弱點，Ceph 物件閘道的未驗證用戶端可能會觸發未擷取的例外所導致的當機。
   </para>
  </listitem>
  <listitem>
   <para>
    現在，以 Nautilus 為基礎的 librbd 用戶端可以開啟 Jewel 叢集上的影像。
   </para>
  </listitem>
  <listitem>
   <para>
    已移除物件閘道 <option>num_rados_handles</option>。如果您之前使用的 <option>num_rados_handles</option> 值大於 1，將目前的 <option>objecter_inflight_ops</option> 和 <option>objecter_inflight_op_bytes</option> 參數與 <option>num_rados_handles</option> 以前的值相乘，即可設定相同的節流行為。
   </para>
  </listitem>
  <listitem>
   <para>
    在此版本中，Messenger v2 通訊協定的安全模式不再是實驗性的。現在，此模式是偏好的監控程式連接模式。
   </para>
  </listitem>
  <listitem>
   <para>
    <option>osd_deep_scrub_large_omap_object_key_threshold</option> 已降低，以便更輕鬆地偵測儲存了大量 omap 鍵的物件。
   </para>
  </listitem>
  <listitem>
   <para>
    Ceph Dashboard 現在支援將 Prometheus 通知設為靜默模式。
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Nautilus 14.2.2 小數點版本</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    已修改 <literal>no{up,down,in,out}</literal> 相關指令。現在可使用以下兩種方式來設定 <literal>no{up,down,in,out}</literal> 旗標：一種是舊指令
   </para>
<screen>ceph osd [un]set <replaceable>FLAG</replaceable></screen>
   <para>
    該指令可設定叢集範圍的旗標；另一種是新指令
   </para>
<screen>ceph osd [un]set-group <replaceable>FLAGS</replaceable> <replaceable>WHO</replaceable></screen>
   <para>
    該指令能以任何 CRUSH 節點或裝置類別的細粒度大量設定旗標。
   </para>
  </listitem>
  <listitem>
   <para>
    <command>radosgw-admin</command> 引入了兩個子指令，用來管理對較早版本物件閘道中進行桶重新分區後可能遺留的過時物件的廢棄。其中一個子指令可列出此類物件，而另一個子指令可將其刪除。
   </para>
  </listitem>
  <listitem>
   <para>
    較早的 Nautilus 版本 (14.2.1 和 14.2.0) 存在如下問題：如果在升級後的叢集 (即最初是在 Nautilus 之前部署的叢集) 上部署一個新的 Nautilus BlueStore OSD，將會損壞 <command>ceph df</command> 報告的池利用統計資料。在您透過 <command>ceph-bluestore-tool repair</command> 重新佈建或更新所有 OSD 之前，池統計資料顯示的值將低於實際值。14.2.2 版本解決了此問題，因此，僅當<emphasis>所有</emphasis> OSD 均為 14.2.2 或更新版本 (即區塊儲存)，並且已透過修復功能更新 (如果它們是在 Nautilus 之前建立的) 後，叢集才會轉為使用更準確的基於池的統計資料。
   </para>
  </listitem>
  <listitem>
   <para>
    <option>mon_crush_min_required_version</option> 的預設值已由 <literal>firefly</literal> 變更為 <literal>hammer</literal>，這表示如果您的 CRUSH 可調參數比 Hammer 舊，叢集將發出狀態警告。在轉為使用 Hammer 可調參數時，一般將會重新平衡少量 (但並非零) 資料。
   </para>
   <para>
    如果可能，建議您將允許的最舊用戶端設定為 <literal>hammer</literal> 或更新版本。若要顯示目前允許的最舊用戶端，請執行以下指令：
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph osd dump | grep min_compat_client</screen>
   <para>
    如果目前值比 <literal>hammer</literal> 舊，請執行以下指令以確認有無比目前連接至叢集的 Hammer 更舊的用戶端，據此判斷進行此變更是否安全：
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph features</screen>
   <para>
    Hammer 中引入了更新的 <literal>straw2</literal> CRUSH 桶類型。如果您確認所有用戶端均為 Hammer 或更新版本，便可使用僅適用於 <literal>straw2</literal> 桶的新功能，包括平衡器的 <literal>crush-compat</literal> 模式 (<xref linkend="mgr-modules-balancer"/>)。
   </para>
  </listitem>
 </itemizedlist>
 <para>
  如需修補程式的詳細資訊，請造訪 <link xlink:href="https://download.suse.com/Download?buildid=D38A7mekBz4~"/>
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.1 小數點版本</bridgehead>
 <para>
  這是原始 Nautilus 版本 (14.2.0) 之後的第一個小數點版本。SUSE Enterprise Storage 6 的原始 (「正式版本」或「GA」) 版本以此小數點版本為基礎。
 </para>
</appendix>
