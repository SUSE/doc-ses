<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ceph_faqs.xml" version="5.0" xml:id="storage-faqs">
 <title>常見問答集</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>是</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para/>
 <sect1 xml:id="storage-bp-tuneups-pg-num">
  <title>放置群組數量對叢集的效能有何影響？</title>

  <para>
   當叢集空間的 70% 至 80% 已填滿時，便有必要新增更多的 OSD 至其中。增加 OSD 的數量時，可以考慮同時增加放置群組的數量。
  </para>

  <warning>
   <para>
    變更放置群組 (PG) 的數量會導致在叢集中傳輸大量的資料。
   </para>
  </warning>

  <para>
   為最近調整大小的叢集計算最佳值是一項複雜的任務。
  </para>

  <para>
   如果 PG 數量較大，將會建立一些較小的資料區塊。在發生 OSD 故障後，這樣可以加快復原速度，但同時會對監控程式節點施加大量的負荷，因為這些節點負責計算資料位置。
  </para>

  <para>
   另一方面，如果 PG 數量較小，則發生 OSD 故障後，復原系統所需的時間和資料傳輸量就會增加，但不會對監控程式節點施加如此多的負荷，因為需要由這些節點計算位置的資料區塊更少 (但更大)。
  </para>

  <para>
   如需叢集最佳 PG 數量的詳細資訊，請參閱<xref linkend="op-pgs-pg-num"/>。
  </para>
 </sect1>
 <sect1 xml:id="storage-bp-tuneups-mix-ssd">
  <title>是否可以在同一叢集上使用 SSD 和普通硬碟？</title>

  <para>
   一般而言，固態硬碟 (SSD) 的速度比普通硬碟要快。如果對同一寫入操作混用這兩種磁碟，SSD 磁碟的資料寫入速度將會因普通硬碟的效能限制而減慢。因此，對於遵循<emphasis>相同規則</emphasis>的資料寫入操作，<emphasis>切勿混用 SSD 和普通硬碟</emphasis> (如需資料儲存規則的詳細資訊，請參閱<xref linkend="datamgm-rules"/>)。
  </para>

  <para>
   以下兩種情況通常適合在同一叢集上使用 SSD 和普通硬碟：
  </para>

  <orderedlist spacing="normal">
   <listitem>
    <para>
     針對遵循不同規則的資料寫入操作使用各自的磁碟類型。然後，您需要針對 SSD 磁碟和普通硬碟分別使用不同的規則。
    </para>
   </listitem>
   <listitem>
    <para>
     針對特定目的使用各自的磁碟類型。例如，將 SSD 磁碟用於記錄，將普通硬碟用於儲存資料。
    </para>
   </listitem>
  </orderedlist>
 </sect1>
 <sect1 xml:id="storage-bp-tuneups-ssd-tradeoffs">
  <title>在 SSD 上使用記錄存在哪些利弊？</title>

  <para>
   為 OSD 記錄使用 SSD 有助於提高效能，因為在僅包含普通硬碟的 OSD 中，記錄通常會成為瓶頸。SSD 往往用於共用多個 OSD 的記錄。
  </para>

  <para>
   以下列出使用 SSD 來進行 OSD 記錄的潛在不利因素：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     SSD 磁碟比普通硬碟更昂貴。但是，由於一個 OSD 記錄最多只需要 6GB 磁碟空間，因此價格因素並不那麼重要。
    </para>
   </listitem>
   <listitem>
    <para>
     SSD 磁碟會佔用儲存插槽，而大容量普通硬碟可以利用這些插槽來延伸叢集容量。
    </para>
   </listitem>
   <listitem>
    <para>
     與普通硬碟相比，SSD 磁碟的寫入週期更少，但最新的技術有望解決該問題。
    </para>
   </listitem>
   <listitem>
    <para>
     如果是在同一部 SSD 磁碟上共用多個記錄，則在 SSD 磁碟發生故障後，將會面臨遺失所有相關 OSD 的風險。在這種情況下，將需要移動大量資料來重新平衡叢集。
    </para>
   </listitem>
   <listitem>
    <para>
     熱插拔磁碟變得更複雜，因為有故障的 OSD 與記錄磁碟之間不存在一對一的資料對應關係。
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="storage-bp-monitoring-diskfails">
  <title>磁碟出現故障時，會發生什麼情況？</title>

  <para>
   當某個儲存叢集資料的磁碟出現硬體問題而無法正常運作時，會發生以下情況：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     相關的 OSD 將會當機，並自動從叢集中移除。
    </para>
   </listitem>
   <listitem>
    <para>
     有故障磁碟的資料會從其他 OSD 中儲存的相同資料的其他副本複製到叢集中的另一個 OSD。
    </para>
   </listitem>
   <listitem>
    <para>
     然後，您應該從叢集的 CRUSH 地圖中移除該磁碟，並從主機硬體中移除其實體。
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="storage-bp-monitoring-journalfails">
  <title>記錄磁碟出現故障時，會發生什麼情況？</title>

  <para>
   可將 Ceph 設定為在獨立於 OSD 的裝置上儲存記錄或預寫式記錄。如果專用於記錄的磁碟發生故障，相關的 OSD 也會發生故障 (請參閱<xref linkend="storage-bp-monitoring-diskfails"/>)。
  </para>

  <warning>
   <title>在一個磁碟上代管多個記錄</title>
   <para>
    若要大幅提升效能，可以使用高速磁碟 (例如 SSD) 來儲存多個 OSD 的記錄分割區。不建議在一個磁碟上代管 4 個以上 OSD 的記錄，因為一旦記錄磁碟發生故障，您就會面臨所有相關 OSD 磁碟儲存的資料都將遺失的風險。
   </para>
  </warning>
 </sect1>
</chapter>
