<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="runtime_config.xml" version="5.0" xml:id="cha-ceph-configuration">
 <title>Ceph 叢集組態</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>是</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  本章提供重要的 Ceph 叢集設定及其描述清單。設定依主題排序。
 </para>
 <sect1 xml:id="ceph-config-runtime">
  <title>執行時期組態</title>

  <para>
   <xref linkend="ds-custom-cephconf"/>介紹如何對 Ceph 組態檔案 <filename>ceph.conf</filename> 進行變更。但是，實際的叢集行為並不是由 <filename>ceph.conf</filename> 檔案的目前狀態決定，而是由執行中 Ceph 精靈的組態 (儲存在記憶體中) 決定。
  </para>

  <para>
   若要查詢個別 Ceph 精靈以瞭解特定的組態設定，您可以在執行精靈的節點上使用 <emphasis>admin socket</emphasis>。例如，以下指令可從名為 <literal>osd.0</literal> 的精靈獲取 <option>osd_max_write_size</option> 組態參數的值：
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph --admin-daemon /var/run/ceph/ceph-osd.0.asok \
config get osd_max_write_size
{
  "osd_max_write_size": "90"
}</screen>

  <para>
   您還可以在執行時期<emphasis>變更</emphasis>精靈的設定。請注意，此變更是暫時性的，精靈下次重新啟動時，變更將會遺失。例如，以下指令可針對叢集中的所有 OSD 將 <option>osd_max_write_size</option> 參數變更為「50」：
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph tell osd.* injectargs --osd_max_write_size 50</screen>

  <warning>
   <title><command>injectargs</command> 並非百分百可靠</title>
   <para>
    有時，使用 <command>injectargs</command> 指令可能無法成功變更叢集設定。如果您需要確保變更的參數生效，請在叢集所有節點上的組態檔案中進行變更，並重新啟動叢集中的所有精靈。
   </para>
  </warning>
 </sect1>
 <sect1 xml:id="config-osd-and-bluestore">


  <title>Ceph OSD 和 BlueStore</title>

  <sect2 xml:id="config-auto-cache-sizing">
   <title>自動調整快取大小</title>
   <para>
    如果 <option>tc_malloc</option> 設定為記憶體配置器並且啟用了 <option>bluestore_cache_autotune</option> 設定，可將 BlueStore 設定為自動調整其快取大小。目前，此選項預設處於啟用狀態。BlueStore 會嘗試將 OSD 堆積記憶體使用率維持在 <option>osd_memory_target</option> 組態選項指定的目標大小之下。這是一種最優演算法，而且快取不會縮減到小於 <option>osd_memory_cache_min</option> 所指定的大小。系統將依據優先程度的階層選擇快取率。如果無法獲取優先程度資訊，將使用 <option>bluestore_cache_meta_ratio</option> 和 <option>bluestore_cache_kv_ratio</option> 選項做為備選。
   </para>
   <variablelist>
    <varlistentry>
     <term>bluestore_cache_autotune</term>
     <listitem>
      <para>
       在遵循最小值的要求下，自動調整為不同 BlueStore 快取指定的比率。預設值為 <option>True</option>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_target</term>
     <listitem>
      <para>
       如果啟用了 <option>tc_malloc</option> 和 <option>bluestore_cache_autotune</option>，該選項將嘗試在記憶體中對應此數量的位元組。
      </para>
      <note>
       <para>
        此數量可能與程序的 RSS 記憶體使用率並不完全相符。雖然程序對應的堆積記憶體總量一般應該保持為接近此目標的數量，但並不能保證核心會真正收回已取消對應的記憶體。
       </para>
      </note>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_cache_min</term>
     <listitem>
      <para>
       如果啟用了 <option>tc_malloc</option> 和 <option>bluestore_cache_autotune</option>，該選項可設定用於快取的最小記憶體量。
      </para>
      <note>
       <para>
        將此值設定得過小可能會導致嚴重的快取猛移。
       </para>
      </note>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 xml:id="config-ogw">
  <title>Ceph 物件閘道</title>

  <para>
   您可以使用 <filename>/etc/ceph/ceph.conf</filename> 檔案中以下區段下的幾個選項來控制物件閘道行為：
  </para>

<screen>
[client.radosgw.<replaceable>INSTANCE_NAME</replaceable>]
</screen>

  <para>
   如果未指定選項，將使用預設值。完整的物件閘道選項清單如下：
  </para>



  <sect2>
   <title>一般設定</title>
   <variablelist>
    <varlistentry>
     <term>rgw_frontends</term>
     <listitem>
      <para>
       設定 HTTP 前端。請以逗號分隔的清單指定多個前端。每個前端組態可能包含一組以空格分隔的選項，每個選項的格式均為「鍵=值」或「鍵」。預設為
      </para>
<screen>
rgw_frontends = beast port=7480
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data</term>
     <listitem>
      <para>
       為物件閘道設定資料檔案的位置。預設值為 <filename>/var/lib/ceph/radosgw/<replaceable>CLUSTER_ID</replaceable></filename>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_apis</term>
     <listitem>
      <para>
       啟用指定的 API。預設值為「s3, swift, swift_auth, admin All APIs」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_enabled</term>
     <listitem>
      <para>
       啟用或停用物件閘道快取。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_lru_size</term>
     <listitem>
      <para>
       物件閘道快取中的項目數。預設值為 10000。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_socket_path</term>
     <listitem>
      <para>
       網域通訊端的通訊端路徑。<option>FastCgiExternalServer</option> 使用此通訊端。如果您未指定通訊端路徑，物件閘道將不會做為外部伺服器執行。您在此處指定的路徑須與 <filename>rgw.conf</filename> 檔案中指定的路徑相同。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_fcgi_socket_backlog</term>
     <listitem>
      <para>
       fcgi 的通訊端積存資料。預設值為 1024。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_host</term>
     <listitem>
      <para>
       物件閘道例項的主機，可以是 IP 位址或主機名稱。預設值為 0.0.0.0
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_port</term>
     <listitem>
      <para>
       例項用於監聽要求的連接埠號碼。如果未指定，物件閘道將執行外部 FastCGI。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_dns_name</term>
     <listitem>
      <para>
       所處理的網域的 DNS 名稱。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_script_uri</term>
     <listitem>
      <para>
       如果要求中未設定 SCRIPT_URI，則做為其備用值。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_request_uri</term>
     <listitem>
      <para>
       如果要求中未設定 REQUEST_URI，則做為其備用值。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_print_continue</term>
     <listitem>
      <para>
       啟用 100-continue (如果可正常運作)。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_remote_addr_param</term>
     <listitem>
      <para>
       遠端位址參數。例如，包含遠端位址的 HTTP 欄位或 X-Forwarded-For 位址 (如果反向代理可正常運作)。預設值為 REMOTE_ADDR。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_timeout</term>
     <listitem>
      <para>
       開啟的線串的逾時 (以秒計)。預設值為 600。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_suicide_timeout</term>
     <listitem>
      <para>
       物件閘道程序停止前逾時的時間 (以秒計)。如果設定為 0 (預設值)，則表示停用。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_thread_pool_size</term>
     <listitem>
      <para>
       Beast 伺服器的線串數。如果需要處理更多要求，請設定更高的值。預設為 100 個線串。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_rados_handles</term>
     <listitem>
      <para>
       物件閘道的 RADOS 叢集控制代碼數量。現在，每個物件閘道工作線串都可以選取一個 RADOS 控制代碼並在其有效期內保留。未來版本中可能會取代並移除此選項。預設值為 1。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_control_oids</term>
     <listitem>
      <para>
       不同 rgw 例項之間用於快取同步的通知物件數量。預設值為 8。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_init_timeout</term>
     <listitem>
      <para>
       物件閘道放棄啟始化前經過的秒數。預設值為 30。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_mime_types_file</term>
     <listitem>
      <para>
       MIME 類型的路徑和位置。用於物件類型的 Swift 自動偵測。預設值為 <filename>/etc/mime.types</filename>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_max_objs</term>
     <listitem>
      <para>
       垃圾回收在一個垃圾回收處理週期內可處理的最大物件數量。預設值為 32。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_obj_min_wait</term>
     <listitem>
      <para>
       垃圾回收處理可移除和處理物件前需等待的最短時間。預設值為 2 * 3600。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_max_time</term>
     <listitem>
      <para>
       兩次連續的垃圾回收處理週期開始時所間隔的最長時間。預設值為 3600。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_period</term>
     <listitem>
      <para>
       垃圾回收處理的週期時間。預設值為 3600。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_s3_success_create_obj_status</term>
     <listitem>
      <para>
       <literal>create-obj</literal> 的備用成功狀態回應。預設值為 0。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_resolve_cname</term>
     <listitem>
      <para>
       物件閘道是否應使用要求主機名稱欄位的 DNS CNAME 記錄 (如果主機名稱與物件閘道 DNS 名稱不同)。預設值為「false」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_obj_stripe_size</term>
     <listitem>
      <para>
       物件閘道物件的物件分割大小。預設值為 4 &lt;&lt; 20。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_extended_http_attrs</term>
     <listitem>
      <para>
       新增可對實體 (例如，使用者、桶或物件) 設定的一組新屬性。使用 POST 方法放置或修改實體時，可透過 HTTP 標題欄位設定這些額外的屬性。如果設定了這些屬性，當對實體發出 GET/HEAD 要求時，它們將做為 HTTP 欄位傳回。預設值為「content_foo, content_bar, x-foo-bar」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_exit_timeout_secs</term>
     <listitem>
      <para>
       無條件結束前等待程序的秒數。預設值為 120。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_window_size</term>
     <listitem>
      <para>
       單個物件要求的視窗大小 (以位元組計)。預設值為「16 &lt;&lt; 20」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_max_req_size</term>
     <listitem>
      <para>
       傳送到 Ceph 儲存叢集的單次 GET 操作的要求大小上限。預設值為 4 &lt;&lt; 20。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_relaxed_s3_bucket_names</term>
     <listitem>
      <para>
       為 US 區域桶啟用寬鬆 S3 桶名稱規則。預設值為「false」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_list_buckets_max_chunk</term>
     <listitem>
      <para>
       列出使用者桶時，在一次操作中擷取的桶數量上限。預設值為 1000。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_override_bucket_index_max_shards</term>
     <listitem>
      <para>
       表示桶索引物件的分區數量。設為 0 (預設值) 表示沒有分區。不建議將此值設定得太大 (例如 1000)，因為這樣會增加列出桶的成本。應在用戶端或全域區段中設定此變數，以便將其自動套用至 <command>radosgw-admin</command> 指令。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_curl_wait_timeout_ms</term>
     <listitem>
      <para>
       某些 <command>curl</command> 呼叫的逾時時間 (以毫秒計)。預設值為 1000。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress</term>
     <listitem>
      <para>
       啟用在費時較長的複製操作期間輸出物件進度的功能。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress_every_bytes</term>
     <listitem>
      <para>
       兩次複製進度輸出相隔的最小位元組數。預設值為 1024 * 1024。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_admin_entry</term>
     <listitem>
      <para>
       管理要求 URL 的進入點。預設值為「admin」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_content_length_compat</term>
     <listitem>
      <para>
       為設定了 CONTENT_LENGTH 和 HTTP_CONTENT_LENGTH 的 FCGI 要求啟用相容性處理。預設值為「false」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_quota_ttl</term>
     <listitem>
      <para>
       已快取定額資訊的受信任時長 (以秒計)。經過此逾時時間後，將從叢集重新擷取定額資訊。預設值為 600。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_bucket_sync_interval</term>
     <listitem>
      <para>
       同步到叢集前，桶定額資訊的累計時長 (以秒計)。在此期間，其他物件閘道例項將不會看到與此例項上的操作相關的桶定額統計資料發生的變更。預設值為 180。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_sync_interval</term>
     <listitem>
      <para>
       同步到叢集前，使用者定額資訊的累計時長 (以秒計)。在此期間，其他物件閘道例項將不會看到與此例項上的操作相關的使用者定額統計資料發生的變更。預設值為 180。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_objects</term>
     <listitem>
      <para>
       每個桶的預設物件數量上限。如果未指定其他定額，此上限將對新使用者設定，對現有使用者無效。應在用戶端或全域區段中設定此變數，以便將其自動套用至 <command>radosgw-admin</command> 指令。預設值為 -1。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_size</term>
     <listitem>
      <para>
       每個桶的預設容量上限 (以位元組計)。如果未指定其他定額，此上限將對新使用者設定，對現有使用者無效。預設值為 -1。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_objects</term>
     <listitem>
      <para>
       使用者的預設物件數量上限。這個數量包括該使用者擁有的所有桶中的全部物件。如果未指定其他定額，此上限將對新使用者設定，對現有使用者無效。預設值為 -1。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_size</term>
     <listitem>
      <para>
       如果未指定其他定額，使用者定額大小上限值 (以位元組計) 將對新使用者設定，對現有使用者無效。預設值為 -1。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_verify_ssl</term>
     <listitem>
      <para>
       發出要求時驗證 SSL 證書。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_max_chunk_size</term>
     <listitem>
      <para>
       將在單個操作中讀取的最大資料區塊大小。將值增至 4MB (4194304) 可以在處理大型物件時提高效能。預設值為 128kB (131072)。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>多站台設定</title>
    <varlistentry>
     <term>rgw_zone</term>
     <listitem>
      <para>
       閘道例項所在區域的名稱。如果未設定區域，可使用 <command>radosgw-admin zone default</command> 指令設定叢集範圍的預設值。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_zonegroup</term>
     <listitem>
      <para>
       閘道例項所在區域群組的名稱。如果未設定區域群組，可使用 <command>radosgw-admin zonegroup default</command> 指令設定叢集範圍的預設值。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_realm</term>
     <listitem>
      <para>
       閘道例項所在領域的名稱。如果未設定領域，可使用 <command>radosgw-admin realm default</command> 指令設定叢集範圍的預設值。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_run_sync_thread</term>
     <listitem>
      <para>
       如果領域中有其他要依據其同步的區域，則繁衍線串來處理資料和中繼資料的同步。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_window</term>
     <listitem>
      <para>
       資料記錄項目時段 (以秒計)。預設值為 30。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_changes_size</term>
     <listitem>
      <para>
       要為資料變更記錄儲存的記憶體內項目數。預設值為 1000。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_obj_prefix</term>
     <listitem>
      <para>
       資料記錄的物件名稱字首。預設值為「data_log」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_num_shards</term>
     <listitem>
      <para>
       儲存資料變更記錄的分區 (物件) 數。預設值為 128。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_md_log_max_shards</term>
     <listitem>
      <para>
       中繼資料記錄的分區數量上限。預設值為 64。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Swift 設定</title>
    <varlistentry>
     <term>rgw_enforce_swift_acls</term>
     <listitem>
      <para>
       強制執行 Swift 存取控制清單 (ACL) 設定。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_token_expiration</term>
     <listitem>
      <para>
       Swift 記號過期時間 (以秒計)。預設值為 24 * 3600。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url</term>
     <listitem>
      <para>
       Ceph Object Gateway Swift API 的 URL。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url_prefix</term>
     <listitem>
      <para>
       Swift StorageURL 中在「/v1」部分前面的 URL 字首。此設定允許在同一主機上執行多個閘道例項。出於相容性考慮，請將此組態變數設為空白，以便使用預設值「/swift」。使用明確的字首「/」會在根目錄啟動 StorageURL。
      </para>
      <warning>
       <para>
        如果啟用了 S3 API，將此選項設為「/」將不會運作。請注意，如果停用 S3，將無法在多站台組態中部署物件閘道！
       </para>
      </warning>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_url</term>
     <listitem>
      <para>
       未使用內部 Swift 驗證時，用於驗證 v1 驗證記號的預設 URL。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_entry</term>
     <listitem>
      <para>
       Swift 驗證 URL 的進入點。預設值為「auth」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_versioning_enabled</term>
     <listitem>
      <para>
       啟用 OpenStack Object Storage API 的物件版本設定。此選項可讓用戶端對應當建立版本的容器設定 <literal>X-Versions-Location</literal> 屬性。該屬性指定儲存已歸檔版本的容器名稱。出於存取控制驗證 (ACL <emphasis>不在</emphasis>考慮範圍之內) 的原因，必須由已建立版本的容器所屬的同一使用者擁有該屬性。無法透過 S3 物件版本設定機制來為這些容器建立版本。預設值為「false」。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>記錄設定</title>
    <varlistentry>
     <term>rgw_log_nonexistent_bucket</term>
     <listitem>
      <para>
       允許物件閘道記錄針對不存在的桶的要求。預設值為「false」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name</term>
     <listitem>
      <para>
       物件名稱的記錄格式。如需格式指定元的詳細資料，請參閱 <command>man 1 date</command> 手冊頁。預設值為「%Y-%m-%d-%H-%i-%n」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name_utc</term>
     <listitem>
      <para>
       記錄的物件名稱是否包含 UTC 時間。如果設定為「false」(預設值)，則會使用本地時間。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_shards</term>
     <listitem>
      <para>
       用於使用率記錄的分區數量上限。預設值為 32。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_user_shards</term>
     <listitem>
      <para>
       用於單個使用者的使用率記錄的分區數量上限。預設值為 1。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_ops_log</term>
     <listitem>
      <para>
       啟用記錄每個成功物件閘道操作的功能。預設值為「false」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_usage_log</term>
     <listitem>
      <para>
       啟用使用率記錄。預設值為「false」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_rados</term>
     <listitem>
      <para>
       是否應將操作記錄寫入 Ceph 儲存叢集後端。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_socket_path</term>
     <listitem>
      <para>
       用於寫入操作記錄的 Unix 網域通訊端。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_data_backlog</term>
     <listitem>
      <para>
       寫入 Unix 網域通訊端的操作記錄的資料積存大小上限。預設值為 5 &lt;&lt; 20。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_flush_threshold</term>
     <listitem>
      <para>
       同步衝洗前使用率記錄中已合併的改動項目數量。預設值為 1024。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_tick_interval</term>
     <listitem>
      <para>
       每隔「n」秒衝洗待處理使用率記錄資料。預設值為 30。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_http_headers</term>
     <listitem>
      <para>
       要在記錄項目中包含的 HTTP 標題的逗號分隔清單。標題名稱不區分大小寫，使用完整標題名稱格式，且各單字間以底線分隔。例如「http_x_forwarded_for」、「http_x_special_k」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name</term>
     <listitem>
      <para>
       要記錄的記錄物件名稱的記錄格式。如需格式指定元的詳細資料，請參閱 <command>man 1 date</command> 手冊頁。預設值為「%Y-%m-%d-%i-%n」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name_utc</term>
     <listitem>
      <para>
       要記錄的記錄物件名稱是否包含 UTC 時間。如果設定為「false」(預設值)，則會使用本地時間。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Keystone 設定</title>
    <varlistentry>
     <term>rgw_keystone_url</term>
     <listitem>
      <para>
       Keystone 伺服器的 URL。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_api_version</term>
     <listitem>
      <para>
       應用於與 Keystone 伺服器通訊的 OpenStack Identity API 的版本 (2 或 3)。預設值為 2。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_domain</term>
     <listitem>
      <para>
       使用 OpenStack Identity API v3 時，具有管理員權限的 OpenStack 網域名稱。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_project</term>
     <listitem>
      <para>
       使用 OpenStack Identity API v3 時，具有管理員權限的 OpenStack 專案名稱。如果未設定，將使用 <command>rgw keystone admin tenant</command> 的值取代。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_token</term>
     <listitem>
      <para>
       Keystone 管理員記號 (共享秘密)。在物件閘道中，使用管理員記號的驗證的優先程度高於使用管理員身分證明的驗證 (選項 <option>rgw keystone admin user</option>、<option>rgw keystone admin password</option>、<option>rgw keystone admin tenant</option>、<option>rgw keystone admin project</option> 和 <option>rgw keystone admin domain</option>)。系統將管理員記號功能視為已取代。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_tenant</term>
     <listitem>
      <para>
       使用 OpenStack Identity API v2 時，具有管理員權限的 OpenStack 租用戶 (服務租用戶) 的名稱。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_user</term>
     <listitem>
      <para>
       使用 OpenStack Identity API v2 時，具有管理員權限的 OpenStack 使用者 (服務使用者) 的名稱。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_password</term>
     <listitem>
      <para>
       使用 OpenStack Identity API v2 時 OpenStack 管理員使用者的密碼。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_accepted_roles</term>
     <listitem>
      <para>
       處理要求需要具有的角色。預設值為「Member, admin」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_token_cache_size</term>
     <listitem>
      <para>
       每個 Keystone 記號快取中的項目數上限。預設值為 10000。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_revocation_interval</term>
     <listitem>
      <para>
       記號撤銷檢查間隔的時間 (以秒計)。預設值為 15 * 60。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_verify_ssl</term>
     <listitem>
      <para>
       向 Keystone 發出記號要求時，驗證 SSL 證書。預設值為「true」。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <sect3 xml:id="sec-ceph-rgw-configuration-notes">
    <title>補充說明</title>
    <variablelist>
     <varlistentry>
      <term>rgw_dns_name</term>
      <listitem>
       <para>
        如果將參數 <literal>rgw dns name</literal> 新增至 <filename>ceph.conf</filename>，請確定已設定 S3 用戶端，以導向 <literal>rgw dns name</literal> 所指定端點的要求。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>

  <sect2 xml:id="config-ogw-http-frontends">
   <title>HTTP 前端</title>
   <sect3>
    <title>Beast</title>
    <variablelist>
     <varlistentry>
      <term>port、ssl_port</term>
      <listitem>
       <para>
        IPv4 和 IPv6 監聽連接埠號碼。您可以指定多個連接埠號碼：
       </para>
<screen>
port=80 port=8000 ssl_port=8080
</screen>
       <para>
        預設值為 80。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>endpoint、ssl_endpoint</term>
      <listitem>
       <para>
        監聽位址採用「位址[:連接埠]」格式，其中，位址為採用點分隔十進位格式的 IPv4 位址字串，或是採用以方括號括住的十六進位標記法表示的 IPv6 位址。指定將僅監聽 IPv6 的 IPv6 端點。<option>endpoint</option> 和 <option>ssl_endpoint</option> 的選用連接埠號碼分別預設為 80 和 443。您可以指定多個位址：
       </para>
<screen>
endpoint=[::1] endpoint=192.168.0.100:8000 ssl_endpoint=192.168.0.100:8080
</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>ssl_private_key</term>
      <listitem>
       <para>
        此為選擇性設定，指定用於啟用了 SSL 的端點的私密金鑰檔案路徑。如果未指定，將使用 <option>ssl_certificate</option> 檔案做為私密金鑰。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>tcp_nodelay</term>
      <listitem>
       <para>
        如果指定該選項，通訊端選項將針對連接停用 Nagle 的演算法。這表示將會儘快傳送封包，而不會等到發生緩衝區滿載或逾時才傳送。
       </para>
       <para>
        「1」會對所有通訊端停用 Nagle 的演算法。
       </para>
       <para>
        「0」會使 Nagle 的演算法保持啟用狀態 (預設值)。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title><filename>/etc/ceph/ceph.conf</filename> 中的範例 Beast 組態</title>
<screen>
rgw_frontends = beast port=8000 ssl_port=443 ssl_certificate=/etc/ssl/ssl.crt error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>CivetWeb</title>
    <variablelist>
     <varlistentry>
      <term>port</term>
      <listitem>
       <para>
        監聽連接埠號碼。對啟用了 SSL 的連接埠新增「s」尾碼 (例如「443s」)。若要結合特定 IPv4 或 IPv6 位址，請使用「位址:連接埠」格式。您可以透過使用「+」聯結多個端點或透過提供多個選項，來指定多個端點：
       </para>
<screen>
port=127.0.0.1:8000+443s
port=8000 port=443s
</screen>
       <para>
        預設值為 7480。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>num_threads</term>
      <listitem>
       <para>
        Civetweb 所繁衍以處理內送 HTTP 連接的線串數。此設定可有效限制前端可處理的並行連接數。
       </para>
       <para>
        預設為 <option>rgw_thread_pool_size</option> 選項所指定的值。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>request_timeout_ms</term>
      <listitem>
       <para>
        Civetweb 在放棄前需等待更多內送資料的時長 (以毫秒計)。
       </para>
       <para>
        預設值為 30000 毫秒。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>access_log_file</term>
      <listitem>
       <para>
        存取記錄檔案的路徑。您可以指定完整路徑，或目前工作目錄的相對路徑。如果未指定 (預設設定)，將不會記錄存取。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>error_log_file</term>
      <listitem>
       <para>
        錯誤記錄檔案的路徑。您可以指定完整路徑，或目前工作目錄的相對路徑。如果未指定 (預設設定)，將不會記錄錯誤。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title><filename>/etc/ceph/ceph.conf</filename> 中的範例 Civetweb 組態</title>
<screen>
rgw_frontends = civetweb port=8000+443s request_timeout_ms=30000 error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>通用選項</title>
    <variablelist>
     <varlistentry>
      <term>ssl_certificate</term>
      <listitem>
       <para>
        用於啟用了 SSL 的端點的 SSL 證書檔案路徑。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>字首</term>
      <listitem>
       <para>
        要插入到所有要求的 URI 中的字首字串。例如，僅支援 Swift 的前端可能會提供一個「/swift」URI 字首。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
</chapter>
