<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_prompts.xml" version="5.0">
 <title>用户权限和命令提示</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>编辑</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  作为 Ceph 集群管理员，您需要通过运行特定命令来配置和调整集群行为。您将需要运行以下几种类型的命令：
 </para>
 <sect1>
  <title>与 Salt/DeepSea 相关的命令</title>

  <para>
   这些命令可帮助您部署或升级 Ceph 集群、同时在数个（或所有）集群节点上运行命令，它们还可在您添加或删除集群节点时为您提供协助。最常用的命令是 <command>salt</command>、<command>salt-run</command> 和 <command>deepsea</command>。您需要以 <systemitem class="username">root</systemitem> 身份在 Salt Master 节点上运行 Salt 命令（有关详细信息，请参见<xref linkend="deepsea-description"/>）。通过以下提示符来引入这些命令：
  </para>

<screen>
<prompt>root@master # </prompt>
</screen>

  <para>
   例如：
  </para>

<screen>
<prompt>root@master # </prompt>salt '*.example.net' test.ping
</screen>
 </sect1>
 <sect1>
  <title>与 Ceph 相关的命令</title>

  <para>
   这些是更低级别的命令，可在命令行上配置和微调集群及其网关的所有方面，例如，<command>ceph</command>、<command>rbd</command>、<command>radosgw-admin</command> 或 <command>crushtool</command>。
  </para>

  <para>
   要运行与 Ceph 相关的命令，您需要拥有 Ceph 密钥的读取访问权限，而密钥的用户权限则定义您在 Ceph 环境内的权限。一种方案是以 <systemitem class="username">root</systemitem> 身份（或通过 <command>sudo</command>）运行 Ceph 命令，并使用不受限的默认密钥环“ceph.client.admin.key”。
  </para>

  <para>
   建议您使用更安全的方案，即为每个管理员用户创建限制性更高的单独密钥，并将其存放在用户可读取的目录中，例如：
  </para>

<screen>~/.ceph/ceph.client.<replaceable>USERNAME</replaceable>.keyring</screen>

  <tip>
   <title>Ceph 密钥的路径</title>
   <para>
    要使用自定义管理员用户和密钥环，每次运行 <command>ceph</command> 命令（使用 <option>-n client.<replaceable>USER_NAME</replaceable></option> 和 <option>--keyring <replaceable>PATH/TO/KEYRING</replaceable></option> 选项）时，都需要指定该密钥的用户名和路径。
   </para>
   <para>
    要避免此情况，请在 <varname>CEPH_ARGS</varname>
    变量（位于各用户的 <filename>~/.bashrc</filename> 文件中）中包含这些选项。
   </para>
  </tip>

  <para>
   尽管您可以在任何集群节点上运行与 Ceph 相关的命令，但我们建议您在管理节点上运行。此文档使用 <systemitem class="username">cephadm</systemitem> 用户来运行命令，因此通过以下提示符来引入命令：
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>
</screen>

  <para>
   例如：
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>ceph auth list
</screen>

  <tip>
   <title>特定节点的命令</title>
   <para>
    如果文档指示您在集群节点上以特定角色来运行命令，应通过该提示符来寻址。例如：
   </para>
<screen>
<prompt>cephadm@mon &gt; </prompt>
</screen>
  </tip>
 </sect1>
 <sect1>
  <title>一般的 Linux 命令</title>

  <para>
   与 Ceph 或 DeepSea 无关的 Linux 命令（例如 <command>mount</command>、<command>cat</command> 或 <command>openssl</command>）通过 <prompt>cephadm@adm &gt;</prompt>
   或者 <prompt>root #</prompt> 提示符引入，具体使用哪个提示符取决于相关命令所需的权限。
  </para>
 </sect1>
 <sect1>
  <title>其他信息</title>

  <para>
   有关 Ceph 密钥管理的详细信息，请参见<xref linkend="storage-cephx-keymgmt"/>。
  </para>
 </sect1>
</chapter>
