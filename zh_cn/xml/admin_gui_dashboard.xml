<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_gui_dashboard.xml" version="5.0" xml:id="ceph-dashboard">
 <title>Ceph Dashboard</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/maintenance/ses6/xml/</dm:editurl>
   <dm:translation>是</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Ceph Dashboard 是一个扩展模块，它在 Ceph Manager 中增加了基于 Web 的内置监视和管理应用（有关 Ceph Manager 的更多详细信息，请参见<xref linkend="storage-intro-core-nodes"/>）。现在，您不必了解复杂的 Ceph 相关命令，便可轻松管理和监视您的 Ceph 集群。您可以使用 Ceph Dashboard 的直观 Web 界面，也可以使用其内置 REST API。
 </para>
 <para>
  在部署过程中的 DeepSea 阶段 3，系统会自动启用和配置 Ceph Dashboard（请参见<xref linkend="ceph-install-stack"/>）。在具有多个 Ceph Manager 实例的 Ceph 集群中，只有当前活跃的 Ceph Manager 守护进程上运行的仪表盘会处理传入请求。系统会将访问任何其他当前待机 Ceph Manager 实例上的仪表盘 TCP 端口的请求进行 HTTP 重定向 (303)，转到当前活跃 Ceph Manager 的仪表盘 URL。如此，无论您将浏览器指向任何 Ceph Manager 实例，都可以访问该仪表盘。在利用防火墙保障访问安全或规划 HA 设置时，请考虑此种行为。
 </para>
 <sect1 xml:id="dashboard-webui-general">
  <title>仪表盘的 Web 用户界面</title>

  <sect2 xml:id="dashboard-webui-login">
   <title>登录</title>
   <para>
    要登录仪表盘 Web 应用，请将浏览器指向其 URL，包括端口号。您可以通过运行以下命令找到其网址
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph mgr services | grep dashboard
"dashboard": "https://ses-dash-node.example.com:8443/",
</screen>
   <figure>
    <title>Ceph Dashboard 登录屏幕</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dashboard_login.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dashboard_login.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    您需要有用户帐户才能登录仪表盘 Web 应用。DeepSea 会为您创建一个拥有管理员权限的默认用户“admin”。如果您决定使用默认的“admin”用户登录，请通过运行以下命令获取相应密码
   </para>
<screen>
<prompt>root@master # </prompt>salt-call grains.get dashboard_creds
</screen>
   <tip>
    <title>自定义用户帐户</title>
    <para>
     如果您不想使用默认“admin”帐户访问 Ceph Dashboard，请创建拥有管理员权限的自定义用户帐户。有关更多详细信息，请参见 <xref linkend="dashboard-user-roles"/>。
    </para>
   </tip>
   <para>
    仪表盘用户界面在图形上分为以下几<emphasis>块</emphasis>：<emphasis>实用程序菜单</emphasis>、<emphasis>主菜单</emphasis>和主<emphasis>内容窗格</emphasis>。
   </para>
   <figure>
    <title>Ceph Dashboard 首页</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dashboard_homepage.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dashboard_homepage.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-util-menu">
   <title>实用程序菜单</title>
   <para>
    实用程序菜单位于屏幕右上方。该菜单包含与仪表盘更为相关（相较于 Ceph 集群）的常规任务。点击相应项目可以访问以下主题：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      更改仪表盘用户界面的语言。您可以选择捷克语、英语、德语、西班牙语、法语、葡萄牙语、中文或印度尼西亚语。
     </para>
    </listitem>
    <listitem>
     <para>
      显示正在后台运行的 Ceph 相关任务的列表。
     </para>
    </listitem>
    <listitem>
     <para>
      查看并清除最近的仪表盘通知。
     </para>
    </listitem>
    <listitem>
     <para>
      显示提供仪表盘相关信息、其完整文档及 REST API 概述的链接列表。
     </para>
    </listitem>
    <listitem>
     <para>
      管理仪表盘的用户和用户角色。有关更详细的命令行说明，请参见<xref linkend="dashboard-user-roles"/>。
     </para>
    </listitem>
    <listitem>
     <para>
      从仪表盘注销。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="dashboard-main-menu">
   <title>主菜单</title>
   <para>
    仪表盘的主菜单位于屏幕的左上方。它涵盖下列主题：
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>仪表盘</guimenu></term>
     <listitem>
      <para>
       返回 Ceph Dashboard 首页。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>集群</guimenu></term>
     <listitem>
      <para>
       查看有关集群的总体配置、CRUSH 索引、集群的主机、Ceph OSD、Ceph Monitor 及日志文件内容的详细信息。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>存储池</guimenu></term>
     <listitem>
      <para>
       查看并管理集群存储池。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>设备块</guimenu></term>
     <listitem>
      <para>
       查看并管理块设备及其 iSCSI 导出项。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>NFS</guimenu></term>
     <listitem>
      <para>
       查看并管理 NFS Ganesha 部署。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>文件系统</guimenu></term>
     <listitem>
      <para>
       查看并管理 CephFS。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>对象网关</guimenu></term>
     <listitem>
      <para>
       查看并管理对象网关的守护进程、用户和存储桶。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard-cpane">
   <title>内容窗格</title>
   <para>
    内容窗格占据仪表盘屏幕的主要部分。仪表盘首页上显示了很多有用的控件，为您提供集群当前状态、容量及性能的概要信息。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-ui-common">
   <title>常用 Web UI 功能</title>
   <para>
    在 Ceph Dashboard 中，您经常会用到<emphasis>列表</emphasis> — 例如，存储池列表、OSD 节点列表或 RBD 设备列表。所有列表默认每 5 秒会自动刷新一次。下列常用控件可帮助您管理或调整这些列表：
   </para>
   <para>
    点击 <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> 可手动触发列表的刷新。
   </para>
   <para>
    点击 <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> 可显示或隐藏表格的相应列。
   </para>
   <para>
    点击 <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> 并选择要在一页上显示多少行。
   </para>
   <para>
    在 <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> 中点击并键入要搜索的字符串以过滤行。
   </para>
   <para>
    如果列表跨多页显示，可使用 <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> 来更改当前显示的页。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-widgets">
   <title>仪表盘控件</title>
   <para>
    每个仪表盘控件显示与运行中 Ceph 集群特定方面相关的特定状态信息。有些控件是活跃链接，点击它们会将您重定向到其所代表主题的相关详细页面。
   </para>
   <tip>
    <title>鼠标悬停时显示更多详细信息</title>
    <para>
     有些图形控件会在您将鼠标移到其上时显示更多详细信息。
    </para>
   </tip>
   <sect3 xml:id="dashboard-widgets-status">
    <title>状态控件</title>
    <para>
     <guimenu>状态</guimenu>控件为您提供有关集群当前状态的简要概览。
    </para>
    <figure>
     <title>状态控件</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_status.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_status.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>集群状态</guimenu></term>
      <listitem>
       <para>
        显示有关集群健康状况的基本信息。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Monitor</guimenu></term>
      <listitem>
       <para>
        显示运行中 Monitor 数量及其仲裁。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>OSD</guimenu></term>
      <listitem>
       <para>
        显示 OSD 的总数及处于“up”和“in”状态的 OSD 数量。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Manager 守护进程</guimenu></term>
      <listitem>
       <para>
        显示处于活跃和待机状态的 Ceph Manager 守护进程的数量。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>主机</guimenu></term>
      <listitem>
       <para>
        显示集群节点的总数。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>对象网关</guimenu></term>
      <listitem>
       <para>
        显示运行中对象网关的数量。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>元数据服务器</guimenu></term>
      <listitem>
       <para>
        显示元数据服务器的数量。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>iSCSI 网关</guimenu></term>
      <listitem>
       <para>
        显示配置的 iSCSI 网关的数量。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3 xml:id="dashboard-widgets-performance">
    <title>性能控件</title>
    <para>
     <guimenu>性能</guimenu>控件提供 Ceph 客户端的基本性能数据。
    </para>
    <figure>
     <title>性能控件</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_perf.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_perf.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>客户端 IOPS</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>客户端吞吐量</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>客户端读/写</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>恢复吞吐量</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>洗刷</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3 xml:id="dashboard-widgets-capacity">
    <title>容量控件</title>
    <para>
     <guimenu>容量</guimenu>控件显示有关存储容量的简要信息。
    </para>
    <figure>
     <title>容量控件</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_capacity.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_capacity.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>存储池</guimenu></term>
      <listitem>
       <para>
        显示集群中存储池的数量。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>基本容量</guimenu></term>
      <listitem>
       <para>
        显示已用与可用基本存储容量的比例。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>对象</guimenu></term>
      <listitem>
       <para>
        显示集群中存储的数据对象数量。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>每个 OSD 的 PG 数</guimenu></term>
      <listitem>
       <para>
        显示每个 OSD 的归置组数量。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>PG 状态</guimenu></term>
      <listitem>
       <para>
        显示按照状态分组的归置组图表。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-user-mgmt">
  <title>管理仪表盘用户和角色</title>

  <para>
   有关在命令行上通过 Ceph 命令执行仪表盘用户管理的说明，请参见<xref linkend="dashboard-user-roles"/>。
  </para>

  <para>
   本节说明如何使用仪表盘 Web 用户界面来管理用户帐户。
  </para>

  <sect2 xml:id="dashboard-listing-users">
   <title>列出用户</title>
   <para>
    点击实用程序菜单中的 <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject>，然后选择<guimenu>用户管理</guimenu>。
   </para>
   <para>
    该列表包含每个用户的用户名、全名、电子邮件及为其指定的角色列表。
   </para>
   <figure>
    <title>用户管理</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_users.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_users.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-adding-users">
   <title>添加新用户</title>
   <para>
    点击表标题左上方的<guimenu>添加</guimenu>可添加新用户。输入其用户名、密码、全名（可选）和电子邮件。
   </para>
   <figure>
    <title>添加用户</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_user_add.png" width="50%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_user_add.png" width="50%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    点击铅笔小图标可为用户指定预定义角色。点击<guimenu>创建用户</guimenu>进行确认。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-editing-users">
   <title>编辑用户</title>
   <para>
    点击用户表中对应的行，然后选择<guimenu>编辑</guimenu>可编辑用户的详细信息。点击<guimenu>更新用户</guimenu>进行确认。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-deleting-users">
   <title>删除用户</title>
   <para>
    点击用户表中对应的行，然后选择<guimenu>删除</guimenu>可删除用户帐户。激活<guimenu>是的，我确定</guimenu>复选框，然后点击<guimenu>删除用户</guimenu>进行确认。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-listing-user-roles">
   <title>列出用户角色</title>
   <para>
    点击实用程序菜单中的 <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject>，然后选择<guimenu>用户管理</guimenu>。然后点击<guimenu>角色</guimenu>选项卡。
   </para>
   <para>
    该列表包含每个角色的名称、描述及其是否属于系统角色。
   </para>
   <figure>
    <title>用户角色</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_roles.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_roles.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-adding-roles">
   <title>添加自定义角色</title>
   <para>
    点击表标题左上方的<guimenu>添加</guimenu>可添加新的自定义角色。输入其名称、描述并设置针对各主题的必需权限。
   </para>
   <tip>
    <title>清除自定义角色</title>
    <para>
     如果您创建了自定义用户角色，并打算以后使用 <command>ceph.purge</command> 运行程序删除 Ceph 集群，则需要先清除自定义角色。有关详细信息，请参见<xref linkend="deepsea-ceph-purge"/>。
    </para>
   </tip>
   <figure>
    <title>添加角色</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_roles_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_roles_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <tip>
    <title>多项目激活</title>
    <para>
     通过激活主题名称前的复选框，您可以激活针对该主题的所有权限。通过激活<guimenu>全选</guimenu>复选框，您可以激活针对所有主题的所有权限。
    </para>
   </tip>
   <para>
    点击<guimenu>创建角色</guimenu>进行确认。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-editing-roles">
   <title>编辑自定义角色</title>
   <para>
    点击自定义角色表中对应的行，然后选择表标题左上方的<guimenu>编辑</guimenu>，即可编辑自定义角色的描述和权限。点击<guimenu>更新角色</guimenu>进行确认。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-deleting-roles">
   <title>删除自定义角色</title>
   <para>
    点击角色表中对应的行，然后选择<guimenu>删除</guimenu>可删除角色。激活<guimenu>是的，我确定</guimenu>复选框，然后点击<guimenu>删除角色</guimenu>进行确认。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-cluster">
  <title>查看集群内部</title>

  <para>
   <guimenu>集群</guimenu>菜单项可让您查看有关 Ceph 集群主机、OSD、MON、CRUSH 索引和日志文件内容的详细信息。
  </para>

  <sect2 xml:id="dashboard-cluster-hosts">
   <title>集群节点</title>
   <para>
    点击<menuchoice><guimenu>集群</guimenu><guimenu>主机</guimenu></menuchoice>可查看集群节点列表。
   </para>
   <figure>
    <title>Hosts（主机）</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    点击<guimenu>主机名</guimenu>列中的节点名称可查看该节点的性能详细信息。
   </para>
   <para>
    <guimenu>服务</guimenu>列中会列出每个相关节点上正在运行的所有守护进程。点击守护进程名称可查看其详细配置。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-monitors">
   <title>Ceph Monitor</title>
   <para>
    点击<menuchoice><guimenu>集群</guimenu><guimenu>Monitor</guimenu></menuchoice> 可查看具有正在运行的 Ceph Monitor 的集群节点列表。该列表包含每个 Monitor 的排位号、外部 IP 地址和活动会话的数量。
   </para>
   <para>
    列表分为两个表：一个表显示<emphasis>属于</emphasis>仲裁成员的 Ceph Monitor，另一个表显示<emphasis>不属于</emphasis>仲裁成员的 Ceph Monitor。
   </para>
   <para>
    点击<guimenu>名称</guimenu>列中的节点名称可查看相关的 Ceph Monitor 配置。
   </para>
   <para>
    <guimenu>状态</guimenu>表显示有关运行中 Ceph Monitor 的一般统计数据。
   </para>
   <figure>
    <title>Ceph Monitor</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-cluster-osds">
   <title>Ceph OSD</title>
   <para>
    点击<menuchoice><guimenu>集群</guimenu><guimenu>OSD</guimenu></menuchoice> 可查看具有正在运行的 OSD 守护进程/磁盘的节点列表。该列表包含每个节点的名称、状态、归置组数量、大小、使用率、不同时间的读/写图表和每秒读/写操作比率。
   </para>
   <figure>
    <title>Ceph OSD</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    点击表标题中的<guimenu>设置集群范围的标志</guimenu>，会弹出一个窗口，其中会列出适用于整个集群的标志。您可以激活或停用单个标志，然后点击<guimenu>提交</guimenu>进行确认。
   </para>
   <figure>
    <title>OSD 标志</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    点击表标题中的<guimenu>设置集群范围的恢复优先级</guimenu>，会打开一个弹出窗口，其中会列出适用于整个集群的 OSD 恢复优先级。您可以激活首选的优先级配置，并对下面的各个值进行微调。点击<guimenu>提交</guimenu>进行确认。
   </para>
   <figure>
    <title>OSD 恢复优先级</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    点击<guimenu>主机</guimenu>列中的节点名称，可查看含有 OSD 设置和性能详细信息的扩展表。您可以在数个选项卡之间切换，查看<guimenu>属性</guimenu>、<guimenu>元数据</guimenu>、<guimenu>性能计数器</guimenu>列表以及读/写操作次数的图形<guimenu>直方图</guimenu>。
   </para>
   <figure>
    <title>OSD 详细信息</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <tip>
    <title>在 OSD 上执行特定任务</title>
    <para>
     点击 OSD 节点名称后，表中该节点对应的行的颜色会发生细微变化，这表示您现在可以在该节点上执行任务了。点击表标题左上方的向下箭头，然后选择要执行的任务，例如<guimenu>深层洗刷</guimenu>。为任务输入所需的值（可选），然后确认在节点上运行该任务。
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dahsboard-cluster-config">
   <title>集群配置</title>
   <para>
    点击<menuchoice><guimenu>集群</guimenu><guimenu>配置</guimenu></menuchoice>可查看 Ceph 集群配置选项的完整列表。该列表包含选项的名称、其简短描述，以及选项的当前值和默认值。
   </para>
   <figure>
    <title>集群配置</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    点击特定选项行可高亮显示和查看该选项的详细信息，例如其值类型、允许的最大和最小值、是否可在运行时更新等等。
   </para>
   <para>
    高亮显示特定选项后，您可以通过点击表标题左上方的<guimenu>编辑</guimenu>按钮来编辑它的值。点击<guimenu>保存</guimenu>确认更改。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-crushmap">
   <title>CRUSH 索引</title>
   <para>
    点击<menuchoice><guimenu>集群</guimenu><guimenu>CRUSH 索引</guimenu></menuchoice>可查看集群的 CRUSH 索引。有关 CRUSH 索引的更多一般信息，请参见<xref linkend="op-crush"/>。
   </para>
   <para>
    点击根、节点或单个 OSD 可查看更多详细信息，例如 CRUSH 权重、索引树的深度、OSD 的设备类型等等。
   </para>
   <figure>
    <title>CRUSH 索引</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-cluster-mgr-plugins">
   <title>Manager 扩展模块</title>
   <para>
    点击<menuchoice><guimenu>集群</guimenu><guimenu>Manager 扩展模块</guimenu></menuchoice>可查看可用 Ceph Manager 扩展模块的列表。每行包含扩展模块名称以及该扩展模块当前启用与否的信息。
   </para>
   <figure>
    <title>Manager 扩展模块</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    高亮显示特定扩展模块后，您可以在下面的<guimenu>详情</guimenu>表中查看其详细设置。点击表标题左上方的<guimenu>编辑</guimenu>按钮可进行编辑。点击<guimenu>更新</guimenu>确认更改。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-logs">
   <title>日志</title>
   <para>
    点击<menuchoice><guimenu>集群</guimenu><guimenu>日志</guimenu></menuchoice>可查看集群最近日志项的列表。每行包含一个时戳、日志项的类型及自身所记录的讯息。
   </para>
   <para>
    点击<guimenu>审计日志</guimenu>选项卡可查看审计子系统的日志项。有关启用或禁用审计的命令，请参见<xref linkend="dashboard-auditing"/>。
   </para>
   <figure>
    <title>日志</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-pools">
  <title>管理存储池</title>

  <tip>
   <title>存储池的更多信息</title>
   <para>
    有关 Ceph 存储池的更多一般信息，请参见<xref linkend="ceph-pools"/>。有关纠删码存储池特定的信息，请参见<xref linkend="cha-ceph-erasure"/>。
   </para>
  </tip>

  <para>
   要列出所有可用的存储池，请点击主菜单中的 <guimenu>Pools</guimenu>（存储池）。
  </para>

  <para>
   该列表显示每个存储池的名称、类型、相关应用、归置组状态、副本个数、纠删码配置、使用率以及读/写统计数据。
  </para>

  <figure>
   <title>存储池列表</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   要查看有关存储池的更多详细信息，请激活表中对应的行。
  </para>

  <sect2 xml:id="dashboard-pools-create">
   <title>添加新存储池</title>
   <para>
    要添加新存储池，请点击存储池表左上方的<guimenu>添加</guimenu>。您可以在存储池表单中输入存储池的名称、类型、归置组数量及其他信息，例如存储池的应用、压缩模式和算法。存储池表单会自行预先计算最适合此特定存储池的归置组数量。计算以集群中的 OSD 数量和选定存储池类型及其特定设置为依据。如果手动设置了归置组数量，计算出的数量会替换设置的数量。点击<guimenu>创建存储池</guimenu>进行确认。
   </para>
   <figure>
    <title>添加新存储池</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-pools-delete">
   <title>删除存储池</title>
   <para>
    要删除某个存储池，请点击表中对应的行，然后点击存储池表左上方的<guimenu>删除</guimenu>。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-pools-edit">
   <title>编辑存储池的选项</title>
   <para>
    要编辑某个存储池的选项，请点击表中对应的行，然后选择存储池表左上方的<guimenu>编辑</guimenu>。
   </para>
   <para>
    您可以更改存储池的名称、增加归置组的数量、更改存储池的应用列表和压缩设置。点击<guimenu>编辑存储池</guimenu>进行确认。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-rbds">
  <title>管理 RADOS 块设备</title>

  <para>
   要列出所有可用的 RADOS 块设备 (RBD)，请点击主菜单中的<menuchoice><guimenu>块设备</guimenu><guimenu>映像</guimenu></menuchoice>。
  </para>

  <para>
   该列表显示有关设备的简要信息，例如设备的名称、相关存储池名称、设备大小、设备上对象的数量和大小。
  </para>

  <figure>
   <title>RBD 映像列表</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_rbd_images.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_rbd_images.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="dashboard-rbds-details">
   <title>查看有关 RBD 的详细信息</title>
   <para>
    要查看某个设备的更多详细信息，请点击表中对应的行：
   </para>
   <figure>
    <title>RBD 详细信息</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_details.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_details.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-rbds-configuration">
   <title>查看 RBD 的配置</title>
   <para>
    要查看某个设备的详细配置，请点击表中对应的行，然后点击下方表中的<guimenu>配置</guimenu>选项卡：
   </para>
   <figure>
    <title>RBD 配置</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_config.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_config.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-rbds-create">
   <title>创建 RBD</title>
   <para>
    要添加新设备，请点击表标题左上方的<guimenu>添加</guimenu>，然后在<guimenu>创建 RBD</guimenu> 屏幕上执行以下操作：
   </para>
   <figure>
    <title>添加新的 RBD</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbd_add.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbd_add.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      输入新设备的名称。有关命名限制，请参见<xref linkend="sysreq-naming"/>。
     </para>
    </step>
    <step>
     <para>
      选择要在其中创建新 RBD 设备且指定了“rbd”应用的存储池。
     </para>
    </step>
    <step>
     <para>
      指定新设备的大小。
     </para>
    </step>
    <step>
     <para>
      为设备指定其他选项。要微调设备参数，请点击<guimenu>高级设置</guimenu>，然后输入对象大小、条带单元或条带个数的值。要输入服务质量 (QoS) 限制，请点击<guimenu>服务质量 (QoS)</guimenu>，然后输入限制。
     </para>
    </step>
    <step>
     <para>
      点击<guimenu>创建 RBD</guimenu> 进行确认。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dashboard-rbd-delete">
   <title>删除 RBD</title>
   <para>
    要删除某个设备，请点击表中对应的行，然后选择表标题左上方的<guimenu>删除</guimenu> 点击<guimenu>删除 RBD</guimenu> 确认删除。
   </para>
   <tip>
    <title>将 RBD 移至回收站</title>
    <para>
     删除 RBD 的操作无法撤消。如果您选择将设备<guimenu>移至回收站</guimenu>，那么稍后还可以将其恢复，只需在主表的<guimenu>回收站</guimenu>选项卡上选择该设备，然后点击表标题左上方的<guimenu>恢复</guimenu>。
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dashboard-rbds-snapshots">
   <title>RADOS 块设备快照</title>
   <para>
    要创建 RADOS 块设备快照，请点击表中设备对应的行，然后在主表下的<guimenu>快照</guimenu>选项卡中，点击表标题左上方的<guimenu>创建</guimenu>。输入快照的名称，然后点击<guimenu>创建快照</guimenu>进行确认。
   </para>
   <para>
    选择快照后，您可以在设备上执行其他操作，例如重命名、保护、克隆、复制或删除。<guimenu>回滚</guimenu>可根据当前快照恢复设备的状态。
   </para>
   <figure>
    <title>RBD 快照</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_snapshots.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_snapshots.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-iscsi">
   <title>管理 iSCSI 网关</title>
   <tip>
    <title>iSCSI 网关的更多信息</title>
    <para>
     有关 iSCSI 网关的更多一般信息，请参见<xref linkend="cha-ceph-as-iscsi"/>和<xref linkend="cha-ceph-iscsi"/>。
    </para>
   </tip>
   <para>
    要列出所有可用网关和映射的映像，请点击主菜单中的<menuchoice><guimenu>块设备</guimenu><guimenu>iSCSI</guimenu></menuchoice>。<guimenu>概述</guimenu>选项卡即会打开，列出当前配置的 iSCSI 网关和映射的 RBD 映像。
   </para>
   <para>
    <guimenu>网关</guimenu>表列出每个网关的状态、iSCSI 目标数量及会话数量。<guimenu>映像</guimenu>表列出每个映射的映像的名称、相关存储池名称、后备存储类型及其他统计数据详细信息。
   </para>
   <para>
    <guimenu>目标</guimenu>选项卡列出当前配置的 iSCSI 目标。
   </para>
   <figure>
    <title>iSCSI 目标列表</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_igws.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_igws.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    要查看有关某个目标的更多详细信息，请点击表中对应的行。一个树状结构纲要即会打开，列出磁盘、端口、授权人和组。点击某一项可将其展开并查看详细内容，右侧的表中也可能会显示其相关配置。
   </para>
   <figure>
    <title>iSCSI 目标详细信息</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3 xml:id="dashboard-iscsi-create">
    <title>添加 iSCSI 目标</title>
    <para>
     要添加新的 iSCSI 目标，请点击<guimenu>目标</guimenu>表左上方的<guimenu>添加</guimenu>，并输入所需信息。
    </para>
    <figure>
     <title>添加新目标</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       输入新网关的目标地址。
      </para>
     </step>
     <step>
      <para>
       点击<guimenu>添加端口</guimenu>并从列表中选择一个或多个 iSCSI 门户。
      </para>
     </step>
     <step>
      <para>
       点击<guimenu>添加映像</guimenu>并为网关选择一个或多个 RBD 映像。
      </para>
     </step>
     <step>
      <para>
       如果您需要使用身份验证才能访问网关，请选中 <guimenu>Authentication</guimenu>（身份验证）复选框并输入身份凭证。选中<guimenu>相互身份验证</guimenu>和<guimenu>发现身份验证</guimenu>之后，您可看到更多高级身份验证选项。
      </para>
     </step>
     <step>
      <para>
       点击<guimenu>创建目标</guimenu>进行确认。
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="dashboard-iscsi-edit">
    <title>编辑 iSCSI 目标</title>
    <para>
     要编辑某个现有 iSCSI 目标，请点击<guimenu>目标</guimenu>表中对应的行，然后点击表左上方的<guimenu>编辑</guimenu>。
    </para>
    <para>
     然后，您便可以修改 iSCSI 目标、添加或删除端口，以及添加或删除相关 RBD 映像。您还可以调整网关的身份验证信息。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-iscsi-delete">
    <title>删除 iSCSI 目标</title>
    <para>
     要删除某个 iSCSI 目标，请点击表中对应的行，然后选择网关表左上方的<guimenu>删除</guimenu>。激活<guimenu>是的，我确定</guimenu>，然后点击<guimenu>删除 iSCSI</guimenu> 进行确认。
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dash-rbd-qos">
   <title>RBD 服务质量 (QoS)</title>
   <tip>
    <title>更多信息</title>
    <para>
     有关 RBD QoS 配置选项的更多一般信息和说明，请参见<xref linkend="rbd-qos"/>。
    </para>
   </tip>
   <para>
    QoS 选项可在不同级别配置。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      全局
     </para>
    </listitem>
    <listitem>
     <para>
      基于每个存储池
     </para>
    </listitem>
    <listitem>
     <para>
      基于每个映像
     </para>
    </listitem>
   </itemizedlist>
   <para>
    <emphasis>全局</emphasis>配置位于列表顶部，将用于所有新创建的 RBD 映像，以及不会覆盖存储池或 RBD 映像层级相应值的映像。全局指定的选项值可能会被基于每个存储池或映像设置的值覆盖。对存储池指定的选项将适用于该存储池的所有 RBD 映像，除非被对映像设置的配置选项所覆盖。对映像指定的选项将覆盖对存储池指定的选项以及全局指定的选项。
   </para>
   <para>
    因此可以如此操作：全局定义默认值，对默认值进行调整以适合特定存储池的所有 RBD 映像，然后覆盖单个 RBD 映像的存储池配置。
   </para>
   <sect3 xml:id="dash-rbd-qos-global">
    <title>全局配置选项</title>
    <para>
     要全局配置 RBD 选项，请在主菜单中选择<menuchoice><guimenu>集群</guimenu>
     <guimenu>配置项</guimenu></menuchoice>。
    </para>
    <para>
     要列出所有可用的全局配置选项，请点击<menuchoice><guimenu>级别</guimenu>
     <guimenu>高级设置</guimenu></menuchoice>。然后在搜索字段中过滤“rbd_qos”，以过滤表的结果。QoS 的所有可用配置选项即会列出。要更改某个值，请点击表中对应的行，然后选择表左上方的<guimenu>编辑</guimenu>。<guimenu>编辑</guimenu>对话框包含 6 个不同的字段供您指定值。在 <guimenu>mgr</guimenu> 文本框中，RBD 配置选项值是必填的。请注意，此对话框与其他对话框不同，不允许您使用方便的单位指定值。您只能使用字节或 IOPS 单位设置这些值，具体取决于您要编辑的选项。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-pool-create">
    <title>对新存储池配置选项</title>
    <para>
     要创建新存储池并对其配置 RBD 配置选项，请点击<menuchoice><guimenu>存储池</guimenu>
     <guimenu>创建</guimenu></menuchoice>。选择<guimenu>副本</guimenu>作为存储池类型。然后，您需要为存储池添加 <guimenu>rbd</guimenu> 应用标记，这样才能配置 RBD QoS 选项。
    </para>
    <note>
     <para>
      对于纠删码存储池是无法配置 RBD QoS 配置选项的。要为纠删码存储池配置 RBD QoS 选项，您需要编辑 RBD 映像的副本元数据池。该配置随后将应用于该映像的纠删码数据池。
     </para>
    </note>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-pool-edit">
    <title>对现有存储池配置选项</title>
    <para>
     要对某个现有存储池配置 RBD QoS 选项，请点击<guimenu>存储池</guimenu>，然后点击表中该存储池对应的行，并选择表左上方的<guimenu>编辑</guimenu>。
    </para>
    <para>
     对话框中应该就会显示 <guimenu>RBD 配置</guimenu>部分，下面是<guimenu>服务质量 (QoS)</guimenu> 部分。
    </para>
    <note>
     <para>
      如果 <guimenu>RBD 配置</guimenu>和<guimenu>服务质量 (QoS)</guimenu> 部分均未显示，则可能是因为您正在编辑无法用于设置 RBD 配置选项的<emphasis>纠删码</emphasis>池，或该存储池未配置为供 RBD 映像使用。在下一个案例中，将为存储池指定 <guimenu>rbd</guimenu> 应用标记，相应的配置部分将会显示。
     </para>
    </note>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-qos">
    <title>配置选项</title>
    <para>
     点击<guimenu>服务质量 +</guimenu> 展开配置选项。所有可用选项的列表即会显示。文本框中已显示配置选项的单位。对于任何每秒字节数 (BPS) 选项，您可以选择使用“1M”或“5G”之类的缩写。系统会自动将其转换为对应的“1 MB/s”和“5 GB/s”。
    </para>
    <para>
     点击每个文本框右侧的重设置按钮，将删除对该存储池设置的所有值。此操作不会删除全局配置或对 RBD 映像配置的选项的配置值。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-create">
    <title>使用新 RBD 映像创建 RBD QoS 选项</title>
    <para>
     要创建 RBD 映像并对该映像设置 RBD QoS 选项，请选择<menuchoice><guimenu>设备块</guimenu>
     <guimenu>映像</guimenu></menuchoice>，然后点击<guimenu>创建</guimenu>。点击<guimenu>高级设置</guimenu>可展开高级配置部分。点击<guimenu>服务质量</guimenu>可打开所有可用配置选项。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-edit">
    <title>编辑现有映像的 RBD QoS 选项</title>
    <para>
     要编辑现有映像的 RBD QoS 选项，请选择<menuchoice><guimenu>块设备</guimenu>
     <guimenu>映像</guimenu></menuchoice>，然后点击表中该存储池对应的行，最后点击<guimenu>编辑</guimenu>。编辑对话框随即显示。点击<guimenu>高级设置</guimenu>可展开高级配置部分。点击<guimenu>服务质量</guimenu>可打开所有可用配置选项。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-copy">
    <title>在复制或克隆映像时更改配置选项</title>
    <para>
     如果克隆或复制了 RBD 映像，对该特定映像设置的值默认也将被复制。如果您想在复制或克隆期间更改这些值，可通过在复制/克隆对话框中指定更新的配置值来进行更改，此过程与创建或编辑 RBD 映像时的方式相同。执行此操作只能设置（或重设置）所复制或克隆的 RBD 映像的值，无法更改来源 RBD 映像配置，也无法更改全局配置。
    </para>
    <para>
     如果您选择在复制/克隆时重设置选项值，系统将不会对该映像设置该选项的值。这意味着系统将使用为父存储池指定的该选项的任何值（如果为父存储池配置了相应值）。如果没有为父存储池配置相应值，则将使用全局默认值。
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dash-rbd-mirror">
   <title>RBD 镜像</title>
   <tip>
    <title>一般信息</title>
    <para>
     有关 RADOS 块设备镜像的一般信息和命令行方法，请参见<xref linkend="ceph-rbd-mirror"/>。
    </para>
   </tip>
   <para>
    您可以使用 Ceph Dashboard 在两个或更多集群之间配置 RBD 映像复制。
   </para>
   <sect3 xml:id="rbd-mirror-primary-secondary">
    <title>主集群和次集群</title>
    <para>
     <emphasis>主</emphasis>集群是用于创建包含映像的原始存储池的集群。<emphasis>次</emphasis>集群是用于从<emphasis>主</emphasis>集群复制存储池/映像的集群。
    </para>
    <note>
     <title>相对命名</title>
     <para>
      在复制上下文中，<emphasis>主</emphasis>与<emphasis>次</emphasis>这两个术语有可能是相对的，因为相较于集群来说，它们与单个存储池更为相关。例如，在双向复制中，可将一个存储池从<emphasis>主</emphasis>集群镜像到<emphasis>次</emphasis>集群，与此同时，也可以将另一个存储池从<emphasis>次</emphasis>集群镜像到<emphasis>主</emphasis>集群。
     </para>
    </note>
   </sect3>
   <sect3 xml:id="rbd-mirroring-replication-modes">
    <title>复制模式</title>
    <para>
     数据复制有两种模式：
    </para>
    <itemizedlist>
     <listitem>
      <para>
       使用<emphasis>存储池</emphasis>模式，您可以复制存储池中的所有 RBD 映像。
      </para>
     </listitem>
     <listitem>
      <para>
       使用<emphasis>映像</emphasis>模式，您可以仅激活存储池中特定映像的镜像。
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="rbd-mirror-gui-daemon">
    <title>配置 <systemitem class="daemon">rbd-mirror</systemitem> 守护进程</title>
    <para>
     <systemitem class="daemon">rbd-mirror</systemitem> 守护进程负责执行实际的集群数据复制。要安装、配置以及运行该守护进程，请执行以下步骤：
    </para>
    <procedure>
     <step>
      <para>
       需要在<emphasis>次</emphasis>集群管理节点以外的其他某个节点上运行 <systemitem class="daemon">rbd-mirror</systemitem> 守护进程。系统默认不会安装该守护进程，因此需手动安装：
      </para>
<screen><prompt>root@minion &gt; </prompt>zypper install rbd-mirror</screen>
     </step>
     <step>
      <para>
       在<emphasis>主</emphasis>集群上，为 <systemitem class="daemon">rbd-mirror</systemitem> 守护进程创建唯一的 Ceph 用户 ID。在此示例中，我们使用“uid1”作为用户 ID：
      </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph auth get-or-create client.rbd-mirror.uid1 \
 mon 'profile rbd-mirror' osd 'profile rbd'
[client.rbd-mirror.uid1]
	key = AQBbDJddZKLBIxAAdsmSCCjXoKwzGkGmCpUQ9g==</screen>
     </step>
     <step>
      <para>
       在您先前安装了
       <package>rbd-mirror</package> 安装包的<emphasis>次</emphasis>集群节点上，创建该 Ceph 用户，并将输出保存到密钥环：
      </para>
<screen><prompt>root@minion &gt; </prompt>ceph auth get-or-create client.rbd-mirror.uid1 \
 mon 'profile rbd-mirror' osd 'profile rbd' \
 &gt; /etc/ceph/ceph.client.rbd-mirror.uid1.keyring</screen>
     </step>
     <step>
      <para>
       在同一节点上，启用并运行 <systemitem class="daemon">rbd-mirror</systemitem> 服务：
      </para>
<screen><prompt>root@minion &gt; </prompt>systemctl enable ceph-rbd-mirror@rbd-mirror.uid1
<prompt>root@minion &gt; </prompt>systemctl start ceph-rbd-mirror@rbd-mirror.uid1
<prompt>root@minion &gt; </prompt>systemctl status ceph-rbd-mirror@rbd-mirror.uid1
● ceph-rbd-mirror@rbd-mirror.uid1.service - Ceph rbd mirror daemon
   Loaded: loaded (/usr/lib/systemd/system/ceph-rbd-mirror@.service; enabled; vendor preset: disabled)
   Active: active (running) since Fri 2019-10-04 07:48:53 EDT; 2 days ago
 Main PID: 212434 (rbd-mirror)
    Tasks: 47
   CGroup: /system.slice/system-ceph\x2drbd\x2dmirror.slice/ceph-rbd-mirror@rbd-mirror.uid1.service
           └─212434 /usr/bin/rbd-mirror -f --cluster ceph --id rbd-mirror.test --setuser ceph --setgroup ceph

Oct 04 07:48:53 doc-ses6min4 systemd[1]: Started Ceph rbd mirror daemon.
</screen>
     </step>
     <step>
      <para>
       在<emphasis>次</emphasis>集群的 Ceph Dashboard 上，导航到<menuchoice><guimenu>块设备</guimenu><guimenu>镜像</guimenu></menuchoice>。<guimenu>守护进程</guimenu>表的左侧会显示处于活跃状态的运行中 <systemitem>rbd-mirror</systemitem> 守护进程及其健康状况。
      </para>
      <figure>
       <title>正在运行的 <systemitem class="daemon">rbd-mirror</systemitem> 守护进程</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-daemon.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-daemon.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="rbd-mirror-gui">
    <title>在 Ceph Dashboard 中配置存储池复制</title>
    <para>
     <systemitem class="daemon">rbd-mirror￼</systemitem> 守护进程需要拥有主集群的访问权限，才能镜像 RBD 映像。因此，您需要在主集群上创建<emphasis>同伴</emphasis> Ceph 用户帐户，并告知次集群其密钥环信息：
    </para>
    <procedure>
     <step>
      <para>
       在<emphasis>主</emphasis>集群上，创建将用于数据复制的新“client.rbd-mirror-peer”用户：
      </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph auth get-or-create client.rbd-mirror-peer \
 mon 'profile rbd' osd 'profile rbd'
[client.rbd-mirror-peer]
	key = AQBbDJddZKLBIxAAdsmSCCjXoKwzGkGmCpUQ9g==</screen>
     </step>
     <step>
      <para>
       在<emphasis>主</emphasis>和<emphasis>次</emphasis>两个集群上，创建名称相同的存储池并为其指定“rbd”应用。有关创建新存储池的更多详细信息，请参见<xref linkend="dashboard-pools-create"/>。
      </para>
      <figure>
       <title>创建具有 RBD 应用的存储池</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       在<emphasis>主</emphasis>和<emphasis>次</emphasis>两个集群的仪表盘上，导航到<menuchoice><guimenu>块设备</guimenu><guimenu>镜像</guimenu></menuchoice>。在<guimenu>存储池</guimenu>表右侧点击要复制的存储池的名称，然后点击<guimenu>编辑模式</guimenu>，并选择复制模式。在此示例中，我们将使用<emphasis>存储池</emphasis>复制模式，也就是说将复制给定存储池中的所有映像。点击<guimenu>更新</guimenu>进行确认。
      </para>
      <figure>
       <title>配置复制模式</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-mode.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-mode.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <important>
       <title>主集群上的错误或警告</title>
       <para>
        更新复制模式后，右侧相应的列中会显示错误或警告标志。这是因为尚未为存储池指定用于复制的同伴用户。对于<emphasis>主</emphasis>集群，请省略此标志，因为我们只需为<emphasis>次</emphasis>集群指定同伴用户。
       </para>
      </important>
     </step>
     <step>
      <para>
       在<emphasis>次</emphasis>集群的仪表盘上，导航到<menuchoice><guimenu>块设备</guimenu><guimenu>镜像</guimenu></menuchoice>。点击要镜像的存储池名称并选择<guimenu>添加同伴</guimenu>，以便将“client.rbd-mirror-peer”用户密钥环注册到该存储池中。提供<emphasis>主</emphasis>集群的详细信息：
      </para>
      <figure>
       <title>添加同伴身份凭证</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-peer.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-peer.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <variablelist>
       <varlistentry>
        <term><guimenu>集群名称</guimenu></term>
        <listitem>
         <para>
          用于识别主集群的任意唯一字符串，如“primary”。该集群名称不得与实际环境中次集群的名称相同。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>CephX ID</guimenu></term>
        <listitem>
         <para>
          您创建作为镜像同伴的 Ceph 用户 ID。此示例中为“rbd-mirror-peer”。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>Monitor 地址</guimenu></term>
        <listitem>
         <para>
          主集群的 Ceph Monitor 节点的 IP 地址/主机名称逗号分隔列表。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>CephX 密钥</guimenu></term>
        <listitem>
         <para>
          与同伴用户 ID 相关的密钥。您可以通过在主集群上运行以下示例命令来获得该密钥：
         </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph auth print_key client.rbd-mirror-peer</screen>
        </listitem>
       </varlistentry>
      </variablelist>
      <para>
       点击<guimenu>提交</guimenu>进行确认。
      </para>
      <figure>
       <title>副本存储池列表</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-list.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-list.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="rbd-mirror-test">
    <title>确认 RBD 映像复制是否有效</title>
    <para>
     如果 <systemitem class="daemon">rbd-mirror</systemitem> 守护进程正在运行，在 Ceph Dashboard 上配置 RBD 映像复制后，就需要确认复制实际上是否有效：
    </para>
    <procedure>
     <step>
      <para>
       在<emphasis>主</emphasis>集群的 Ceph Dashboard 上创建 RBD 映像，将您已创建用于复制目的的存储池设为其父存储池。为映像启用<option>互斥锁</option>和<option>日志</option>特性。有关如何创建 RBD 映像的详细信息，请参见<xref linkend="dashboard-rbds-create"/>。
      </para>
      <figure>
       <title>新 RBD 映像</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-image.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-image.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       创建要复制的映像后，打开<emphasis>次</emphasis>集群的 Ceph Dashboard，并导航到<menuchoice><guimenu>块设备</guimenu><guimenu>镜像</guimenu></menuchoice>。右侧的<guimenu>存储池</guimenu>表将在 <guimenu># 远程</guimenu>所示数量的映像中反映该变化，并会同步 <guimenu># 本地</guimenu>所示数量的映像。
      </para>
      <figure>
       <title>同步的新 RBD 映像</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-list-1.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-list-1.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <tip>
       <title>复制进度</title>
       <para>
        页面底部的<guimenu>映像</guimenu>表会显示 RBD 映像的复制状态。<guimenu>问题</guimenu>选项卡包含可能的问题，<guimenu>正在同步</guimenu>选项卡显示映像复制的进度，<guimenu>已就绪</guimenu>选项卡列出所有已成功复制的映像。
       </para>
       <figure>
        <title>RBD 映像的复制状态</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="rbd-mirror-images-status.png" width="75%"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="rbd-mirror-images-status.png" width="75%"/>
         </imageobject>
        </mediaobject>
       </figure>
      </tip>
     </step>
     <step>
      <para>
       在<emphasis>主</emphasis>集群上，将数据写入 RBD 映像。在<emphasis>次</emphasis>集群的 Ceph Dashboard 上，导航到<menuchoice><guimenu>块设备</guimenu><guimenu>映像</guimenu></menuchoice>，监视相应映像大小的增长是否与主集群上写入的数据一致。
      </para>
     </step>
    </procedure>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dash-webui-nfs">
  <title>管理 NFS Ganesha</title>

  <tip>
   <title>NFS Ganesha 的更多信息</title>
   <para>
    有关 NFS Ganesha 的更多一般信息，请参见<xref linkend="cha-ceph-nfsganesha"/>。
   </para>
  </tip>

  <para>
   要列出所有可用的 NFS 导出项，请点击主菜单中的 <guimenu>NFS</guimenu>。
  </para>

  <para>
   该列表会显示每个导出项的目录、守护进程主机名、存储后端类型以及访问类型。
  </para>

  <figure>
   <title>NFS 导出项列表</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   要查看某个 NFS 导出项的更多详细信息，请点击表中对应的行。
  </para>

  <figure>
   <title>NFS 导出项详细信息</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="dash-webui-nfs-create">
   <title>添加 NFS 导出项</title>
   <para>
    要添加新的 NFS 导出项，请点击导出项表格左上方的<guimenu>添加</guimenu>并输入所需的信息。
   </para>
   <figure>
    <title>添加新的 NFS 导出项</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      选择一个或多个将运行导出项的 NFS Ganesha 守护进程。
     </para>
    </step>
    <step>
     <para>
      选择存储后端 — <guimenu>CephFS</guimenu> 或<guimenu>对象网关</guimenu>。
     </para>
    </step>
    <step>
     <para>
      选择用户 ID 及其他后端相关选项。
     </para>
    </step>
    <step>
     <para>
      输入 NFS 导出项的目录路径。如果该目录在服务器上不存在，系统将创建该目录。
     </para>
    </step>
    <step>
     <para>
      指定其他 NFS 相关选项，例如支持的 NFS 协议版本、伪、访问类型、匿名访问或传输协议。
     </para>
    </step>
    <step>
     <para>
      如果您需要设置限制，仅允许特定的客户端访问，请点击<guimenu>添加客户端</guimenu>并添加它们的 IP 地址以及访问类型和匿名访问选项。
     </para>
    </step>
    <step>
     <para>
      点击<guimenu>提交</guimenu>进行确认。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dash-webui-nfs-delete">
   <title>删除 NFS 导出项</title>
   <para>
    要删除某个导出项，请点击表中对应的行，然后选择导出项表左上方的<guimenu>删除</guimenu>。
   </para>
  </sect2>

  <sect2 xml:id="dash-webui-nfs-edit">
   <title>编辑 NFS 导出项</title>
   <para>
    要编辑某个现有导出项，请点击表中对应的行，然后点击导出项表左上方的<guimenu>编辑</guimenu>。
   </para>
   <para>
    然后，您便可以调整 NFS 导出项的所有详细信息。
   </para>
   <figure>
    <title>编辑 NFS 导出项</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-mds">
  <title>管理 Ceph 文件系统</title>

  <tip>
   <title>更多信息</title>
   <para>
    要查看有关 CephFS 的详细信息，请参见<xref linkend="cha-ceph-cephfs"/>。
   </para>
  </tip>

  <sect2 xml:id="dashboard-mds-overview">
   <title>查看 CephFS 概览</title>
   <para>
    在主菜单中点击<guimenu>文件系统</guimenu>可查看配置的文件系统的概览。主表会显示每个文件系统的名称、创建日期，以及文件系统是否启用。
   </para>
   <para>
    点击表中某个文件系统对应的行，可查看其排位以及添加到其中的存储池的详细信息。
   </para>
   <figure>
    <title>CephFS 详细信息</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_cephfs_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_cephfs_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    您可在屏幕底部查看实时收集的相关 MDS Inode 及客户端请求数量统计数字。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-ogw">
  <title>管理对象网关</title>

  <tip>
   <title>对象网关的更多信息</title>
   <para>
    有关对象网关的更多一般信息，请参见<xref linkend="cha-ceph-gw"/>。
   </para>
  </tip>

  <sect2 xml:id="dashboard-ogw-view">
   <title>查看对象网关</title>
   <para>
    要查看配置的对象网关列表，请点击<menuchoice><guimenu>对象网关</guimenu><guimenu>守护进程</guimenu></menuchoice>。该列表包含网关的 ID、运行网关守护进程的集群节点的主机名以及网关的版本号。
   </para>
   <para>
    点击表中某个网关对应的行可查看该网关的详细信息。<guimenu>性能计数器</guimenu>选项卡显示有关读/写操作及缓存统计数据的详细信息。
   </para>
   <figure>
    <title>网关的详细信息</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_ogw_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_ogw_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-ogw-user">
   <title>管理对象网关用户</title>
   <para>
    点击<menuchoice><guimenu>对象网关</guimenu><guimenu>用户</guimenu></menuchoice>可查看现有对象网关用户的列表。
   </para>
   <para>
    点击表中某个用户对应的行可查看该用户帐户的详细信息，例如状态信息或用户配额及存储桶配额详细信息。
   </para>
   <figure>
    <title>网关用户</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_ogw_users_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_ogw_users_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3 xml:id="dashboard-ogw-user-create">
    <title>添加新网关用户</title>
    <para>
     要添加新网关用户，请点击表标题左上方的<guimenu>添加</guimenu>。填写其身份凭证、有关 S3 密钥及用户/存储桶配额的详细信息，然后点击<guimenu>添加</guimenu>进行确认。
    </para>
    <figure>
     <title>添加新网关用户</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_ogw_user_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_ogw_user_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3 xml:id="dashboard-ogw-user-delete">
    <title>删除网关用户</title>
    <para>
     要删除某个网关用户，请点击表中用户对应的行，然后选择表标题左上方的<guimenu>删除</guimenu>。激活<guimenu>是的，我确定</guimenu>复选框，然后点击<guimenu>删除用户</guimenu>进行确认。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-user-edit">
    <title>编辑网关用户详细信息</title>
    <para>
     要更改网关用户详细信息，请点击表中用户对应的行，然后选择表标题左上方的<guimenu>编辑</guimenu>。
    </para>
    <para>
     修改基本或附加用户信息，例如其用户权限、密钥、子用户和配额信息。点击<guimenu>更新</guimenu>进行确认。
    </para>
    <para>
     <guimenu>密钥</guimenu>选项卡包含只读的网关用户列表以及这些用户的访问密钥和秘密密钥。要查看这些密钥，请点击列表中的用户名，然后选择表标题左上方的<guimenu>显示</guimenu>。在 <guimenu>S3 密钥</guimenu>对话框中，点击眼睛图标可显示密钥，点击剪贴板图标可将相关密钥复制到剪贴板。
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-ogw-bucket">
   <title>管理对象网关存储桶</title>
   <para>
    对象网关 (OGW) 存储桶实现了 OpenStack Swift 容器的功能。对象网关存储桶可充当存储数据对象的容器。
   </para>
   <para>
    点击<menuchoice><guimenu>对象网关</guimenu><guimenu>存储桶</guimenu></menuchoice>可查看 OGW 存储桶列表。
   </para>
   <sect3 xml:id="dashboard-ogw-bucket-create">
    <title>添加新的存储桶</title>
    <para>
     要添加新 OGW 存储桶，请点击表标题左上方的<guimenu>添加</guimenu>。输入存储桶的名称，并选择其所有者。点击<guimenu>添加</guimenu>进行确认。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-view">
    <title>查看存储桶详细信息</title>
    <para>
     要查看某个 OGW 存储桶的详细信息，请点击表中对应的行。
    </para>
    <figure>
     <title>网关存储桶详细信息</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_ogw_bucket_details.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_ogw_bucket_details.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <tip>
     <title>存储桶配额</title>
     <para>
      您可以在<guimenu>详情</guimenu>表下方查看存储桶配额设置的详细信息。
     </para>
    </tip>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-edit">
    <title>更新存储桶的所有者</title>
    <para>
     点击表中某个存储桶对应的行，然后选择表标题左上方的<guimenu>编辑</guimenu>。
    </para>
    <para>
     更新存储桶的所有者，然后点击<guimenu>更新</guimenu>进行确认。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-delete">
    <title>删除存储桶</title>
    <para>
     要删除某个 OGW 存储桶，请点击表中对应的行，然后选择表标题左上方的<guimenu>删除</guimenu>。激活<guimenu>是的，我确定</guimenu>复选框，然后点击<guimenu>删除存储桶</guimenu>进行确认。
    </para>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-initial-configuration">
  <title>手动配置</title>

  <para>
   本节为更喜欢在命令行上手动配置仪表盘设置的用户提供了较深入的信息。
  </para>

  <sect2 xml:id="dashboard-ssl">
   <title>TLS/SSL 支持</title>
   <para>
    所有连至仪表盘的 HTTP 连接默认都使用 SSL/TLS 来保障安全。安全连接需要 SSL 证书。您可以使用自我签名证书，也可以生成证书并让知名证书颁发机构 (CA) 对其签名。
   </para>
   <tip>
    <title>禁用 SSL</title>
    <para>
     您可能会出于某种原因需要禁用 SSL 支持。例如，如果仪表盘是在不支持 SSL 的代理之后运行。
    </para>
    <para>
     禁用 SSL 要慎重，因为禁用 SSL 后，<emphasis role="bold">用户名和密码</emphasis>将以<emphasis role="bold">未加密</emphasis>的形式发送到仪表盘。
    </para>
    <para>
     要禁用 SSL，请运行以下命令：
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/ssl false
</screen>
   </tip>
   <tip>
    <title>重启动 Ceph Manager 进程</title>
    <para>
     更改 SSL 证书和密钥后，您需要手动重启动 Ceph Manager 进程。您可以通过运行以下命令
    </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph mgr fail<replaceable>ACTIVE-MANAGER-NAME</replaceable></screen>
    <para>
     或禁用后再重新启用仪表盘扩展模块的方式来执行此操作，如此还会触发 Manager 的自我重新生成：
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph mgr module disable dashboard
<prompt>cephadm@adm &gt; </prompt>ceph mgr module enable dashboard
</screen>
   </tip>
   <sect3 xml:id="self-sign-certificates">
    <title>自我签名证书</title>
    <para>
     为了安全通讯而创建自我签名证书的过程非常简单。采用这种方式可迅速让仪表盘运行起来。
    </para>
    <note>
     <title>Web 浏览器控诉</title>
     <para>
      大多数 Web 浏览器都将对自我签名证书发起控诉，并需要在建立与仪表盘的安全连接前进行明确确认。
     </para>
    </note>
    <para>
     要生成并安装自我签名证书，请使用以下内置命令：
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard create-self-signed-cert
</screen>
   </sect3>
   <sect3 xml:id="cert-sign-CA">
    <title>CA 签名的证书</title>
    <para>
     为了正确保障连至仪表盘的连接安全，以及消除 Web 浏览器对自我签名证书的控诉，我们建议使用 CA 签名的证书。
    </para>
    <para>
     您可以使用如下命令生成证书密钥对：
    </para>
<screen>
<prompt>root # </prompt>openssl req -new -nodes -x509 \
  -subj "/O=IT/CN=ceph-mgr-dashboard" -days 3650 \
  -keyout dashboard.key -out dashboard.crt -extensions v3_ca
</screen>
    <para>
     以上命令会输出 <filename>dashboard.key</filename> 和 <filename>dashboard.crt</filename> 文件。获得 CA 签名的 <filename>dashboard.crt</filename> 文件后，请运行以下命令为所有 Ceph Manager 实例启用该证书：
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/crt -i dashboard.crt
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/key -i dashboard.key
</screen>
    <tip>
     <title>每个 Manager 实例使用不同的证书</title>
     <para>
      如果您需要为每个 Ceph Manager 实例使用不同的证书，请按如下所示修改命令，在其中指定实例的名称。将 <replaceable>NAME</replaceable> 替换为 Ceph Manager 实例的名称（通常是相关的主机名）：
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/crt -i dashboard.crt
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/key -i dashboard.key
</screen>
    </tip>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-hostname-port">
   <title>主机名和端口号</title>
   <para>
    Ceph Dashboard Web 应用与特定 TCP/IP 地址和 TCP 端口绑定。默认情况下，托管仪表盘的当前活跃 Ceph Manager 会与 TCP 端口 8443 绑定（如果禁用 SSL，则与 8080 端口绑定）。
   </para>
   <para>
    仪表盘 Web 应用默认与“::”绑定，该符号表示所有可用的 IPv4 和 IPv6 地址。您可以使用以下命令更改 Web 应用的 IP 地址和端口号，以使它们适用于所有 Ceph Manager 实例：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/server_addr <replaceable>IP_ADDRESS</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   <tip>
    <title>分别配置 Ceph Manager 实例</title>
    <para>
     因为每个 <systemitem class="daemon">ceph-mgr</systemitem> 守护进程都托管着各自的仪表盘实例，您可能需要分别配置每个 Ceph Manager 实例。使用以下命令（将 <replaceable>NAME</replaceable> 替换为 <systemitem class="daemon">ceph-mgr</systemitem> 实例的 ID）更改特定 Manager 实例的 IP 地址和端口号：
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_addr <replaceable>IP_ADDRESS</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   </tip>
   <tip>
    <title>列出配置的端点</title>
    <para>
     <command>ceph mgr services</command> 命令会显示当前配置的所有端点。查找“dashboard”键可获取用于访问仪表盘的 URL。
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dashboard-username-password">
   <title>用户名和口令</title>
   <para>
    如果您不想使用默认管理员帐户，可创建其他用户帐户并将其与至少一个角色相关联。我们提供了一组预定义的系统角色供您使用。有关详细信息，请参见 <xref linkend="dashboard-user-roles"/>。
   </para>
   <para>
    要创建具有管理员权限的用户，请使用以下命令：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-create <replaceable>USER_NAME</replaceable> <replaceable>PASSWORD</replaceable> administrator
</screen>
  </sect2>

  <sect2 xml:id="dashboard-ogw-enabling">
   <title>启用对象网关管理前端</title>
   <para>
    要使用仪表盘的对象网关管理功能，您需要提供启用了“system”标志的用户的登录凭证：
   </para>
   <procedure>
    <step>
     <para>
      如果您没有带“system”标志的用户，请创建一个：
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>radosgw-admin user create --uid=<replaceable>USER_ID</replaceable> --display-name=<replaceable>DISPLAY_NAME</replaceable> --system
</screen>
     <para>
      记下命令输出中的“access_key”和“secret_key”密钥。
     </para>
    </step>
    <step>
     <para>
      您还可以使用 <command>radosgw-admin</command> 命令来获取现有用户的身份凭证：
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>radosgw-admin user info --uid=<replaceable>USER_ID</replaceable>
</screen>
    </step>
    <step>
     <para>
      向仪表盘提供收到的身份凭证：
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-access-key <replaceable>ACCESS_KEY</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-secret-key <replaceable>SECRET_KEY</replaceable>
</screen>
    </step>
   </procedure>
   <para>
    请注意以下几点事项：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      对象网关的主机名和端口号是自动确定的。
     </para>
    </listitem>
    <listitem>
     <para>
      如果使用多个区域，对象网关会自动确定主区域组和主区域内的主机。此方式足以满足大部分设置的需求，但在某些情况下，您可能需要手动设置主机名和端口：
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-host <replaceable>HOST</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-port <replaceable>PORT</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      下面是您可能需要进行的额外设置：
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-scheme <replaceable>SCHEME</replaceable>  # http or https
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-admin-resource <replaceable>ADMIN_RESOURCE</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-user-id <replaceable>USER_ID</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      如果您在对象网关设置中使用的是自我签名证书（<xref linkend="dashboard-ssl"/>），请在仪表盘中禁用证书验证，以免发生因证书是由未知 CA 签名或与主机名不符而导致连接被拒。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-ssl-verify False
</screen>
    </listitem>
    <listitem>
     <para>
      如果对象网关处理请求所花的时间过长，导致仪表盘超时，则可调整超时值（默认为 45 秒）：
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rest-requests-timeout <replaceable>SECONDS</replaceable>
</screen>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="dashboard-sso">
   <title>启用单点登录</title>
   <para>
    <emphasis>单点登录</emphasis> (SSO) 是一种允许用户以单个 ID 和密码同时登录多个应用的访问控制方法。
   </para>
   <para>
    Ceph Dashboard 支持通过 SAML 2.0 协议对用户进行外部身份验证。由于<emphasis>授权</emphasis>仍由仪表盘执行，因此您需要先创建用户帐户并将其与所需角色相关联。不过，<emphasis>身份验证</emphasis>过程可由现有<emphasis>身份提供者</emphasis> (IdP) 执行。
   </para>
   <para>
    要配置单点登录，请使用以下命令：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso setup saml2 <replaceable>CEPH_DASHBOARD_BASE_URL</replaceable> \
 <replaceable>IDP_METADATA</replaceable> <replaceable>IDP_USERNAME_ATTRIBUTE</replaceable> \
 <replaceable>IDP_ENTITY_ID</replaceable> <replaceable>SP_X_509_CERT</replaceable> \
 <replaceable>SP_PRIVATE_KEY</replaceable>
</screen>
   <para>
    参数：
   </para>
   <variablelist>
    <varlistentry>
     <term><replaceable>CEPH_DASHBOARD_BASE_URL</replaceable></term>
     <listitem>
      <para>
       可用于访问 Ceph Dashboard 的基本 URL（例如“https://cephdashboard.local”）。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_METADATA</replaceable></term>
     <listitem>
      <para>
       IdP 元数据 XML 的 URL、文件路径或内容（例如“https://myidp/metadata”）。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_USERNAME_ATTRIBUTE</replaceable></term>
     <listitem>
      <para>
       可选。将用于从身份验证响应中获取用户名的属性。默认为“uid”。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_ENTITY_ID</replaceable></term>
     <listitem>
      <para>
       可选。当 IdP 元数据上存在多个实体 ID 时，请使用该参数。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>SP_X_509_CERT</replaceable> / <replaceable>SP_PRIVATE_KEY</replaceable></term>
     <listitem>
      <para>
       可选。Ceph Dashboard（服务提供程序）进行签名和加密时将使用的证书的文件路径或内容。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <note>
    <title>SAML 请求</title>
    <para>
     SAML 请求的发出者值将采用以下格式：
    </para>
<screen>
<replaceable>CEPH_DASHBOARD_BASE_URL</replaceable>/auth/saml2/metadata
</screen>
   </note>
   <para>
    要显示当前 SAML 2.0 配置，请运行以下命令：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso show saml2
</screen>
   <para>
    要禁用单点登录，请运行以下命令：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso disable
</screen>
   <para>
    要检查是否启用了 SSO，请运行以下命令：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso status
</screen>
   <para>
    要启用 SSO，请运行以下命令：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso enable saml2
</screen>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-user-roles">
  <title>在命令行上管理用户和角色</title>

  <para>
   本节说明如何管理 Ceph Dashboard 使用的用户帐户。该工具可帮助您创建或修改用户帐户，以及设置正确的用户角色和权限。
  </para>

  <sect2 xml:id="dahsboard-user-accounts">
   <title>用户帐户</title>
   <para>
    Ceph Dashboard 支持管理多个用户帐户。每个用户帐户包含用户名、密码（使用 <literal>bcrypt</literal> 以加密形式存储）、可选名称和可选电子邮件地址。
   </para>
   <para>
    用户帐户存储在 Ceph Manager 的配置数据库中，并在所有 Ceph Manager 实例之间全局共享。
   </para>
   <para>
    使用以下命令可管理用户帐户：
   </para>
   <variablelist>
    <varlistentry>
     <term>显示现有用户：</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-show [<replaceable>USERNAME</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>创建新用户：</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-create <replaceable>USERNAME</replaceable> [<replaceable>PASSWORD</replaceable>] [<replaceable>ROLENAME</replaceable>] [<replaceable>NAME</replaceable>] [<replaceable>EMAIL</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>删除用户：</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-delete <replaceable>USERNAME</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>更改用户密码：</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-password <replaceable>USERNAME</replaceable> <replaceable>PASSWORD</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>修改用户名和电子邮件：</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-info <replaceable>USERNAME</replaceable> <replaceable>NAME</replaceable> <replaceable>EMAIL</replaceable>
</screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard-permissions">
   <title>用户角色和权限</title>
   <para>
    本节说明您可为用户角色指定的安全作用范围、如何管理用户角色，以及如何为用户帐户指定角色。
   </para>
   <sect3>
    <title>安全作用范围</title>
    <para>
     用户帐户与一组角色相关联，这些角色定义了该用户可以访问仪表盘的哪些部分。仪表盘的各个部分均会划分在某个<emphasis>安全</emphasis>作用范围内。安全作用范围已预先定义且固定不变。当前可用的安全作用范围如下：
    </para>
    <variablelist>
     <varlistentry>
      <term>hosts</term>
      <listitem>
       <para>
        包含与<guimenu>主机</guimenu>菜单项相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>config-opt</term>
      <listitem>
       <para>
        包含与 Ceph 配置选项管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool</term>
      <listitem>
       <para>
        包含与存储池管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>osd</term>
      <listitem>
       <para>
        包含与 Ceph OSD 管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>monitor</term>
      <listitem>
       <para>
        包含与 Ceph Monitor 管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-image</term>
      <listitem>
       <para>
        包含与 RADOS 块设备映像管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-mirroring</term>
      <listitem>
       <para>
        包含与 RADOS 块设备镜像管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>iscsi</term>
      <listitem>
       <para>
        包含与 iSCSI 管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw</term>
      <listitem>
       <para>
        包含与对象网关管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs</term>
      <listitem>
       <para>
        包含与 CephFS 管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>manager</term>
      <listitem>
       <para>
        包含与 Ceph Manager 管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>log</term>
      <listitem>
       <para>
        包含与 Ceph 日志管理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>grafana</term>
      <listitem>
       <para>
        包含与 Grafana 代理相关的所有特性。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>dashboard-settings</term>
      <listitem>
       <para>
        允许更改仪表盘设置。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>用户角色</title>
    <para>
     <emphasis>角色</emphasis>指定了一个<emphasis>安全作用范围</emphasis>与一组<emphasis>权限</emphasis>之间的一组映射。权限分为四种类型：“read”、“create”、“update”和“delete”。
    </para>
    <para>
     下面的示例指定了一个角色，具有该角色的用户拥有与存储池管理相关的特性的“read”和“create”权限，以及与 RBD 映像管理相关的特性的全部权限：
    </para>
<screen>
{
  'role': 'my_new_role',
  'description': 'My new role',
  'scopes_permissions': {
    'pool': ['read', 'create'],
    'rbd-image': ['read', 'create', 'update', 'delete']
  }
}
</screen>
    <para>
     仪表盘提供了一组预定义角色，我们称之为<emphasis>系统角色</emphasis>。全新安装 Ceph Dashboard 后即可使用这些角色：
    </para>
    <variablelist>
     <varlistentry>
      <term>administrator</term>
      <listitem>
       <para>
        提供针对所有安全作用范围的全部权限。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>read-only</term>
      <listitem>
       <para>
        提供针对仪表盘设置以外的其他所有安全作用范围的 read 权限。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>block-manager</term>
      <listitem>
       <para>
        提供针对“rbd-image”、“rbd-mirroring”和“iscsi”作用范围的全部权限。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw-manager</term>
      <listitem>
       <para>
        提供针对“rgw”作用范围的全部权限。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cluster-manager</term>
      <listitem>
       <para>
        提供针对“hosts”、“osd”、“monitor”、“manager”和“config-opt”作用范围的全部权限。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool-manager</term>
      <listitem>
       <para>
        提供针对“pool”作用范围的全部权限。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs-manager</term>
      <listitem>
       <para>
        提供针对“cephfs”作用范围的全部权限。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <sect4>
     <title>管理自定义角色</title>
     <para>
      您可以使用以下命令创建新用户角色：
     </para>
     <variablelist>
      <varlistentry>
       <term>创建新角色：</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-create <replaceable>ROLENAME</replaceable> [<replaceable>DESCRIPTION</replaceable>]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>删除角色:</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-delete <replaceable>ROLENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>为角色添加作用范围权限：</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-add-scope-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable> <replaceable>PERMISSION</replaceable> [<replaceable>PERMISSION</replaceable>...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>从角色中删除作用范围权限：</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-del-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
    </sect4>
    <sect4>
     <title>为用户帐户指定角色</title>
     <para>
      使用以下命令可为用户指定角色：
     </para>
     <variablelist>
      <varlistentry>
       <term>设置用户角色：</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>为用户添加其他角色：</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-add-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>删除用户的角色：</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-del-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
     <tip>
      <title>清除自定义角色</title>
      <para>
       如果您创建了自定义用户角色，并打算以后使用 <command>ceph.purge</command> 运行程序删除 Ceph 集群，则需要先清除自定义角色。有关详细信息，请参见<xref linkend="deepsea-ceph-purge"/>。
      </para>
     </tip>
    </sect4>
    <sect4>
     <title>示例：创建用户和自定义角色</title>
     <para>
      本节说明创建具有以下权限的用户帐户的过程：可管理 RBD 映像、查看和创建 Ceph 存储池，并拥有针对任何其他安全作用范围的只读访问权限。
     </para>
     <procedure>
      <step>
       <para>
        创建名为“tux”的新用户：
       </para>
<screen>
 <prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-create tux <replaceable>PASSWORD</replaceable>
</screen>
      </step>
      <step>
       <para>
        创建角色并指定作用范围权限：
       </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-create rbd/pool-manager
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-add-scope-perms rbd/pool-manager \
 rbd-image read create update delete
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-add-scope-perms rbd/pool-manager pool read create
</screen>
      </step>
      <step>
       <para>
        将角色与“tux”用户相关联：
       </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-roles tux rbd/pool-manager read-only
</screen>
      </step>
     </procedure>
    </sect4>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-proxy">
   <title>反向代理</title>
   <para>
    如果您要通过反向代理配置访问仪表盘，则可能需要使用 URL 前缀来访问。要让仪表盘使用包含您前缀的超链接，您可以设置 <option>url_prefix</option> 设置：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/url_prefix <replaceable>URL_PREFIX</replaceable>
</screen>
   <para>
    然后，您便可通过网址 <literal>http://<replaceable>HOST_NAME</replaceable>:<replaceable>PORT_NUMBER</replaceable>/<replaceable>URL_PREFIX</replaceable>/</literal> 来访问仪表盘。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-auditing">
   <title>审计</title>
   <para>
    Ceph Dashboard 的 REST API 可在 Ceph 审计日志中记录 PUT、POST 和 DELETE 请求。记录功能默认处于禁用状态，但您可使用以下命令将其启用：
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-audit-api-enabled true
</screen>
   <para>
    如果记录功能处于启用状态，将会记录每个请求的以下参数：
   </para>
   <variablelist>
    <varlistentry>
     <term>from</term>
     <listitem>
      <para>
       请求的来源，例如“https://[::1]:44410”。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>path</term>
     <listitem>
      <para>
       REST API 路径，例如“/api/auth”。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>method</term>
     <listitem>
      <para>
       “PUT”、“POST”或“DELETE”。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>user</term>
     <listitem>
      <para>
       用户的名称（或“None”）。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    示例日志项如下所示：
   </para>
<screen>
2019-02-06 10:33:01.302514 mgr.x [INF] [DASHBOARD] \
 from='https://[::ffff:127.0.0.1]:37022' path='/api/rgw/user/exu' method='PUT' \
 user='admin' params='{"max_buckets": "1000", "display_name": "Example User", "uid": "exu", "suspended": "0", "email": "user@example.com"}'
</screen>
   <tip>
    <title>禁用记录请求有效负载的功能</title>
    <para>
     请求有效负载（自变量及其值的列表）的记录功能默认处于启用状态。您可以按照如下方式禁用该功能：
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-audit-api-log-payload false
</screen>
   </tip>
  </sect2>
 </sect1>
</chapter>
