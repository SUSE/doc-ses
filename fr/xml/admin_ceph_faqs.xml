<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ceph_faqs.xml" version="5.0" xml:id="storage-faqs">
 <title>Foire aux questions</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>oui</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para/>
 <sect1 xml:id="storage-bp-tuneups-pg-num">
  <title>Comment le nombre de groupes de placement affecte-t-il les performances de la grappe ?</title>

  <para>
   Lorsque la grappe est pleine entre 70 % et 80 %, il est temps de lui ajouter des OSD. Lorsque vous augmentez le nombre d'OSD, vous pouvez également augmenter le nombre de groupes de placement (Placement Group, PG).
  </para>

  <warning>
   <para>
    La modification du nombre de groupes de placement entraîne de nombreux transferts de données dans la grappe.
   </para>
  </warning>

  <para>
   Le calcul de la valeur optimale de la grappe qui vient d'être redimensionnée est une tâche complexe.
  </para>

  <para>
   Un grand nombre de groupes de placement génère de petites tranches de données. Cela accélère la reprise après sinistre en cas d'échec d'un OSD, mais charge considérablement les noeuds de moniteur qui sont responsables du calcul de l'emplacement des données.
  </para>

  <para>
   En revanche, avec un faible nombre de groupes de placement, le transfert de données est plus long en cas de reprise après défaillance d'un OSD, mais la charge est moindre sur les noeuds de moniteur, car le calcul des emplacements porte sur des tranches de données moins nombreuses (mais plus volumineuses).
  </para>

  <para>
   Vous trouverez plus d'informations sur le nombre optimal de groupes de placement pour votre grappe à la <xref linkend="op-pgs-pg-num"/>.
  </para>
 </sect1>
 <sect1 xml:id="storage-bp-tuneups-mix-ssd">
  <title>Puis-je utiliser des disques SSD et des disques durs sur la même grappe ?</title>

  <para>
   Les disques SSD (Solid-State Drives) sont généralement plus rapides que les disques durs traditionnels. Si vous mélangez les deux types de disques pour la même opération d'écriture, l'écriture des données sur le disque SSD est ralentie par les performances du disque dur. Par conséquent, vous ne devez <emphasis>jamais mélanger disques SSD et disques durs</emphasis> pour l'écriture de données suivant <emphasis>la même règle</emphasis> (reportez-vous à la <xref linkend="datamgm-rules"/> pour plus d'informations sur les règles de stockage des données).
  </para>

  <para>
   Il existe deux cas où l'utilisation de SSD et de disques durs sur la même grappe se justifie :
  </para>

  <orderedlist spacing="normal">
   <listitem>
    <para>
     Vous pouvez utiliser chaque type de disque pour écrire des données suivant des règles différentes. Vous devez alors disposer d'une règle distincte pour le disque SSD et d'une autre règle pour le disque dur.
    </para>
   </listitem>
   <listitem>
    <para>
     Vous pouvez utiliser chaque type de disque dans un but spécifique, par exemple, le disque SSD pour le journal et le disque dur pour le stockage de données.
    </para>
   </listitem>
  </orderedlist>
 </sect1>
 <sect1 xml:id="storage-bp-tuneups-ssd-tradeoffs">
  <title>Quels sont les inconvénients de l'utilisation d'un journal sur SSD ?</title>

  <para>
   L'utilisation de disques SSD pour un ou plusieurs journaux OSD est préférable pour les performances, car le journal constitue habituellement le goulot d'étranglement des OSD à disques durs uniquement. Les disques SSD sont souvent utilisés pour partager les journaux de plusieurs OSD.
  </para>

  <para>
   Voici une liste des inconvénients potentiels de l'utilisation de disques SSD pour un journal OSD :
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Les disques SSD sont plus onéreux que les disques durs. Cependant, comme un journal OSD ne nécessite que 6 Go d'espace disque maximum, le prix peut ne pas être si crucial pour votre entreprise.
    </para>
   </listitem>
   <listitem>
    <para>
     Pour étendre la capacité de la grappe, le disque SSD occupe les connecteurs de stockage qui pourraient autrement être occupés par un disque dur de grande taille.
    </para>
   </listitem>
   <listitem>
    <para>
     Par rapport aux disques durs, les disques SSD ont des cycles d'écriture réduits, mais avec les technologies modernes, cet inconvénient tend à disparaître.
    </para>
   </listitem>
   <listitem>
    <para>
     Si vous partagez plusieurs journaux sur le même disque SSD, vous risquez de perdre tous les OSD associés en cas de défaillance de ce dernier. Le rééquilibrage de la grappe vous obligera à déplacer de gros volumes de données.
    </para>
   </listitem>
   <listitem>
    <para>
     La connexion à chaud des disques devient plus complexe étant donné que l'assignation de données ne s'effectue pas dans une relation 1:1 entre l'OSD défaillant et le disque de journal. 
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="storage-bp-monitoring-diskfails">
  <title>Que se passe-t-il en cas de défaillance d'un disque ?</title>

  <para>
   Lorsqu'un disque comportant des données de grappe enregistrées ne fonctionne plus en raison d'un problème matériel, voici ce qui se passe :
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     L'OSD associé qui s'est bloqué est automatiquement supprimé de la grappe.
    </para>
   </listitem>
   <listitem>
    <para>
     Les données du disque défaillant sont répliquées sur un autre OSD de la grappe à partir d'autres copies des mêmes données stockées sur d'autres OSD.
    </para>
   </listitem>
   <listitem>
    <para>
     Ensuite, vous devez supprimer le disque de la carte CRUSH de la grappe et le démonter physiquement du matériel hôte.
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="storage-bp-monitoring-journalfails">
  <title>Que se passe-t-il en cas de défaillance d'un disque de journal ?</title>

  <para>
   Ceph peut être configuré pour stocker des journaux ou écrire des journaux en amont sur des périphériques distincts des OSD. En cas de défaillance d'un disque dédié à un journal, l'échec du ou des OSD associés est également observé (reportez-vous à la <xref linkend="storage-bp-monitoring-diskfails"/>).
  </para>

  <warning>
   <title>hébergement de plusieurs journaux sur un disque</title>
   <para>
    Pour améliorer les performances, vous pouvez utiliser un disque rapide (tel qu'un SSD) afin de stocker des partitions de journal de plusieurs OSD. Il est déconseillé d'héberger les journaux de plus de 4 OSD sur un même disque, car, en cas de défaillance de ce dernier, vous risquez de perdre les données stockées de tous les disques OSD associés.
   </para>
  </warning>
 </sect1>
</chapter>
