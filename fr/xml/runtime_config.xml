<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="runtime_config.xml" version="5.0" xml:id="cha-ceph-configuration">
 <title>Configuration de la grappe Ceph</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/maintenance/ses6/xml/</dm:editurl>
   <dm:translation>oui</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Ce chapitre fournit une liste des paramètres importants de la grappe Ceph et leur description. Les paramètres sont triés par sujet.
 </para>
 <sect1 xml:id="ceph-config-runtime">
  <title>Configuration d'exécution</title>

  <para>
   La <xref linkend="ds-custom-cephconf"/> décrit la procédure d'ajout de modifications au fichier de configuration Ceph <filename>ceph.conf</filename>. Cependant, le comportement réel de la grappe n'est pas déterminé par l'état actuel du fichier <filename>ceph.conf</filename>, mais par la configuration stockée en mémoire pour les daemons Ceph en cours d'exécution.
  </para>

  <para>
   Vous pouvez interroger un daemon Ceph individuel pour un paramètre de configuration particulier à l'aide du <emphasis>socket admin</emphasis> sur le noeud où le daemon est en cours d'exécution. Par exemple, la commande suivante obtient la valeur du paramètre de configuration <option>osd_max_write_size</option> à partir du daemon nommé <literal>osd.0</literal> :
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph --admin-daemon /var/run/ceph/ceph-osd.0.asok \
config get osd_max_write_size
{
  "osd_max_write_size": "90"
}</screen>

  <para>
   Vous pouvez aussi <emphasis>modifier</emphasis> les paramètres des daemons au moment de l'exécution. N'oubliez pas que cette modification est temporaire et sera perdue après le prochain redémarrage du daemon. Par exemple, la commande suivante modifie le paramètre <option>osd_max_write_size</option> sur « 50 » pour tous les OSD de la grappe :
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph tell osd.* injectargs --osd_max_write_size 50</screen>

  <warning>
   <title><command>injectargs</command> n'est pas fiable</title>
   <para>
    Malheureusement, la modification des paramètres de grappe n'est pas fiable à 100 % avec la commande <command>injectargs</command>. Si vous devez vous assurer que le paramètre modifié est actif, modifiez-le dans les fichiers de configuration sur tous les noeuds de la grappe et redémarrez tous les daemons de la grappe.
   </para>
  </warning>
 </sect1>
 <sect1 xml:id="config-osd-and-bluestore">


  <title>Ceph OSD et BlueStore</title>

  <sect2 xml:id="config-auto-cache-sizing">
   <title>Dimensionnement automatique des caches</title>
   <para>
    BlueStore peut être configuré pour redimensionner automatiquement ses caches lorsque <option>tc_malloc</option> est configuré comme option d'allocation de mémoire et que le paramètre <option>bluestore_cache_autotune</option> est activé. Cette option est actuellement activée par défaut. BlueStore tente alors de maintenir l'utilisation de la mémoire de segment OSD sous une taille cible désignée via l'option de configuration <option>osd_memory_target</option>. Il s'agit d'un algorithme du meilleur d'effort (« Best Effort ») ; les caches ne passeront pas en dessous de la quantité minimale spécifiée par la valeur <option>osd_memory_cache_min</option>. Les ratios de cache seront choisis en fonction d'une hiérarchie de priorités. Si l'information de priorité n'est pas disponible, les options <option>bluestore_cache_meta_ratio</option> et <option>bluestore_cache_kv_ratio</option> sont utilisées à la place.
   </para>
   <variablelist>
    <varlistentry>
     <term>bluestore_cache_autotune</term>
     <listitem>
      <para>
       Aligne automatiquement les ratios assignés à différents caches BlueStore tout en respectant les valeurs minimales. La valeur par défaut est <option>True</option>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_target</term>
     <listitem>
      <para>
       Lorsque <option>tc_malloc</option> et <option>bluestore_cache_autotune</option> sont activés, essayez de garder ces nombreux octets assignés en mémoire.
      </para>
      <note>
       <para>
        Cela peut ne pas correspondre exactement à l'utilisation de la mémoire RSS du processus. Bien que la quantité totale de mémoire de segment assignée par le processus devrait généralement rester proche de cette cible, il n'y a aucune garantie que le kernel va effectivement récupérer la mémoire dont l'assignation a été annulée.
       </para>
      </note>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_cache_min</term>
     <listitem>
      <para>
       Lorsque <option>tc_malloc</option> et <option>bluestore_cache_autotune</option> sont activés, définissez la quantité minimale de mémoire utilisée pour les caches.
      </para>
      <note>
       <para>
        Si vous définissez cette option sur une valeur trop faible, cela peut entraîner un débordement considérable des caches.
       </para>
      </note>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 xml:id="config-ogw">
  <title>Ceph Object Gateway</title>

  <para>
   Vous pouvez influencer le comportement d'Object Gateway avec plusieurs options du fichier <filename>/etc/ceph/ceph.conf</filename> sous les sections nommées comme suit :
  </para>

<screen>
[client.radosgw.<replaceable>INSTANCE_NAME</replaceable>]
</screen>

  <para>
   Si une option n'est pas spécifiée, sa valeur par défaut est utilisée. Vous trouverez ci-dessous une liste complète des options Object Gateway.
  </para>



  <sect2>
   <title>Paramètres généraux</title>
   <variablelist>
    <varlistentry>
     <term>rgw_frontends</term>
     <listitem>
      <para>
       Configure l'interface client HTTP. Pour en spécifier plusieurs, définissez-les dans une liste séparée par des virgules. Chaque configuration d'interface client peut inclure une liste d'options séparées par des espaces, dans laquelle chaque option se présente sous la forme « clé=valeur » ou « clé ». La valeur par défaut est :
      </para>
<screen>
rgw_frontends = beast port=7480
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data</term>
     <listitem>
      <para>
       Définit l'emplacement des fichiers de données pour Object Gateway. La valeur par défaut est <filename>/var/lib/ceph/radosgw/<replaceable>ID_GRAPPE</replaceable></filename>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_apis</term>
     <listitem>
      <para>
       Active les API spécifiées. Par défaut, il s'agit de « s3, swift, swift_auth, admin All APIs ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_enabled</term>
     <listitem>
      <para>
       Active ou désactive le cache Object Gateway. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_lru_size</term>
     <listitem>
      <para>
       Nombre d'entrées dans le cache Object Gateway. La valeur par défaut est 10000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_socket_path</term>
     <listitem>
      <para>
       Chemin du socket du domaine. <option>FastCgiExternalServer</option> utilise ce socket. Si vous ne spécifiez pas de chemin de socket, Object Gateway ne s'exécutera pas en tant que serveur externe. Le chemin que vous spécifiez ici doit être le même que celui indiqué dans le fichier <filename>rgw.conf</filename>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_fcgi_socket_backlog</term>
     <listitem>
      <para>
       Backlog de socket pour fcgi. La valeur par défaut est 1024.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_host</term>
     <listitem>
      <para>
       Hôte de l'instance Object Gateway. Il peut s'agir d'une adresse IP ou d'un nom hôte. La valeur par défaut est 0.0.0.0.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_port</term>
     <listitem>
      <para>
       Numéro de port sur lequel l'instance écoute les requêtes. S'il n'est pas spécifié, Object Gateway exécute la fonction externe FastCGI.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_dns_name</term>
     <listitem>
      <para>
       Nom DNS du domaine desservi.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_script_uri</term>
     <listitem>
      <para>
       Valeur alternative pour le SCRIPT_URI si elle n'est pas définie dans la requête.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_request_uri</term>
     <listitem>
      <para>
       Valeur alternative pour REQUEST_URI si elle n'est pas définie dans la requête.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_print_continue</term>
     <listitem>
      <para>
       Permet d'activer le code 100-continue s'il est opérationnel. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_remote_addr_param</term>
     <listitem>
      <para>
       Paramètre de l'adresse distante. Par exemple, le champ HTTP contenant l'adresse distante ou l'adresse X-Forwarded-For si un proxy inverse est opérationnel. La valeur par défaut est REMOTE_ADDR.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_timeout</term>
     <listitem>
      <para>
       Timeout en secondes pour les threads ouverts. La valeur par défaut est 600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_suicide_timeout</term>
     <listitem>
      <para>
       Timeout en secondes avant la mort du processus Object Gateway. Il est désactivé s'il est défini sur 0 (valeur par défaut).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_thread_pool_size</term>
     <listitem>
      <para>
       Nombre de threads pour le serveur Beast. Définissez une valeur plus élevée si vous devez servir plus de demandes. La valeur par défaut est de 100 threads.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_rados_handles</term>
     <listitem>
      <para>
       Nombre d'identificateurs de grappe RADOS pour Object Gateway. Désormais, chaque thread de travail Object Gateway sélectionne un identificateur RADOS pour toute sa durée de vie. Cette option est à présent obsolète et pourra être supprimée dans les versions futures. La valeur par défaut est 1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_control_oids</term>
     <listitem>
      <para>
       Nombre d'objets de notification utilisés pour la synchronisation des caches entre différentes instances rgw. La valeur par défaut est 8.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_init_timeout</term>
     <listitem>
      <para>
       Nombre de secondes avant qu'Object Gateway renonce à l'initialisation. La valeur par défaut est 30.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_mime_types_file</term>
     <listitem>
      <para>
       Chemin et emplacement des types MIME. Utilisés pour détection automatique des types d'objets par Swift. La valeur par défaut est <filename>/etc/mime.types</filename>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_max_objs</term>
     <listitem>
      <para>
       Nombre maximal d'objets pouvant être gérés par la récupération d'espace mémoire au cours d'un cycle de traitement. La valeur par défaut est 32.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_obj_min_wait</term>
     <listitem>
      <para>
       Délai d'attente minimal avant que l'objet puisse être retiré et géré par le processus de récupération d'espace mémoire. La valeur par défaut est 2 * 3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_max_time</term>
     <listitem>
      <para>
       Durée maximale entre le début de deux cycles consécutifs de récupération d'espace mémoire. La valeur par défaut est 3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_period</term>
     <listitem>
      <para>
       Temps de cycle pour la récupération d'espace mémoire. La valeur par défaut est 3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_s3_success_create_obj_status</term>
     <listitem>
      <para>
       Autre réponse de statut de réussite pour <literal>create-obj</literal>. La valeur par défaut est 0.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_resolve_cname</term>
     <listitem>
      <para>
       Indique si Object Gateway doit utiliser l'enregistrement DNS CNAME du champ de nom d'hôte de la requête (si le nom d'hôte est différent du nom DNS d'Object Gateway). La valeur par défaut est « false ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_obj_stripe_size</term>
     <listitem>
      <para>
       Taille d'un segment d'objet pour les objets Object Gateway. La valeur par défaut est 4 &lt;&lt; 20.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_extended_http_attrs</term>
     <listitem>
      <para>
       Ajoutez un nouvel ensemble d'attributs qui peuvent être définis sur une entité (par exemple, un utilisateur, un compartiment ou un objet). Ces attributs supplémentaires peuvent être configurés via les champs d'en-tête HTTP lors de la spécification de l'entité ou de sa modification à l'aide de la méthode POST. S'ils sont définis, ces attributs sont renvoyés sous forme de champs HTTP en cas de demande GET/HEAD sur l'entité. Il s'agit par défaut de « content_foo, content_bar, x-foo-bar ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_exit_timeout_secs</term>
     <listitem>
      <para>
       Nombre de secondes à attendre un processus avant de quitter sans condition. La valeur par défaut est 120.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_window_size</term>
     <listitem>
      <para>
       Taille de la fenêtre en octets pour une seule requête d'objet. La valeur par défaut est 16 &lt;&lt; 20.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_max_req_size</term>
     <listitem>
      <para>
       Taille maximale de requête pour une seule opération GET envoyée à la grappe de stockage Ceph. La valeur par défaut est 4 &lt;&lt; 20.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_relaxed_s3_bucket_names</term>
     <listitem>
      <para>
       Active les règles souples de nom de compartiment S3 pour les compartiments de la région des États-Unis. La valeur par défaut est « false ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_list_buckets_max_chunk</term>
     <listitem>
      <para>
       Nombre maximal de compartiments à récupérer en une seule opération lors du listage des compartiments utilisateur. La valeur par défaut est 1000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_override_bucket_index_max_shards</term>
     <listitem>
      <para>
       Représente le nombre de partitions pour l'objet d'index de compartiment. Définir ce paramètre sur 0 (valeur par défaut) indique qu'il n'y a pas de partitionnement. Il est déconseillé de définir une valeur trop élevée (par exemple 1000), car cela augmente le coût du listage des compartiments. Cette variable doit être définie dans les sections de client ou globales afin qu'elle soit automatiquement appliquée aux commandes <command>radosgw-admin</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_curl_wait_timeout_ms</term>
     <listitem>
      <para>
       Timeout en millisecondes pour certains appels <command>curl</command>. La valeur par défaut est 1000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress</term>
     <listitem>
      <para>
       Active la sortie de la progression d'objet lors des longues opérations de copie. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress_every_bytes</term>
     <listitem>
      <para>
       Nombre minimal d'octets entre la sortie de progression de copie. La valeur par défaut est 1024 * 1024.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_admin_entry</term>
     <listitem>
      <para>
       Point d'entrée pour une URL de requête d'administration. La valeur par défaut est « admin ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_content_length_compat</term>
     <listitem>
      <para>
       Permet d'activer le traitement de la compatibilité des requêtes FCGI avec les options CONTENT_LENGTH et HTTP_CONTENT_LENGTH définies. La valeur par défaut est « false ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_quota_ttl</term>
     <listitem>
      <para>
       Délai en secondes pour lequel les informations de quota mises en cache sont approuvées. Une fois ce temps écoulé, les informations de quota sont à nouveau récupérées auprès de la grappe. La valeur par défaut est 600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_bucket_sync_interval</term>
     <listitem>
      <para>
       Délai en secondes pendant lequel les informations de quota de compartiment sont accumulées avant d'effectuer une synchronisation avec la grappe. Pendant ce temps, les autres instances Object Gateway ne voient pas les modifications dans les statistiques de quota de compartiment associées aux opérations sur cette instance. La valeur par défaut est 180.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_sync_interval</term>
     <listitem>
      <para>
       Délai en secondes pendant lequel les informations de quota d'utilisateur sont accumulées avant d'effectuer une synchronisation avec la grappe. Pendant ce temps, les autres instances Object Gateway ne voient pas les modifications dans les statistiques de quota d'utilisateur associées aux opérations sur cette instance. La valeur par défaut est 180.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_objects</term>
     <listitem>
      <para>
       Nombre maximal d'objets par compartiment par défaut. Ce paramètre est défini pour les nouveaux utilisateurs si aucun autre quota n'est spécifié, et n'a aucun effet sur les utilisateurs existants. Cette variable doit être définie dans les sections de client ou globales afin qu'elle soit automatiquement appliquée aux commandes <command>radosgw-admin</command>. La valeur par défaut est -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_size</term>
     <listitem>
      <para>
       Capacité maximale par défaut par compartiment (en octets). Ce paramètre est défini pour les nouveaux utilisateurs si aucun autre quota n'est spécifié, et n'a aucun effet sur les utilisateurs existants. La valeur par défaut est -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_objects</term>
     <listitem>
      <para>
       Nombre maximal d'objets par défaut pour un utilisateur. Il inclut tous les objets dans tous les compartiments appartenant à l'utilisateur. Ce paramètre est défini pour les nouveaux utilisateurs si aucun autre quota n'est spécifié, et n'a aucun effet sur les utilisateurs existants. La valeur par défaut est -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_size</term>
     <listitem>
      <para>
       Valeur du quota de taille maximale de l'utilisateur (en octets) défini pour les nouveaux utilisateurs si aucun autre quota n'est spécifié. Ce paramètre n'a aucun effet sur les utilisateurs existants. La valeur par défaut est -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_verify_ssl</term>
     <listitem>
      <para>
       Permet de vérifier les certificats SSL lors de requêtes. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_max_chunk_size</term>
     <listitem>
      <para>
       Taille maximale d'une tranche de données qui sera lue en une seule opération. L'augmentation de la valeur à 4 Mo (4194304) permet d'améliorer les performances de traitement des objets volumineux. La valeur par défaut est 128 Ko (131072).
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Paramètres multisites</title>
    <varlistentry>
     <term>rgw_zone</term>
     <listitem>
      <para>
       Nom de la zone pour l'instance de passerelle. Si aucune zone n'est définie, il est possible de configurer une valeur par défaut à l'échelle de la grappe à l'aide de la commande <command>radosgw-admin zone default</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_zonegroup</term>
     <listitem>
      <para>
       Nom du groupe de zones pour l'instance de passerelle. Si aucune zone de groupes n'est définie, il est possible de configurer une valeur par défaut à l'échelle de la grappe à l'aide de la commande <command>radosgw-admin zonegroup default</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_realm</term>
     <listitem>
      <para>
       Nom du domaine pour l'instance de passerelle. Si aucun domaine n'est défini, il est possible de configurer une valeur par défaut à l'échelle de la grappe à l'aide de la commande <command>radosgw-admin realm default</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_run_sync_thread</term>
     <listitem>
      <para>
       S'il y a d'autres zones dans le domaine à partir desquelles il faut effectuer une synchronisation, ce paramètre permet de générer des threads pour gérer la synchronisation des données et des métadonnées. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_window</term>
     <listitem>
      <para>
       Fenêtre des entrées de journal de données en secondes. La valeur par défaut est 30.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_changes_size</term>
     <listitem>
      <para>
       Nombre d'entrées dans la mémoire à conserver pour le journal des modifications de données. La valeur par défaut est 1000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_obj_prefix</term>
     <listitem>
      <para>
       Préfixe du nom d'objet pour le journal des données. Il s'agit par défaut de « data_log ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_num_shards</term>
     <listitem>
      <para>
       Nombre de partitions (objets) sur lesquelles conserver le journal des modifications de données. La valeur par défaut est 128.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_md_log_max_shards</term>
     <listitem>
      <para>
       Nombre maximal de partitions pour le journal des métadonnées. La valeur par défaut est 64.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Paramètres Swift</title>
    <varlistentry>
     <term>rgw_enforce_swift_acls</term>
     <listitem>
      <para>
       Applique les paramètres de la liste de contrôle d'accès (ACL) Swift. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_token_expiration</term>
     <listitem>
      <para>
       Délai d'expiration d'un jeton Swift en secondes. La valeur par défaut est 24 * 3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url</term>
     <listitem>
      <para>
       URL de l'API Swift de Ceph Object Gateway.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url_prefix</term>
     <listitem>
      <para>
       Préfixe de l'URL du stockage Swift qui précède la partie « /v1 ». Il permet d'exécuter plusieurs instances de passerelle sur le même hôte. Pour des raisons de compatibilité, si vous définissez cette variable de configuration sur une valeur vide, le système utilise la valeur par défaut « /swift ». Utilisez le préfixe explicite « / » pour démarrer l'URL de stockage à la racine.
      </para>
      <warning>
       <para>
        La définition de cette option sur « / » ne fonctionnera pas si l'API S3 est activée. N'oubliez pas que la désactivation de S3 rendra impossible le déploiement d'Object Gateway dans la configuration multisite !
       </para>
      </warning>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_url</term>
     <listitem>
      <para>
       URL par défaut pour vérifier les jetons d'authentification v1 lorsque l'authentification Swift interne n'est pas utilisée.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_entry</term>
     <listitem>
      <para>
       Point d'entrée d'une URL d'authentification Swift. Il s'agit par défaut de « auth ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_versioning_enabled</term>
     <listitem>
      <para>
       Active le contrôle de version des objets de l'API de stockage d'objets OpenStack. Ce paramètre permet aux clients de définir l'attribut <literal>X-Versions-Location</literal> sur les conteneurs devant être soumis au contrôle de version. L'attribut spécifie le nom du conteneur stockant les versions archivées. Son propriétaire doit être identique à celui du conteneur soumis au contrôle de version pour des raisons de vérification du contrôle d'accès ; les ACL ne sont <emphasis>pas</emphasis> prises en considération. Le contrôle de version de ces conteneurs ne peut pas être assuré par le mécanisme de contrôle de version des objets S3. La valeur par défaut est « false ».
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Paramètres de consignation</title>
    <varlistentry>
     <term>rgw_log_nonexistent_bucket</term>
     <listitem>
      <para>
       Permet à Object Gateway de consigner une requête pour un compartiment inexistant. La valeur par défaut est « false ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name</term>
     <listitem>
      <para>
       Format de consignation d'un nom d'objet. Reportez-vous à la page de manuel <command>man 1 date</command> pour plus de détails sur les spécificateurs de format. Il s'agit par défaut de « %Y-%m-%d-%H-%i-%n ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name_utc</term>
     <listitem>
      <para>
       Indique si un nom d'objet consigné inclut une heure UTC. Si ce paramètre est défini sur « false » (valeur par défaut), il utilise l'heure locale.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_shards</term>
     <listitem>
      <para>
       Nombre maximal de partitions pour la consignation de l'utilisation. La valeur par défaut est 32.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_user_shards</term>
     <listitem>
      <para>
       Nombre maximal de partitions utilisées pour la consignation de l'utilisation d'un seul utilisateur. La valeur par défaut est 1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_ops_log</term>
     <listitem>
      <para>
       Permet d'activer la consignation pour chaque opération Object Gateway réussie. La valeur par défaut est « false ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_usage_log</term>
     <listitem>
      <para>
       Permet d'activer le journal d'utilisation. La valeur par défaut est « false ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_rados</term>
     <listitem>
      <para>
       Définit si le journal des opérations doit être écrit dans l'interface dorsale de la grappe de stockage Ceph. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_socket_path</term>
     <listitem>
      <para>
       Socket du domaine Unix pour l'écriture des journaux d'opérations.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_data_backlog</term>
     <listitem>
      <para>
       Taille maximale des données du blacklog de données pour les journaux d'opérations écrits dans un socket du domaine Unix. La valeur par défaut est 5 &lt;&lt; 20.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_flush_threshold</term>
     <listitem>
      <para>
       Nombre d'entrées fusionnées altérées dans le journal d'utilisation avant le vidage synchrone. La valeur par défaut est 1024.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_tick_interval</term>
     <listitem>
      <para>
       Permet de vider les données de journal d'utilisation en attente toutes les « n » secondes. La valeur par défaut est 30.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_http_headers</term>
     <listitem>
      <para>
       Liste (séparée par des virgules) des en-têtes HTTP à inclure dans les entrées de journal. Les noms d'en-tête ne sont pas sensibles à la casse et utilisent le nom d'en-tête complet avec les mots séparés par des traits de soulignement. Par exemple : « http_x_forwarded_for », « http_x_special_k ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name</term>
     <listitem>
      <para>
       Format de consignation du nom d'objet du journal d'intentions (« intent log »). Reportez-vous à la page de manuel <command>man 1 date</command> pour plus de détails sur les spécificateurs de format. Il s'agit par défaut de « %Y-%m-%d-%i-%n ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name_utc</term>
     <listitem>
      <para>
       Indique si le nom d'objet du journal d'intentions inclut une heure UTC. Si ce paramètre est défini sur « false » (valeur par défaut), il utilise l'heure locale.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Paramètres Keystone</title>
    <varlistentry>
     <term>rgw_keystone_url</term>
     <listitem>
      <para>
       URL du serveur Keystone.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_api_version</term>
     <listitem>
      <para>
       Version (2 ou 3) de l'API Identity OpenStack qui doit être utilisée pour la communication avec le serveur Keystone. La valeur par défaut est 2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_domain</term>
     <listitem>
      <para>
       Nom du domaine OpenStack avec le privilège d'administration lors de l'utilisation de l'API Identity OpenStack v3.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_project</term>
     <listitem>
      <para>
       Nom du projet OpenStack avec le privilège d'administration lors de l'utilisation de l'API Identity OpenStack v3. Si ce paramètre n'est pas défini, le système utilise la valeur de <command>rgw keystone admin tenant</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_token</term>
     <listitem>
      <para>
       Jeton de l'administrateur Keystone (secret partagé). Dans Object Gateway, l'authentification avec le jeton d'administrateur prime sur l'authentification avec les informations d'identification de l'administrateur (options <option>rgw keystone admin user</option>, <option>rgw keystone admin password</option>, <option>rgw keystone admin tenant</option>, <option>rgw keystone admin project</option> et <option>rgw keystone admin domain</option>). La fonction de jeton d'administrateur est considérée comme obsolète.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_tenant</term>
     <listitem>
      <para>
       Nom du locataire OpenStack avec le privilège d'administration (locataire du service) en cas d'utilisation de l'API Identity OpenStack v2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_user</term>
     <listitem>
      <para>
       Nom de l'utilisateur OpenStack avec le privilège d'administration pour l'authentification Keystone (utilisateur du service) en cas d'utilisation de l'API Identity OpenStack v2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_password</term>
     <listitem>
      <para>
       Mot de passe de l'administrateur OpenStack en cas d'utilisation de l'API Identity OpenStack v2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_accepted_roles</term>
     <listitem>
      <para>
       Rôles nécessaires pour répondre aux requêtes. Il s'agit par défaut de « Member, admin ».
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_token_cache_size</term>
     <listitem>
      <para>
       Nombre maximal d'entrées dans chaque cache de jetons Keystone. La valeur par défaut est 10000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_revocation_interval</term>
     <listitem>
      <para>
       Nombre de secondes entre les vérifications de révocation de jeton. La valeur par défaut est 15 * 60.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_verify_ssl</term>
     <listitem>
      <para>
       Permet de vérifier les certificats SSL lors de requêtes de jeton auprès de Keystone. La valeur par défaut est « true ».
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <sect3 xml:id="sec-ceph-rgw-configuration-notes">
    <title>Remarques supplémentaires</title>
    <variablelist>
     <varlistentry>
      <term>rgw_dns_name</term>
      <listitem>
       <para>
        Si le paramètre <literal>rgw dns name</literal> est ajouté au fichier <filename>ceph.conf</filename>, assurez-vous que le client S3 est configuré pour adresser les demandes au noeud d'extrémité spécifié par le paramètre <literal>rgw dns name</literal>.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>

  <sect2 xml:id="config-ogw-http-frontends">
   <title>Interfaces clients HTTP</title>
   <sect3>
    <title>Beast</title>
    <variablelist>
     <varlistentry>
      <term>port, ssl_port</term>
      <listitem>
       <para>
        Numéros de port d'écoute IPv4 et IPv6. Vous pouvez spécifier plusieurs numéros de port :
       </para>
<screen>
port=80 port=8000 ssl_port=8080
</screen>
       <para>
        La valeur par défaut est 80.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>endpoint, ssl_endpoint</term>
      <listitem>
       <para>
        Adresses d'écoute au format « adresse[:port] », où l'adresse est une chaîne d'adresse IPv4 au format décimal avec points ou une adresse IPv6 en notation hexadécimale entourée de crochets. Si vous spécifiez un noeud d'extrémité IPv6, le système écoutera uniquement le protocole IPv6. Le numéro de port facultatif est défini par défaut sur 80 pour <option>endpoint</option> et sur 443 pour <option>ssl_endpoint</option>. Vous pouvez spécifier plusieurs adresses :
       </para>
<screen>
endpoint=[::1] endpoint=192.168.0.100:8000 ssl_endpoint=192.168.0.100:8080
</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>ssl_private_key</term>
      <listitem>
       <para>
        Chemin facultatif du fichier de clé privée utilisé pour les noeuds d'extrémité compatibles SSL. Si ce paramètre n'est pas spécifié, le fichier <option>ssl_certificate</option> est utilisé comme clé privée.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>tcp_nodelay</term>
      <listitem>
       <para>
        Si ce paramètre est spécifié, l'option de socket désactive l'algorithme de Nagle sur la connexion. Cela signifie que les paquets seront envoyés dès que possible au lieu d'attendre un timeout ou une saturation du tampon.
       </para>
       <para>
        « 1 » désactive l'algorithme de Nagle pour tous les sockets.
       </para>
       <para>
        « 0 » garde l'algorithme de Nagle activé (valeur par défaut).
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title>Exemple de configuration Beast dans <filename>/etc/ceph/ceph.conf</filename></title>
<screen>
rgw_frontends = beast port=8000 ssl_port=443 ssl_certificate=/etc/ssl/ssl.crt error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>CivetWeb</title>
    <variablelist>
     <varlistentry>
      <term>port</term>
      <listitem>
       <para>
        Numéro du port d'écoute. Pour les ports compatibles SSL, ajoutez un suffixe « s » (par exemple, « 443s »). Pour lier une adresse IPv4 ou IPv6 spécifique, utilisez le format « adresse:port ». Vous pouvez spécifier plusieurs noeuds d'extrémité en les joignant avec le caractère « + » ou en fournissant différentes options :
       </para>
<screen>
port=127.0.0.1:8000+443s
port=8000 port=443s
</screen>
       <para>
        La valeur par défaut est 7480.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>num_threads</term>
      <listitem>
       <para>
        Nombre de threads générés par CivetWeb pour gérer les connexions HTTP entrantes. Cela limite efficacement le nombre de connexions simultanées que l'interface client peut desservir.
       </para>
       <para>
        La valeur par défaut est celle spécifiée par l'option <option>rgw_thread_pool_size</option>.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>request_timeout_ms</term>
      <listitem>
       <para>
        Délai en millisecondes pendant lequel CivetWeb attend davantage de données entrantes avant d'abandonner.
       </para>
       <para>
        La valeur par défaut est de 30000 millisecondes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>access_log_file</term>
      <listitem>
       <para>
        Chemin du fichier journal des accès. Vous pouvez spécifier un chemin complet ou un chemin par rapport au répertoire de travail actuel. Si ce paramètre n'est pas spécifié (situation par défaut), les accès ne sont pas consignés.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>error_log_file</term>
      <listitem>
       <para>
        Chemin du fichier journal des erreurs. Vous pouvez spécifier un chemin complet ou un chemin par rapport au répertoire de travail actuel. Si ce paramètre n'est pas spécifié (situation par défaut), les erreurs ne sont pas consignées.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title>Exemple de configuration CivetWeb dans <filename>/etc/ceph/ceph.conf</filename></title>
<screen>
rgw_frontends = civetweb port=8000+443s request_timeout_ms=30000 error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>Options communes</title>
    <variablelist>
     <varlistentry>
      <term>ssl_certificate</term>
      <listitem>
       <para>
        Chemin du fichier de certificat SSL utilisé pour les noeuds d'extrémité compatibles SSL.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>prefix</term>
      <listitem>
       <para>
        Chaîne de préfixe insérée dans l'URI de toutes les requêtes. Par exemple, une interface client Swift uniquement pourrait fournir un préfixe URI « /swift ».
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
</chapter>
