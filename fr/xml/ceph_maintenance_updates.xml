<?xml version="1.0" encoding="UTF-8"?>
<appendix xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_maintenance_updates.xml" version="5.0">
 <title>Mises à jour de maintenance de Ceph basées sur les versions intermédiaires « Nautilus » en amont</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/master/xml/</dm:editurl>
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>modification</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>oui</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Plusieurs paquetages clés de SUSE Enterprise Storage 6 sont basés sur la série de versions Nautilus de Ceph. Lorsque le projet Ceph (<link xlink:href="https://github.com/ceph/ceph"/>) publie de nouvelles versions intermédiaires dans la série Nautilus, SUSE Enterprise Storage 6 est mis à jour pour garantir que le produit bénéficie des derniers rétroports de fonctionnalités et correctifs de bogues en amont.
 </para>
 <para>
  Ce chapitre contient des résumés des changements notables contenus dans chaque version intermédiaire en amont qui a été ou devrait être incluse dans le produit.
 </para>
 <bridgehead renderas="sect1">Version intermédiaire Nautilus 14.2.4</bridgehead>
 <para>
  Cette version intermédiaire corrige une régression sérieuse constatée dans la version intermédiaire 14.2.3. Cette régression n'a pas affecté les clients SUSE Enterprise Storage, car nous n'avons pas livré de version basée sur 14.2.3.
 </para>
 <bridgehead renderas="sect1">Version intermédiaire Nautilus 14.2.3</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    Cette version intermédiaire corrige une vulnérabilité par déni de service selon laquelle un client non authentifié de Ceph Object Gateway pouvait déclencher un crash à partir d'une exception non interceptée.
   </para>
  </listitem>
  <listitem>
   <para>
    Les clients librbd basés sur Nautilus peuvent désormais ouvrir des images sur les grappes Jewel.
   </para>
  </listitem>
  <listitem>
   <para>
    L'option <option>num_rados_handles</option> a été supprimée. Si vous utilisiez une valeur <option>num_rados_handles</option> supérieure à 1, multipliez vos paramètres <option>objecter_inflight_ops</option> et <option>objecter_inflight_op_bytes</option> par l'ancienne valeur <option>num_rados_handles</option> afin d'obtenir le même comportement de limitation.
   </para>
  </listitem>
  <listitem>
   <para>
    Le mode sécurisé du protocole Messenger v2 n'est plus expérimental avec cette version. Il s'agit désormais du mode de connexion préféré pour les moniteurs.
   </para>
  </listitem>
  <listitem>
   <para>
    La valeur <option>osd_deep_scrub_large_omap_object_key_threshold</option> a été abaissée afin de détecter plus facilement un objet avec un grand nombre de clé omap.
   </para>
  </listitem>
  <listitem>
   <para>
    Ceph Dashboard permet désormais de ne plus afficher les notifications Prometheus.
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Version intermédiaire Nautilus 14.2.2</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    Les commandes associées à <literal>no{up,down,in,out}</literal> ont été réorganisées. Il existe maintenant deux manières de définir les drapeaux <literal>no{up,down,in,out}</literal>, à savoir l'ancienne commande
   </para>
<screen>ceph osd [un]set <replaceable>FLAG</replaceable></screen>
   <para>
    qui établit les drapeaux à l'échelle de la grappe, et la nouvelle commande
   </para>
<screen>ceph osd [un]set-group <replaceable>FLAGS</replaceable> <replaceable>WHO</replaceable></screen>
   <para>
    qui détermine les drapeaux par lots en fonction de la granularité de n'importe quelle classe de périphériques ou n'importe quel noeud CRUSH.
   </para>
  </listitem>
  <listitem>
   <para>
    <command>radosgw-admin</command> introduit deux sous-commandes qui permettent la gestion d'objets obsolètes expirés susceptibles d'être laissés après un repartitionnement de compartiment dans les versions antérieures d'Object Gateway. Une sous-commande liste ces objets et l'autre les supprime.
   </para>
  </listitem>
  <listitem>
   <para>
    Les versions précédentes de Nautilus (14.2.1 et 14.2.0) présentent un problème dans la mesure où le déploiement d'un seul OSD BlueStore Nautilus nouveau sur une grappe mise à niveau (c'est-à-dire une grappe qui a été initialement déployée avant Nautilus) interrompt les statistiques d'utilisation de la réserve signalées par <command>ceph df</command>. Tant que tous les OSD n'ont pas été reprovisionnés ou mis à jour (via <command>ceph-bluestore-tool repair</command>), les statistiques de la réserve affichent des valeurs inférieures à la réalité. Ce problème est résolu dans la version intermédiaire 14.2.2, de sorte que la grappe ne passe à l'utilisation des statistiques par réserve plus précises qu'une fois que <emphasis>tous</emphasis> les OSD disposent d'une version 14.2.2 ou ultérieure, font partie du stockage de bloc et ont été mis à jour via la fonction de réparation s'ils ont été créés avant Nautilus.
   </para>
  </listitem>
  <listitem>
   <para>
    La valeur par défaut pour <option>mon_crush_min_required_version</option> est passée de <literal>firefly</literal> à <literal>hammer</literal>, ce qui signifie que la grappe émettra un avertissement concernant l'état de santé si vos variables CRUSH sont plus anciennes que Hammer. Généralement, une petite quantité de données (mais non nulle) est rééquilibrée en basculant vers les variables Hammer.
   </para>
   <para>
    Si possible, nous vous recommandons de définir le client le plus ancien autorisé sur <literal>hammer</literal>, voire un client ultérieur. Pour vérifier quel est le client le plus ancien autorisé actuellement, exécutez la commande suivante :
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph osd dump | grep min_compat_client</screen>
   <para>
    Si la valeur actuelle est antérieure à <literal>hammer</literal>, exécutez la commande suivante pour déterminer s'il est prudent d'effectuer ce changement en contrôlant si aucun client antérieur à Hammer n'est actuellement connecté à la grappe :
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph features</screen>
   <para>
    Le type de compartiment CRUSH plus récent <literal>straw2</literal> a été introduit dans Hammer. Si vous constatez que tous les clients sont Hammer, voire plus récents, cela vous permet d'utiliser de nouvelles fonctionnalités uniquement prises en charge pour les compartiments <literal>straw2</literal>, y compris le mode <literal>crush-compat</literal> pour l'équilibreur (<xref linkend="mgr-modules-balancer"/>).
   </para>
  </listitem>
 </itemizedlist>
 <para>
  Pour des informations détaillées sur le correctif, reportez-vous à la page <link xlink:href="https://download.suse.com/Download?buildid=D38A7mekBz4~"/>.
 </para>
 <bridgehead renderas="sect1">Version intermédiaire Nautilus 14.2.1</bridgehead>
 <para>
  Il s'agit de la première version intermédiaire après la version d'origine de Nautilus (14.2.0). La version d'origine (en disponibilité générale, autrement dit « General Availability », GA) de SUSE Enterprise Storage 6 était basée sur cette version intermédiaire.
 </para>
</appendix>
