<?xml version="1.0" encoding="UTF-8"?>
<appendix xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_maintenance_updates.xml" version="5.0">
 <title>Actualizaciones de mantenimiento de Ceph basadas en versiones secundarias superiores de Nautilus</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/master/xml/</dm:editurl>
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>editar</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>sí</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Varios paquetes clave de SUSE Enterprise Storage 6 se basan en las distintas versiones de Nautilus de Ceph. Cuando el proyecto Ceph (<link xlink:href="https://github.com/ceph/ceph"/>) publica nuevas versiones secundarias de la serie Nautilus, SUSE Enterprise Storage 6 se actualiza para garantizar que el producto se beneficia de las últimas correcciones de errores y actualizaciones retroactivas de características de esas versiones.
 </para>
 <para>
  Este capítulo contiene un resumen de los principales cambios incluidos en cada versión secundaria posterior que se ha incluido en el producto, o que se tiene previsto incluir.
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.4</bridgehead>
 <para>
  En esta versión se corrige una regresión grave que se publicó por error en la versión 14.2.3. Esta regresión no afecta a los clientes de SUSE Enterprise Storage, ya que no enviamos una versión basada en 14.2.3.
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.3</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    Se ha corregido una vulnerabilidad de denegación de servicio en la que un cliente no autenticado de Ceph Object Gateway podía desencadenar una detención por fallo a partir de una excepción no detectada.
   </para>
  </listitem>
  <listitem>
   <para>
    Los clientes de librbd basados en Nautilus ahora pueden abrir imágenes en clústeres de Jewel.
   </para>
  </listitem>
  <listitem>
   <para>
    Se ha eliminado <option>num_rados_handles</option> de Object Gateway. Si en <option>num_rados_handles</option> utilizaba un valor mayor que 1, multiplique los parámetros actuales de <option>objecter_inflight_ops</option> y <option>objecter_inflight_op_bytes</option> por el valor antiguo de <option>num_rados_handles</option> para obtener el mismo comportamiento de transmisión.
   </para>
  </listitem>
  <listitem>
   <para>
    El modo seguro del protocolo Messenger v2 ya no está en fase experimental en esta versión. Ahora es el modo de conexión preferido para los monitores.
   </para>
  </listitem>
  <listitem>
   <para>
    El valor de <option>osd_deep_scrub_large_omap_object_key_threshold</option> se ha reducido para que detecte un objeto con un gran número de claves omap más fácilmente.
   </para>
  </listitem>
  <listitem>
   <para>
    Ceph Dashboard ahora admite que se silencien las notificaciones de Prometheus.
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Nautilus 14.2.2</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    Los comandos relacionados con <literal>no{up,down,in,out}</literal> se han renovado. Ahora hay dos formas de definir los indicadores <literal>no{up,down,in,out}</literal>: el comando antiguo
   </para>
<screen>ceph osd [un]set <replaceable>FLAG</replaceable></screen>
   <para>
    que establece indicadores para todo el clúster, y el comando nuevo
   </para>
<screen>ceph osd [un]set-group <replaceable>FLAGS</replaceable> <replaceable>WHO</replaceable></screen>
   <para>
    que establece indicadores en lote al nivel de detalle de cualquier nodo de CRUSH o de clase de dispositivo.
   </para>
  </listitem>
  <listitem>
   <para>
    En <command>radosgw-admin</command> se incluyen dos subcomandos que permiten la gestión de objetos caducados que, en versiones anteriores de Object Gateway, podían quedarse olvidados después de volver a fragmentar un depósito. Un subcomando muestra estos objetos y el otro los suprime.
   </para>
  </listitem>
  <listitem>
   <para>
    Las versiones anteriores de Nautilus (14.2.1 y 14.2.0) tienen un problema por el que al distribuir un nuevo OSD de Nautilus BlueStore en un clúster actualizado (es decir, en un clúster distribuido originalmente antes que Nautilus), las estadísticas de utilización del repositorio que emite <command>ceph df</command> son incorrectas. Hasta que todos los OSD se hayan reaprovisionado o actualizado (mediante <command>ceph-bluestore-tool repair</command>), las estadísticas del repositorio mostrarán valores inferiores al verdadero. Este problema se resolvió en la versión 14.2.2, de modo que el clúster solo empieza a usar las estadísticas más precisas por repositorio después de que <emphasis>todos</emphasis> los OSD sean de la versión 14.2.2 o posterior, sean almacenamiento en bloque y se hayan actualizado mediante la función de reparación si se crearon antes que Nautilus.
   </para>
  </listitem>
  <listitem>
   <para>
    El valor por defecto para <option>mon_crush_min_required_version</option> ha cambiado de <literal>firefly</literal> a <literal>hammer</literal>, lo que significa que el clúster emitirá una advertencia de estado si los CRUSH optimizables son anteriores a Hammer. Al cambiar a elementos optimizables de Hammer, generalmente hay una pequeña cantidad de datos (siempre hay alguno) que se moverá.
   </para>
   <para>
    Si es posible, se recomienda definir el cliente permitido más antiguo a <literal>hammer</literal> o una versión posterior. Para mostrar cuál es el cliente más antiguo permitido actual, ejecute:
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph osd dump | grep min_compat_client</screen>
   <para>
    Si el valor actual es anterior a <literal>hammer</literal>, ejecute el comando siguiente para determinar si es seguro realizar este cambio verificando que no hay clientes anteriores a Hammer conectados actualmente al clúster:
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph features</screen>
   <para>
    El tipo de depósito CRUSH más reciente, <literal>straw2</literal>, se incluyó en Hammer. Si verifica que todos los clientes son Hammer o de una versión posterior, solo permite que se usen las funciones nuevas compatibles para las papeleas <literal>straw2</literal>, incluido el modo <literal>crush-compat</literal> para el equilibrador (<xref linkend="mgr-modules-balancer"/>).
   </para>
  </listitem>
 </itemizedlist>
 <para>
  Encontrará más información sobre el parche en <link xlink:href="https://download.suse.com/Download?buildid=D38A7mekBz4~"/>.
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.1</bridgehead>
 <para>
  Esta fue la primera versión secundaria después de la publicación original de Nautilus (14.2.0). La versión original ("Disponibilidad general" o "GA") de SUSE Enterprise Storage 6 se basaba en esta versión secundaria.
 </para>
</appendix>
