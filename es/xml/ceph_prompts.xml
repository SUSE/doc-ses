<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_prompts.xml" version="5.0">
 <title>Privilegios de usuario y comandos de símbolos del sistema</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>editar</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>sí</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Como administrador de clústeres de Ceph, va a configurar y ajustar el comportamiento del clúster ejecutando comandos específicos. Necesitará varios tipos de comandos:
 </para>
 <sect1>
  <title>Comandos relativos a Salt/DeepSea</title>

  <para>
   Estos comandos ayudan a distribuir o actualizar el clúster de Ceph, a ejecutar comandos en varios nodos de clúster al mismo tiempo (o en todos ellos) o a ayudarle a añadir o quitar nodos de clúster. Los más utilizados son <command>salt</command>, <command>salt-run</command> y <command>deepsea</command>. Los comandos de Salt se deben ejecutar en el nodo master de Salt (consulte <xref linkend="deepsea-description"/> para obtener más detalles) como usuario <systemitem class="username">root</systemitem>. Estos comandos se introducen con el siguiente símbolo del sistema:
  </para>

<screen>
<prompt>root@master # </prompt>
</screen>

  <para>
   Por ejemplo:
  </para>

<screen>
<prompt>root@master # </prompt>salt '*.example.net' test.ping
</screen>
 </sect1>
 <sect1>
  <title>Comandos relativos a Ceph</title>

  <para>
   Se trata de comandos de nivel inferior para configurar y ajustar todos los aspectos del clúster y sus pasarelas en la línea de comandos. Algunos de ellos son <command>ceph</command>, <command>rbd</command>, <command>radosgw-admin</command> o <command>crushtool</command>.
  </para>

  <para>
   Para ejecutar comandos relativos a Ceph, debe tener acceso de lectura a una clave de Ceph. Los privilegios que tiene en el entorno Ceph se definen en las capacidades de la clave. Una opción es ejecutar comandos de Ceph como usuario <systemitem class="username">root</systemitem> (o mediante <command>sudo</command>) y utilizar el anillo de claves sin restricciones por defecto "ceph.client.admin.key".
  </para>

  <para>
   La opción más segura y recomendada es crear una clave individual más restrictiva para cada usuario administrador y colocarla en un directorio donde los usuarios puedan leerla, por ejemplo:
  </para>

<screen>~/.ceph/ceph.client.<replaceable>USERNAME</replaceable>.keyring</screen>

  <tip>
   <title>vía a claves de Ceph</title>
   <para>
    Para utilizar un usuario administrador y un anillo de claves personalizados, debe especificar el nombre de usuario y la vía a la clave cada vez que ejecute el comando <command>ceph</command> mediante las opciones <option>-n client.<replaceable>NOMBRE_USUARIO</replaceable></option> y <option>‑‑keyring <replaceable>VÍA/A/ANILLO/DE/CLAVES</replaceable></option>.
   </para>
   <para>
    Para evitarlo, incluya estas opciones en la variable <varname>CEPH_ARGS</varname> en los archivos <filename>~/.bashrc</filename> de los usuarios individuales.
   </para>
  </tip>

  <para>
   Aunque puede ejecutar comandos relativos a Ceph en cualquier nodo de clúster, se recomienda hacerlo en el nodo de administración. Esta documentación utiliza al usuario <systemitem class="username">cephadm</systemitem> para ejecutar los comandos, por lo tanto, se introducen con el siguiente símbolo del sistema:
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>
</screen>

  <para>
   Por ejemplo:
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>ceph auth list
</screen>

  <tip>
   <title>comandos para nodos específicos</title>
   <para>
    Si la documentación indica que ejecute un comando en un nodo de clúster con una función específica, el símbolo del sistema se encargará. Por ejemplo:
   </para>
<screen>
<prompt>cephadm@mon &gt; </prompt>
</screen>
  </tip>
 </sect1>
 <sect1>
  <title>Comandos generales de Linux</title>

  <para>
   Los comandos de Linux no relacionados con Ceph o DeepSea, como <command>mount</command>, <command>cat</command> o <command>openssl</command> se introducen con los símbolos del sistema <prompt>cephadm@adm &gt; </prompt> o <prompt>root # </prompt>, dependiendo de los privilegios que requiera el comando relacionado.
  </para>
 </sect1>
 <sect1>
  <title>Información adicional</title>

  <para>
   Para obtener más información sobre la gestión de claves de Ceph, consulte la <xref linkend="storage-cephx-keymgmt"/>.
  </para>
 </sect1>
</chapter>
