<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_prompts.xml" version="5.0">
 <title>Privilegi utente e prompt dei comandi</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>modifica</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>sì</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Gli amministratori del cluster Ceph si occupano della configurazione e della modifica del comportamento del cluster tramite l'esecuzione di comandi specifici. Saranno necessari diversi tipi di comandi:
 </para>
 <sect1>
  <title>Comandi correlati a Salt/DeepSea</title>

  <para>
   Questi comandi consentono di distribuire o sottoporre ad upgrade il cluster Ceph, di eseguire comandi in contemporanea su più (o su tutti i) nodi del cluster e semplificano l'aggiunta o la rimozione dei nodi del cluster. I comandi più utilizzati sono <command>salt</command>, <command>salt-run</command> e <command>deepsea</command>. È necessario eseguire i comandi Salt sul nodo del Salt master (consultare questo riferimento: <xref linkend="deepsea-description"/> per i dettagli) come <systemitem class="username">root</systemitem>. Questi comandi sono introdotti dal prompt seguente:
  </para>

<screen>
<prompt>root@master # </prompt>
</screen>

  <para>
   Ad esempio:
  </para>

<screen>
<prompt>root@master # </prompt>salt '*.example.net' test.ping
</screen>
 </sect1>
 <sect1>
  <title>Comandi correlati a Ceph</title>

  <para>
   Di seguito sono riportati i comandi di livello inferiore utilizzati per configurare e ottimizzare tutti gli aspetti del cluster e i relativi gateway sulla riga di comando. Alcuni di questi sono <command>ceph</command>, <command>rbd</command>, <command>radosgw-admin</command> o <command>crushtool</command>.
  </para>

  <para>
   Per eseguire i comandi correlati a Ceph, è necessario disporre dell'accesso in lettura a una chiave Ceph. Le capacità della chiave definiscono i privilegi dell'utente all'interno dell'ambiente Ceph. Un'opzione consiste nell'eseguire i comandi di Ceph come <systemitem class="username">root</systemitem> (o tramite <command>sudo</command>) e utilizzare il portachiavi di default senza restrizioni "ceph.client.admin.key".
  </para>

  <para>
   L'opzione consigliata e più sicura consiste nel creare una chiave individuale più restrittiva per ogni utente amministratore e inserirla in una directory in cui gli utenti possano leggerla, ad esempio:
  </para>

<screen>~/.ceph/ceph.client.<replaceable>USERNAME</replaceable>.keyring</screen>

  <tip>
   <title>percorso delle chiavi Ceph</title>
   <para>
    Per utilizzare un utente amministratore e un portachiavi personalizzati, è necessario specificare il nome utente e il percorso della chiave ogni volta che si esegue il comando <command>ceph</command> tramite le opzioni <option>-n client.<replaceable>USER_NAME</replaceable></option> e <option>--keyring <replaceable>PATH/TO/KEYRING</replaceable></option>.
   </para>
   <para>
    Per evitare questa procedura, includere queste opzioni nella variabile <varname>CEPH_ARGS</varname>
    nei file <filename>~/.bashrc</filename> dei singoli utenti.
   </para>
  </tip>

  <para>
   I comandi correlati a Ceph possono essere eseguiti su qualsiasi nodo del cluster, ma è consigliabile eseguirli sul nodo admin. In questa documentazione, l'utente <systemitem class="username">cephadm</systemitem> esegue i comandi, pertanto questi vengono introdotti dal prompt seguente:
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>
</screen>

  <para>
   Ad esempio:
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>ceph auth list
</screen>

  <tip>
   <title>comandi per nodi specifici</title>
   <para>
    Se nella documentazione è indicato di eseguire un comando su un nodo del cluster con un ruolo specifico, questo verrà indirizzato dal prompt. Ad esempio:
   </para>
<screen>
<prompt>cephadm@mon &gt; </prompt>
</screen>
  </tip>
 </sect1>
 <sect1>
  <title>Comandi Linux generali</title>

  <para>
   I comandi Linux non correlati a Ceph o DeepSea, come <command>mount</command>, <command>cat</command> o <command>openssl</command>, sono introdotti dai prompt <prompt>cephadm@adm &gt; </prompt>
   oppure <prompt>root # </prompt> a seconda dei privilegi richiesti dal comando correlato.
  </para>
 </sect1>
 <sect1>
  <title>Informazioni aggiuntive</title>

  <para>
   Per ulteriori informazioni sulla gestione della chiave Ceph, fare riferimento alla <xref linkend="storage-cephx-keymgmt"/>.
  </para>
 </sect1>
</chapter>
