<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_hwrecommend.xml" version="5.0" xml:id="storage-bp-hwreq">
 <title>ハードウェア要件と推奨事項</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Cephのハードウェア要件は、IOワークロードに大きく依存します。次のハードウェア要件と推奨事項は、詳細な計画を立てる際の起点と考えてください。
 </para>
 <para>
  一般的に、このセクションで説明する推奨事項はプロセスごとの推奨事項です。同じマシンに複数のプロセスがある場合は、CPU、RAM、ディスク、およびネットワークの各要件を追加する必要があります。
 </para>
 <sect1 xml:id="network-overview">
  <title>ネットワーク概要</title>

  <para>
   Cephには次のような論理ネットワークが含まれます。
  </para>

  <itemizedlist>
   <listitem>
    <para>
     <literal>パブリックネットワーク</literal>と呼ばれるフロントエンドのネットワーク
    </para>
   </listitem>
   <listitem>
    <para>
     <literal>クラスタネットワーク</literal>と呼ばれる、バックエンドの信頼済み内部ネットワークこれは必要な場合のみ指定してください。
    </para>
   </listitem>
   <listitem>
    <para>
     1つ以上のゲートウェイ用クライアントネットワーク。これは必要な場合のみ指定してください。また、この章では扱いません。
    </para>
   </listitem>
  </itemizedlist>

  <para>
   パブリックネットワークはCephデーモンが他のCephデーモンやクライアントと通信するネットワークです。つまり、クラスタネットワークが構成されている場合を除き、すべてのCephクラスタのトラフィックはこのパブリックネットワークを通ります。
  </para>

  <para>
   クラスタネットワークはOSDノード間のバックエンドネットワークであり、レプリケーション、再バランシング、リカバリに使用されます。このオプションのネットワークを構成した場合、理論上、デフォルトの3方向レプリケーションを使用するパブリックネットワークの2倍の帯域幅が生まれます。これは、プライマリOSDが2つのコピーを他のOSDに送る際に、このネットワークを使用するためです。一方、パブリックネットワークはクライアントとゲートウェイ間のネットワークであり、Monitor、マネージャ、MDSノード、OSDノードとの通信に使用されます。パブリックネットワークはMonitor、マネージャ、MDSノードがOSDノードと通信する際にも使用されます。
  </para>

  <figure xml:id="network-overview-figure">
   <title>ネットワーク概要</title>
   <mediaobject>
    <imageobject role="html">
     <imagedata fileref="network-overview-diagram.png" width="70%"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="ceph-install-ceph-deploy-network">
   <title>ネットワーク推奨事項</title>
   <para>
    十分に要件を満たせるような帯域幅を備えた、フォールトトレラントな単一のネットワークをお勧めします。Cephパブリックネットワーク環境では、802.3ad (LACP)を使用してボンディングされた2つの25GbE (またはそれ以上)のネットワークインターフェイスをお勧めします。この環境がCephの最小セットアップとみなされます。クラスタネットワークを使用する場合、25GbEのネットワークインターフェイスを4つボンディングすることをお勧めします。2つ以上のネットワークインターフェイスをボンディングすることで、リンクアグリゲーションによりスループットが改善されます。さらに、リンクとスイッチに冗長性が与えられるため、耐障害性と保守性が向上します。
   </para>
   <para>
    VLANを作成することで、ボンディングした機器を通過する異なるタイプのトラフィックを分離することもできます。たとえば、1つはパブリックネットワーク用、もう1つはクラスタネットワーク用として、計2つのVLANインターフェイスを提供するようにボンディングを設定できます。しかしながら、これはCephネットワークを構成する際の必須事項ではありません<emphasis/>。ネットワークインターフェイスのボンディングの詳細については、<link xlink:href="https://documentation.suse.com/sles/15-SP2/html/SLES-all/cha-network.html#sec-network-iface-bonding"/>を参照してください。
   </para>
   <para>
    耐障害性はコンポーネントを障害ドメインに隔離することで強化できます。ネットワークの耐障害性を改善する目的で、別々のネットワークインターフェイスカード(NIC)2枚を1つのインターフェイスにボンディングすると、単一のNICの障害に対する保護が提供されます。同様に、2つのスイッチをボンディングすると、単一のスイッチの障害に対する保護が提供されます。必要なレベルの耐障害性を構築するために、ネットワーク機器のベンダーに相談することをお勧めします。
   </para>
   <important>
    <title>管理ネットワークはサポート対象外</title>
    <para>
     管理ネットワークのセットアップ(たとえば、分離されたSSH、Salt、またはDNSのネットワーク形成を可能とするもの)の追加はテストされておらず、サポート対象外です。
    </para>
   </important>
   <tip>
    <title>DHCP経由で設定されたノード</title>
    <para>
     ストレージノードがDHCP経由で設定されている場合、さまざまCephデーモンが起動する前にネットワークを正しく設定するのにデフォルトのタイムアウトでは十分でないことがあります。この場合、CephのMONとOSDを正常に起動できません(<command>systemctl status ceph\*</command>を実行すると「unable to bind」エラーになります)。この問題を回避するには、ストレージクラスタの各ノードでDHCPクライアントのタイムアウト時間を少なくとも30秒まで延ばすことをお勧めします。このためには、各ノードで以下の設定を変更します。
    </para>
    <para>
     <filename>/etc/sysconfig/network/dhcp</filename>で、以下を設定します。
    </para>
<screen>DHCLIENT_WAIT_AT_BOOT="30"</screen>
    <para>
     <filename>/etc/sysconfig/network/config</filename>で、以下を設定します。
    </para>
<screen>WAIT_FOR_INTERFACES="60"</screen>
   </tip>
   <sect3 xml:id="storage-bp-net-private">
    <title>実行中のクラスタにプライベートネットワークを追加</title>
    <para>
     Cephの展開中にクラスタネットワークを指定しない場合、単一のパブリックネットワーク環境と想定されます。Cephはパブリックネットワークで問題なく動作しますが、2つ目のプライベートクラスタネットワークを設定すると、パフォーマンスとセキュリティが向上します。2つのネットワークをサポートするには、各Cephノードに少なくとも2つのネットワークカードが必要です。
    </para>
    <para>
     各Cephノードに以下の変更を適用する必要があります。これらの変更は、小規模なクラスタの場合は比較的短時間で済みますが、数百または数千のノードで構成されるクラスタの場合は非常に時間がかかる可能性があります。
    </para>
    <procedure>
     <step>
      <para>
       次のコマンドを使用して、クラスタネットワークを設定します。
      </para>
<screen><prompt role="root">root # </prompt>ceph config set global cluster_network <replaceable>MY_NETWORK</replaceable></screen>
      <para>
       OSDを再起動し、指定したクラスタネットワークにバインドします。
      </para>
<screen><prompt role="root">root # </prompt>systemctl restart ceph-*@osd.*.service</screen>
     </step>
     <step>
      <para>
       プライベートクラスタネットワークがOSレベルで想定どおりに動作していることを確認します。
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="storage-bp-net-subnets">
    <title>異なるサブネット上のモニタノード</title>
    <para>
     モニタノードが複数のサブネット上に存在する場合(たとえば、別の部屋に配置されていたり、別のスイッチによってサービスを提供されていたりする場合)、CIDR表記でパブリックネットワークアドレスを指定する必要があります。
    </para>
<screen><prompt>cephuser@adm &gt; </prompt>ceph config set mon public_network "<replaceable>MON_NETWORK_1</replaceable>, <replaceable>MON_NETWORK_2</replaceable>, <replaceable>MON_NETWORK_N</replaceable></screen>
    <para>
     以下に例を示します。
    </para>
<screen><prompt>cephuser@adm &gt; </prompt>ceph config set mon public_network "192.168.1.0/24, 10.10.0.0/16"</screen>
    <warning>
     <para>
      このセクションで説明するように、パブリックネットワーク(またはクラスタネットワーク)用に複数のネットワークセグメントを指定する場合、これらのサブネットはいずれも他のすべてのサブネットにルーティングできる必要があります。さもなければ、異なるネットワークセグメント上に存在するMONなどのCephデーモンが通信できず、クラスタが分割されてしまいます。また、ファイアウォールを使用している場合、必要に応じて、iptablesに各IPアドレスやサブネットを含め、すべてのノードでこれらのアドレスに対してポートを開放したかを確認してください。
     </para>
    </warning>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="multi-architecture">
  <title>複数のアーキテクチャの設定</title>

  <para>
   SUSE Enterprise Storageでは、x86とArmの両方のアーキテクチャをサポートしています。各アーキテクチャを検討する際は、OSDあたりのコア数、周波数、およびRAMの観点から見ると、サイジングに関して、CPUアーキテクチャ間に実質的な差異はないことに注意することが重要です。
  </para>

  <para>
   小型のx86プロセッサ(サーバ以外)と同様に、パフォーマンスの低いArmベースのコアは、特にイレージャコーディングプールに使用する場合は最適なエクスペリエンスを提供できない可能性があります。
  </para>

  <note>
   <para>
    このドキュメントでは、x86やArmと書く代わりに<replaceable>SYSTEM-ARCH</replaceable>と表記します。
   </para>
  </note>
 </sect1>
 <sect1 xml:id="ses-hardware-config">
  <title>ハードウェア設定</title>

  <para>
   最高のプロダクトエクスペリエンスのために、推奨されるクラスタ構成から始めることをお勧めします。テスト用クラスタや、それほどパフォーマンスが要求されないクラスタのために、サポートされる最小限のクラスタ設定を記載しています。
  </para>

  <sect2 xml:id="ses-bp-minimum-cluster">
   <title>最小クラスタ構成</title>
   <para>
    最小限の運用クラスタは、次のような構成です。
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      サービスを共同配置した、最低でも4つの物理ノード(OSDノード)
     </para>
    </listitem>
    <listitem>
     <para>
      ボンディングされたネットワークを構成する、デュアルポート10Gb Ethernet
     </para>
    </listitem>
    <listitem>
     <para>
      分離された管理ノード(外部ノードに仮想化してもよい)
     </para>
    </listitem>
   </itemizedlist>
   <para>
    詳細な構成は以下の通りです。
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      4GBのRAM、4コア、1TBのストレージ容量を備えた別個の管理ノード。これは通常、Salt Masterノードです。Ceph Monitor、メタデータサーバ、Ceph OSD、Object Gateway、NFS GaneshaなどのCephサービスとゲートウェイは管理ノードではサポートされません。これは、管理ノードがクラスタの更新をオーケストレートし、個別にプロセスをアップグレードする必要があるためです。
     </para>
    </listitem>
    <listitem>
     <para>
      それぞれ8つのOSDディスクを備えた、最低でも4つの物理OSDノード。要件は<xref linkend="sysreq-osd"/>を参照してください。
     </para>
     <para>
      クラスタの合計容量は、1つのノードが使用不能になることを想定したサイズとする必要があります。また、使用済み容量(冗長分を含む)の合計が80%を超えないようにする必要があります。
     </para>
    </listitem>
    <listitem>
     <para>
      3つのCeph MonitorインスタンスMonitorはレイテンシの問題からHDDではなくSSD/NVMeストレージから実行する必要があります。
     </para>
    </listitem>
    <listitem>
     <para>
      Monitor、メタデータサーバ、ゲートウェイは同じOSDノードに配置できます。Monitorの共同配置については、<xref linkend="ses-bp-diskshare"/>を参照してください。サービスを共同配置する場合、メモリとCPUの要件を積み増す必要があります。
     </para>
    </listitem>
    <listitem>
     <para>
      iSCSI Gateway、Object Gateway、メタデータサーバは最低でも4GBのRAMと4コアの追加が必要です。
     </para>
    </listitem>
    <listitem>
     <para>
      CephFS、S3/Swift、iSCSIを使用する場合、冗長性と可用性を確保するため、それに応じた役割のインスタンス(メタデータサーバ、Object Gateway、iSCSI)が最低でも2つ必要です。
     </para>
    </listitem>
    <listitem>
     <para>
      ノードはSUSE Enterprise Storage専用とし、他のいかなる物理的ワークロード、コンテナ化ワークロード、仮想化ワークロードにも使用しないでください。
     </para>
    </listitem>
    <listitem>
     <para>
      VM上になんらかのゲートウェイ(iSCSI、Object Gateway、NFS Ganesha、メタデータサーバなど)が展開される場合、こうしたVMをクラスタの他の役割を担う物理マシンにホストしないでください(ゲートウェイは共同配置サービスとしてサポートされているため、これは不要です)。
     </para>
    </listitem>
    <listitem>
     <para>
      コアとなる物理クラスタの外のハイパーバイザでサービスをVMとして展開する場合、障害ドメインは冗長性の確保を考慮する必要があります。
     </para>
     <para>
      たとえば、同じハイパーバイザに同じタイプの複数の役割(複数のMONやMDSインスタンスなど)を展開しないでください。
     </para>
    </listitem>
    <listitem>
     <para>
      VM上に展開する場合、優れたネットワーク接続性と上手く動作する時刻同期機能をノードに持たせることがきわめて重要です。
     </para>
    </listitem>
    <listitem>
     <para>
      ハイパーバイザノードは、他のワークロードがCPU、RAM、ネットワーク、ストレージなどのリソースを消費することによる干渉を避けるため、適切なサイズにする必要があります。
     </para>
    </listitem>
   </itemizedlist>
   <figure>
    <title>最小クラスタ構成</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="minimal-ses.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="minimal-ses.png" width="100%"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="ses-bp-production-cluster">
   <title>運用クラスタの推奨設定</title>
   <para>
    クラスタを拡張した場合、耐障害性を高めるため、Ceph Monitor、メタデータサーバ、ゲートウェイを別々のノードに再配置することをお勧めします。
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      7つのオブジェクトストレージノード
     </para>
     <itemizedlist>
      <listitem>
       <para>
        1つのノードが最大で合計ストレージの15%を超えないこと。
       </para>
      </listitem>
      <listitem>
       <para>
        クラスタの合計容量は、1つのノードが使用不能になることを想定したサイズとする必要があります。また、使用済み容量(冗長分を含む)の合計が80%を超えないようにする必要があります。
       </para>
      </listitem>
      <listitem>
       <para>
        内部クラスタと外部パブリックネットワークをそれぞれボンディングする、25Gb Ethernet(またはそれ以上)。
       </para>
      </listitem>
      <listitem>
       <para>
        Storage Clusterあたり56以上のOSD
       </para>
      </listitem>
      <listitem>
       <para>
        推奨設定の詳細については<xref linkend="sysreq-osd"/>を参照してください。
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
    <listitem>
     <para>
      専用の物理インフラストラクチャノード
     </para>
     <itemizedlist>
      <listitem>
       <para>
        3つのCeph Monitorノード: 4GBのRAM、4コアプロセッサ、ディスク用のRAID 1 SSD。
       </para>
       <para>
        推奨設定の詳細については<xref linkend="sysreq-mon"/>を参照してください。
       </para>
      </listitem>
      <listitem>
       <para>
        Object Gatewayノード: 32GBのRAM、8コアプロセッサ、ディスク用のRAID 1 SSD。
       </para>
       <para>
        推奨設定の詳細については<xref linkend="sysreq-rgw"/>を参照してください。
       </para>
      </listitem>
      <listitem>
       <para>
        iSCSI Gatewayノード: 16GBのRAM、8コアプロセッサ、ディスク用のRAID 1 SSD。
       </para>
       <para>
        推奨設定の詳細については<xref linkend="sysreq-iscsi"/>を参照してください。
       </para>
      </listitem>
      <listitem>
       <para>
        メタデータサーバノード(アクティブ x 1/ホットスタンバイ x 1): 32GBのRAM、8コアプロセッサ、ディスク用のRAID 1 SSD。
       </para>
       <para>
        推奨設定の詳細については<xref linkend="sysreq-mds"/>を参照してください。
       </para>
      </listitem>
      <listitem>
       <para>
        1つのSES管理ノード: 4GBのRAM、4コアプロセッサ、ディスク用のRAID1 SSD。
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="deployment-hw-multipath">
   <title>マルチパス設定</title>
   <para>
    マルチパスハードウェアを使用したい場合、設定ファイルの<literal>devices</literal>セクションでLVMが<literal>multipath_component_detection = 1</literal>を認識するようにしてください。この設定は、<command>lvm config</command>コマンドで確認できます。
   </para>
   <para>
    もしくは、LVMのフィルタ設定により、LVMがデバイスのmpathコンポーネントをフィルタするようにしてください。これはホスト固有です。
   </para>
   <note>
    <para>
     この方法はお勧めしません。<literal>multipath_component_detection = 1</literal>を設定できない場合にのみ検討する必要があります。
    </para>
   </note>
   <para>
    マルチパス設定の詳細については、<link xlink:href="https://documentation.suse.com/sles/15-SP2/html/SLES-all/cha-multipath.html#sec-multipath-lvm"/>を参照してください。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="deployment-osd-recommendation">
  <title>オブジェクトストレージノード</title>

  <sect2 xml:id="sysreq-osd">
   <title>Minimum requirements</title>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      次のCPUの推奨事項は、Cephによる使用とは関係なくデバイスを考慮しています。
     </para>
     <itemizedlist>
      <listitem>
       <para>
        スピナあたり1つの2GHz CPUスレッド
       </para>
      </listitem>
      <listitem>
       <para>
        SSDあたり2つの2GHz CPUスレッド
       </para>
      </listitem>
      <listitem>
       <para>
        MVMeあたり4つの2GHz CPUスレッド
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
    <listitem>
     <para>
      独立した10GbEネットワーク(パブリック/クライアントおよび内部)。4つの10GbEが必須、2つの25GbEを推奨。
     </para>
    </listitem>
    <listitem>
     <para>
      必要なRAMの合計 = OSDの数 x (1GB + <option>osd_memory_target</option>) + 16GB
     </para>
     <para>
      <option>osd_memory_target</option>の詳細については、<xref linkend="config-auto-cache-sizing"/>を参照してください。
     </para>
    </listitem>
    <listitem>
     <para>
      JBOD設定または個々のRAID-0設定のOSDディスク。
     </para>
    </listitem>
    <listitem>
     <para>
      OSDジャーナルはOSDディスクに配置可能。
     </para>
    </listitem>
    <listitem>
     <para>
      OSDディスクはSUSE Enterprise Storage専用である必要があります。
     </para>
    </listitem>
    <listitem>
     <para>
      オペレーティングシステム専用のディスクおよびSSD(できればRAID 1設定)。
     </para>
    </listitem>
    <listitem>
     <para>
      このOSDホストがキャッシュ階層化用のキャッシュプールの一部をホストする場合、最低でも4GBのRAMを追加で割り当て。
     </para>
    </listitem>
    <listitem>
     <para>
      Ceph Monitor、ゲートウェイ、およびメタデータサーバはオブジェクトストレージノードに配置可能。
     </para>
    </listitem>
    <listitem>
     <para>
      ディスク性能の理由から、OSDノードはベアメタルノードです。Ceph MonitorとCeph Managerの最小セットアップを除き、OSDノードで他のワークロードを実行しないでください。
     </para>
    </listitem>
    <listitem>
     <para>
      ジャーナル用のSSD(SSDジャーナルとOSDの比率は6:1)。
     </para>
    </listitem>
   </itemizedlist>
     <note>
       <para>
         OSDノードにiSCSIやRADOS Block Deviceなどのネットワークブロックデバイスがマッピングされていないことを確認してください。
       </para>
     </note>
  </sect2>

  <sect2 xml:id="ses-bp-mindisk">
   <title>最小ディスクサイズ</title>
   <para>
    OSD上で実行する必要があるディスク領域には2つのタイプがあります。WAL/DBデバイス用の領域と、保存データ用のプライマリ領域です。WAL/DBの最小値(デフォルト値)は6GBです。データ用の最小領域は5GBです。これは、5GB未満のパーティションには自動的に重み0が割り当てられるためです。
   </para>
   <para>
    したがって、OSDの最小ディスク領域は11GBになりますが、テスト目的であっても20GB未満のディスクはお勧めしません。
   </para>
  </sect2>

  <sect2 xml:id="rec-waldb-size">
   <title>BlueStoreのWALおよびDBデバイスの推奨サイズ</title>
   <tip>
    <title>詳細情報</title>
    <para>
     BlueStoreの詳細については、<xref linkend="about-bluestore"/>を参照してください。
    </para>
   </tip>
   <itemizedlist>
    <listitem>
     <para>
      WALデバイス用に4GBを予約することをお勧めします。DBの推奨サイズは、ほとんどのワークロードにおいて64MBです。
     </para>
     <important>
      <para>
       高負荷な展開では、DB容量をさらに大きくすることをお勧めします。特に、RGWやCephFSの使用量が高い場合です。必要に応じて、DB領域拡張用のハードウェアを設置する収容能力(スロット)をある程度確保してください。
      </para>
     </important>
    </listitem>
    <listitem>
     <para>
      WALとDBデバイスを同じディスクに配置する予定の場合は、それぞれに別個のパーティションを設けるのではなく、両方のデバイスに対して単一のパーティションを使用することをお勧めします。これにより、CephはDBデバイスをWAL操作にも使用できます。Cephは必要時にのみDBパーティションをWALに使用するので、ディスク領域の管理が効率化します。もう1つの利点は、WALパーティションがいっぱいになる可能性は極めて低く、完全に使い切っていなければ、その領域が無駄になることはなく、DB操作に使用されることです。
     </para>
     <para>
      DBデバイスをWALと共有するには、WALデバイスを「指定しない」<emphasis/>で、DBデバイスのみを指定します。
     </para>
     <para>
      OSDレイアウトを指定する方法の詳細については、<xref linkend="drive-groups"/>を参照してください。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="ses-bp-share-ssd-journal">
   <title>WAL/DBパーティション用SSD</title>
   <para>
    SSD (ソリッドステートドライブ)には可動部品がありません。これは、ランダムアクセス時間と読み込みレイテンシを短縮すると同時に、データスループットを加速します。SSDの1MBあたりの価格は回転型ハードディスクの価格より大幅に高いため、SSDは小容量のストレージにのみ適しています。
   </para>
   <para>
    WAL/DBパーティションをSSDに保存し、オブジェクトデータは別個のハードディスクに保存することで、OSDのパフォーマンスを大幅に向上させることができます。
   </para>
   <tip>
    <title>複数のWAL/DBパーティションでSSDを共有</title>
    <para>
     WAL/DBパーティションは比較的小さい領域しか占有しないため、1つのSSDディスクを複数のWAL/DBパーティションで共有できます。WAL/DBパーティションを増やすほど、SSDディスクのパフォーマンスが低下することに注意してください。同じSSDディスクでWAL/DBパーティションを7つ以上共有することはお勧めしません。NVMeディスクの場合、13個以上の共有はお勧めしません。
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="maximum-count-of-disks-osd">
   <title>推奨されるディスクの最大数</title>
   <para>
    1台のサーバで、そのサーバで使用できる数だけのディスクを使用できます。サーバあたりのディスク数を計画する際には、考慮すべき点がいくつかあります。
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      「ネットワーク帯域幅」<emphasis/>サーバのディスクが増えるほど、ディスク書き込み操作のためにネットワークカード経由で転送しなければならないデータが増えます。
     </para>
    </listitem>
    <listitem>
     <para>
      「メモリ」<emphasis/>2GBを超えるRAMは、BlueStoreキャッシュに使用されます。<option>osd_memory_target</option>のデフォルトである4GBを使用すると、回転型メディアに適したキャッシュ開始サイズがシステムに設定されます。SSDまたはNVMEを使用する場合は、OSDあたりのキャッシュサイズとRAM割り当てを増やすことを検討します。
     </para>
    </listitem>
    <listitem>
     <para>
      「耐障害性」<emphasis/>サーバ全体に障害が発生した場合、搭載ディスクの数が多いほど、クラスタが一時的に失うOSDが増えます。さらに、レプリケーションルールを実行し続けるために、障害が発生したサーバからクラスタ内のほかのノードにすべてのデータをコピーする必要があります。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 <sect1 xml:id="sysreq-mon">
  <title>Monitorノード</title>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     少なくとも3つのMONノードが必要です。モニタの数は常に奇数(1+2n)である必要があります。
    </para>
   </listitem>
   <listitem>
    <para>
     4GBのRAM。
    </para>
   </listitem>
   <listitem>
    <para>
     4つの論理コアを持つプロセッサ。
    </para>
   </listitem>
   <listitem>
    <para>
     特に各モニタノードの<filename>/var/lib/ceph</filename>パスには、SSDか、その他の十分高速なストレージタイプを強くお勧めします。ディスクのレイテンシが大きいと、クォーラムが不安定になる可能性があるためです。冗長性を確保するには、RAID 1設定で2台のディスクを使用することをお勧めします。モニタが利用可能なディスク領域をログファイルの増大などから保護するため、モニタプロセスには、別個のディスク、または少なくとも別個のディスクパーティションを使用することをお勧めします。
    </para>
   </listitem>
   <listitem>
    <para>
     各ノードのモニタプロセスは1つだけにする必要があります。
    </para>
   </listitem>
   <listitem>
    <para>
     OSDノード、MON、またはObject Gatewayノードを混在させることは、十分なハードウェアリソースが利用可能な場合にのみサポートされます。つまり、すべてのサービスの要件を合計する必要があります。
    </para>
   </listitem>
   <listitem>
    <para>
     複数のスイッチにボンディングされた2つのネットワークインタフェース。
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="sysreq-rgw">
  <title>Object Gatewayノード</title>

  <para>
   Object Gatewayノードには最低でも6コアCPUと32GBのRAMを使用する必要があります。同じマシンに他のプロセスも配置されている場合、それらの要件を合計する必要があります。
  </para>
 </sect1>
 <sect1 xml:id="sysreq-mds">
  <title>メタデータサーバノード</title>

  <para>
   メタデータサーバノードの適切なサイズは、具体的な使用事例によって異なります。一般的には、メタデータサーバが処理する開いているファイルが多いほど、より多くのCPUとRAMが必要になります。最小要件は次のとおりです。
  </para>

  <itemizedlist>
   <listitem>
    <para>
     各メタデータサーバドメインに対して4GBのRAM。
    </para>
   </listitem>
   <listitem>
    <para>
     ボンディングされた2つのネットワークインタフェース。
    </para>
   </listitem>
   <listitem>
    <para>
     2個以上のコアを持つ2.5GHzのCPU。
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="sysreq-admin-node">
  <title>管理ノード</title>

  <para>
   少なくとも4GBのRAMとクアッドコアCPUが必要です。これには、管理ノードにおけるSalt Masterの実行が含まれます。数百のノードで構成される大規模クラスタでは、6GBのRAMをお勧めします。
  </para>
 </sect1>
 <sect1 xml:id="sysreq-iscsi">
  <title>iSCSI Gatewayノード</title>

  <para>
   iSCSI Gatewayノードには最低でも6コアCPUと16GBのRAMを使用するべきです。
  </para>
 </sect1>
 <sect1 xml:id="req-ses-other">
  <title>SESおよび、その他のSUSE製品</title>

  <para>
   このセクションには、SESと他のSUSE製品の統合に関する重要な情報が記載されています。
  </para>

  <sect2 xml:id="req-ses-suma">
   <title>SUSE Manager</title>
   <para>
    SUSE ManagerとSUSE Enterprise Storageは統合されていません。そのため、現在のところSUSE ManagerでSESクラスタを管理することはできません。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sysreq-naming">
  <title>名前の制限</title>

  <para>
   一般的に、Cephは、設定ファイル、プール名、ユーザ名などでASCII以外の文字をサポートしません。Cephクラスタを設定する場合、すべてのCephオブジェクト名/設定名で単純な英数字の文字(A～Z、a～z、0～9)と、最小限の句読点(「.」「-」「_」)のみを使用することをお勧めします。
  </para>
 </sect1>
 <sect1 xml:id="ses-bp-diskshare">
  <title>OSDとモニタでの1台のサーバの共有</title>

  <para>
   テスト環境ではOSDとMONを同じサーバで実行することは技術的に可能ですが、運用ではモニタノードごとに別個のサーバを用意することを強くお勧めします。その主な理由はパフォーマンスです。クラスタのOSDが増えるほど、MONノードが実行しなければならないI/O操作が増えます。さらに、1台のサーバをMONノードとOSDで共有する場合、OSDのI/O操作がモニタノードにとって制限要因になります。
  </para>

  <para>
   考慮すべきもう1つの点は、サーバ上のOSD、MONノード、およびオペレーティングシステムでディスクを共有するかどうかです。答えは単純です。可能であれば、OSDには別個の専用ディスクを使用し、モニタノードには別個の専用サーバを使用します。
  </para>

  <para>
   CephはディレクトリベースのOSDをサポートしますが、OSDには、常にオペレーティングシステムのディスクではなく専用ディスクを使用する必要があります。
  </para>

  <tip>
   <para>
    OSDとMONノードをどうしても<emphasis/>同じサーバで実行する必要がある場合は、MONを別個のディスクで実行し、そのディスクを<filename>/var/lib/ceph/mon</filename>ディレクトリにマウントすることで、少しでもパフォーマンスを向上させます。
   </para>
  </tip>
 </sect1>
</chapter>
