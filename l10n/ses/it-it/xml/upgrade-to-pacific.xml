<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="upgrade-to-pacific.xml" version="5.0" xml:id="upgrade-to-pacific">
 <title>Upgrade da SUSE Enterprise Storage 7 a 7.1</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Questo capitolo descrive le procedure per eseguire l&apos;upgrade di SUSE Enterprise Storage 7 alla versione 7.1.
 </para>
 <para>
  L&apos;upgrade include i task seguenti:
 </para>
 <itemizedlist>
  <listitem>
   <para>
    Esecuzione dell&apos;upgrade del sottostante SUSE Linux Enterprise Server 15 SP2 alla versione SUSE Linux Enterprise Server 15 SP3.
   </para>
  </listitem>
  <listitem>
   <para>
    Esecuzione dell&apos;upgrade da Ceph Octopus a Pacific.
   </para>
  </listitem>
 </itemizedlist>
 <sect1 xml:id="before-upgrade-7p">
  <title>Attività preparatorie all&apos;upgrade</title>

  <para>
   Prima di avviare l&apos;upgrade, <emphasis>occorre</emphasis> completare i task seguenti. È possibile eseguire l&apos;upgrade da SUSE Enterprise Storage 7 in qualsiasi momento.
  </para>

  <sect2 xml:id="upgrade-consider-points-7p">
   <title>Aspetti da considerare</title>
   <para>
    Prima di eseguire l&apos;upgrade, leggere per intero le sezioni seguenti per comprendere tutti i task che devono essere completati.
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <emphasis>Lettura delle note di rilascio</emphasis>. Nelle note, è possibile trovare informazioni aggiuntive sulle modifiche apportate rispetto alla release precedente di SUSE Enterprise Storage. Controllare le note di rilascio per vedere se:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        l&apos;hardware necessita di considerazioni speciali;
       </para>
      </listitem>
      <listitem>
       <para>
        i pacchetti software utilizzati hanno subito modifiche significative;
       </para>
      </listitem>
      <listitem>
       <para>
        è necessario adottare precauzioni speciali per l&apos;installazione.
       </para>
      </listitem>
     </itemizedlist>
     <para>
      Le note di rilascio forniscono inoltre informazioni che non si è fatto in tempo a riportare nel manuale. Contengono anche alcune note su problemi noti.
     </para>
     <para>
      All&apos;indirizzo <link xlink:href="https://www.suse.com/releasenotes/"/> è possibile trovare le note di rilascio di SES 7.1.
     </para>
     <para>
      Inoltre, dopo aver installato il pacchetto <package>release-notes-ses</package> dall&apos;archivio di SES 7.1, è possibile individuare localmente le note di rilascio nella directory <filename>/usr/share/doc/release-notes</filename> oppure online all&apos;indirizzo <link xlink:href="https://www.suse.com/releasenotes/"/>.
     </para>
    </listitem>
    <listitem>
     <para>
      Leggere la <xref linkend="ses-deployment"/> per acquisire dimestichezza con <systemitem class="resource">ceph-salt</systemitem> e con l&apos;utilità di coordinamento Ceph, in particolare con le informazioni sulle specifiche del servizio.
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="upgrade-backup-config-data-7p">
   <title>Backup della configurazione e dei dati del cluster</title>
   <para>
    Si consiglia vivamente di eseguire il backup completo della configurazione e dei dati del cluster prima di avviare l&apos;upgrade. Per istruzioni su come eseguire il backup di tutti i dati, vedere <xref linkend="cha-deployment-backup"/>.
   </para>
  </sect2>

  <sect2 xml:id="verify-previous-upgrade-patch-repos-7p">
   <title>Verifica dell&apos;accesso agli archivi software e alle immagini del container</title>
   <para>
    Verificare che ogni nodo del cluster disponga dell&apos;accesso agli archivi software di SUSE Linux Enterprise Server 15 SP3 e SUSE Enterprise Storage 7.1, oltre che al registro delle immagini del container.
   </para>
   <sect3 xml:id="verify-previous-upgrade-patch-repos-repos-7p">
    <title>Archivi software</title>
    <para>
     Se tutti i nodi sono registrati su SCC, sarà possibile eseguire l&apos;upgrade con il comando <command>zypper migration</command>. Per ulteriori dettagli, fare riferimento a <link xlink:href="https://documentation.suse.com/sles/15-SP3/html/SLES-all/cha-upgrade-online.html#sec-upgrade-online-zypper"/>.
    </para>
    <para>
     Se i nodi <emphasis role="bold">non</emphasis> sono registrati su SCC, disabilitare tutti gli archivi software esistenti e aggiungere gli archivi <literal>Pool</literal> e <literal>Updates</literal> per ciascuna delle estensioni seguenti:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       SLE-Product-SLES/15-SP3
      </para>
     </listitem>
     <listitem>
      <para>
       SLE-Module-Basesystem/15-SP3
      </para>
     </listitem>
     <listitem>
      <para>
       SLE-Module-Server-Applications/15-SP3
      </para>
     </listitem>
     <listitem>
      <para>
       SUSE-Enterprise-Storage-7.1
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="verify-previous-upgrade-patch-repos-images-7p">
    <title>Immagini del container</title>
    <para>
     Tutti i nodi del cluster necessitano dell&apos;accesso al registro delle immagini del container. Nella maggior parte dei casi, viene utilizzato il registro SUSE pubblico all&apos;indirizzo <literal>registry.suse.com</literal>. Sono necessarie le immagini seguenti:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/ceph
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/grafana
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/prometheus-server
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/prometheus-node-exporter
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/prometheus-alertmanager
      </para>
     </listitem>
    </itemizedlist>
    <para>
     In alternativa, ad esempio per le distribuzioni Air-gap, configurare un registro locale e verificare di disporre dell&apos;insieme di immagini del container corretto. Fare riferimento alla <xref linkend="deploy-cephadm-configure-registry"/> per ulteriori dettagli sulla configurazione di un registro delle immagini del container locale.
    </para>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="upgrade-cluster-nodes">
  <title>Migrazione di SUSE Linux Enterprise Server su ciascun nodo del cluster alla versione SUSE Linux Enterprise Server 15 SP3</title>

  <para>
   Se i nodi del cluster sono configurati per l&apos;utilizzo di SUSE Customer Center, è possibile ricorrere al comando <command>zypper migration</command>.
  </para>

  <para>
   Se i nodi del cluster dispongono di archivi software configurati manualmente, è necessario aggiornare i nodi manualmente.
  </para>

  <para>
   Per informazioni dettagliate sull&apos;upgrade di SUSE Linux Enterprise Server mediante <command>zypper</command>, fare riferimento a <link xlink:href="https://documentation.suse.com/sles/15-SP3/html/SLES-all/cha-upgrade-online.html#sec-upgrade-online-zypper"/>.
  </para>
 </sect1>
 <sect1 xml:id="upgrade-ses-packages">
  <title>Aggiornamento dei pacchetti relativi a SUSE Enterprise Storage su ciascun nodo del cluster</title>

  <para>
   Per aggiornare i pacchetti SUSE Enterprise Storage alla versione più recente, utilizzare il comando <command>ceph-salt update</command>. Per ulteriori informazioni, fare riferimento al <xref linkend="cephadm-rolling-updates"/>.
  </para>
 </sect1>
 <sect1 xml:id="upgrade-ses-services">
  <title>Upgrade dei servizi esistenti del cluster Ceph</title>

  <para>
   Eseguire l&apos;upgrade dell&apos;intero cluster Ceph alla versione Pacific eseguendo il seguente comando dal nodo admin:
  </para>

<screen><prompt>cephuser@adm &gt; </prompt>ceph orch upgrade start --image registry.suse.com/ses/7.1/ceph/ceph</screen>
 </sect1>
</chapter>
