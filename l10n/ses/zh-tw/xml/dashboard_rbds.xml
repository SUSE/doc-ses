<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="dashboard_rbds.xml" version="5.0" xml:id="dashboard-rbds">
 <title>管理 RADOS 區塊裝置</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>是</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  若要列出所有可用的 RADOS 區塊裝置 (RBD)，請按一下主功能表中的<menuchoice><guimenu>區塊裝置</guimenu><guimenu>影像</guimenu></menuchoice>。
 </para>
 <para>
  該清單顯示有關裝置的簡要資訊，例如裝置名稱、相關池名稱、名稱空間、裝置大小、裝置上的物件數量和大小、有關詳細資料佈建的詳細資料以及父項。
 </para>
 <figure>
  <title>RBD 影像清單</title>
  <mediaobject>
   <imageobject role="fo">
    <imagedata fileref="dash_rbd_images.png" width="100%"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="dash_rbd_images.png" width="100%"/>
   </imageobject>
  </mediaobject>
 </figure>
 <sect1 xml:id="dashboard-rbds-details">
  <title>檢視有關 RBD 的詳細資料</title>

  <para>
   若要檢視某部裝置的更多詳細資訊，請按一下表中對應的列：
  </para>

  <figure>
   <title>RBD 詳細資料</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_rbd_images_details.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_rbd_images_details.png" width="100%"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-rbds-configuration">
  <title>檢視 RBD 的組態</title>

  <para>
   若要檢視某部裝置的詳細組態，請按一下表中對應的列，然後按一下下方表中的<guimenu>組態</guimenu>索引標籤：
  </para>

  <figure>
   <title>RBD 組態</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_rbd_images_config.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_rbd_images_config.png" width="100%"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-rbds-create">
  <title>建立 RBD</title>

  <para>
   若要新增新裝置，請按一下表標題左上方的<guimenu>建立</guimenu>，然後在<guimenu>建立 RBD</guimenu> 螢幕上執行以下操作：
  </para>

  <figure>
   <title>新增新的 RBD</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_rbd_add.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_rbd_add.png" width="100%"/>
    </imageobject>
   </mediaobject>
  </figure>

  <procedure>
   <step>
    <para>
     輸入新裝置的名稱。請參閱<xref linkend="sysreq-naming"/>以瞭解命名限制。
    </para>
   </step>
   <step>
    <para>
     選取要在其中建立新 RBD 裝置且指定了 <option>rbd</option> 應用程式的池。
    </para>
   </step>
   <step>
    <para>
     指定新裝置的大小。
    </para>
   </step>
   <step>
    <para>
     為裝置指定其他選項。若要微調裝置參數，請按一下<guimenu>進階</guimenu>，然後輸入物件大小、分割單位或分割計數的值。若要輸入服務品質 (QoS) 限制，請按一下<guimenu>服務品質</guimenu>，然後輸入限制。
    </para>
   </step>
   <step>
    <para>
     按一下<guimenu>建立 RBD</guimenu> 進行確認。
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="dashboard-rbd-delete">
  <title>刪除 RBD</title>

  <para>
   若要刪除裝置，請選取表中該裝置對應的列。按一下<guimenu>建立</guimenu>按鈕旁的下拉式箭頭，然後按一下<guimenu>刪除</guimenu>。按一下<guimenu>刪除 RBD</guimenu> 確認刪除。
  </para>

  <tip>
   <title>將 RBD 移至垃圾桶</title>
   <para>
    刪除 RBD 的動作無法復原。如果您選擇將裝置<guimenu>移至垃圾桶</guimenu>，那麼稍後還可以將其還原，只需在主表的<guimenu>垃圾桶</guimenu>索引標籤上選取該裝置，然後按一下表標題左上方的<guimenu>還原</guimenu>。
   </para>
  </tip>
 </sect1>
 <sect1 xml:id="dashboard-rbds-snapshots">
  <title>建立 RADOS 區塊裝置快照</title>

  <para>
   若要建立 RADOS 區塊裝置快照，請選取表中該裝置對應的列，將會顯示詳細的組態內容窗格。選取<guimenu>快照</guimenu>索引標籤，然後按一下表標題左上方的<guimenu>建立</guimenu>。輸入快照的名稱，然後按一下<guimenu>建立 RBD 快照</guimenu>進行確認。
  </para>

  <para>
   選取快照後，您可以在裝置上執行其他動作，例如重新命名、保護、克隆、複製或刪除。<guimenu>復原</guimenu>可根據目前的快照還原裝置的狀態。
  </para>

  <figure>
   <title>RBD 快照</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_rbd_images_snapshots.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_rbd_images_snapshots.png" width="100%"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dash-rbd-mirror">
  <title>RBD 鏡像</title>

  <para>
   RADOS 區塊裝置影像可以在兩個 Ceph 叢集之間以非同步方式鏡像。您可以使用 Ceph Dashboard 在兩個或更多叢集之間設定 RBD 影像複製。此功能有兩種模式：
  </para>

  <variablelist>
   <varlistentry>
    <term>基於記錄</term>
    <listitem>
     <para>
      此模式使用 RBD 記錄影像功能來確保叢集之間的複製在時間點和當機時保持一致。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>基於快照</term>
    <listitem>
     <para>
      此模式使用定期排程或手動建立的 RBD 影像鏡像快照，以在叢集之間複製當機時保持一致的 RBD 影像。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   鏡像是基於對等叢集中的每個池進行設定的，可以對池中的特定影像子集進行設定，也可以設定為在僅使用基於記錄的鏡像時自動鏡像池中的所有影像。
  </para>

  <para>
   鏡像是使用 <command>rbd</command> 指令設定的，依預設，SUSE Enterprise Storage 7 中會安裝該應用程式。<systemitem class="daemon">rbd-mirror</systemitem> 精靈負責從遠端對等叢集提取影像更新，並將它們套用於本地叢集中的影像。如需啟用 <systemitem class="daemon">rbd-mirror</systemitem> 精靈的詳細資訊，請參閱<xref linkend="rbd-mirror-daemon-enable"/>。
  </para>

  <para>
   依據複製需求，RBD 區塊裝置鏡像可以設定為單向或雙向複製：
  </para>

  <variablelist>
   <varlistentry>
    <term>單向複製</term>
    <listitem>
     <para>
      當資料僅會從主要叢集鏡像到次要叢集時，<systemitem class="daemon">rbd-mirror</systemitem> 精靈僅在次要叢集上執行。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>雙向複製</term>
    <listitem>
     <para>
      當資料從一個叢集上的主要影像鏡像到另一個叢集上的非主要影像 (反之亦然) 時，<systemitem class="daemon">rbd-mirror</systemitem> 精靈將在兩個叢集上執行。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <important>
   <para>
    <systemitem class="daemon">rbd-mirror</systemitem> 精靈的每個例項都必須能夠同時連接至本地和遠端 Ceph 叢集，例如所有監控程式和 OSD 主機。此外，網路必須在兩個資料中心之間具有足夠的頻寬來處理鏡像工作負載。
   </para>
  </important>

  <tip>
   <title>一般資訊</title>
   <para>
    如需 RADOS 區塊裝置鏡像的一般資訊和指令行方法，請參閱<xref linkend="ceph-rbd-mirror"/>。
   </para>
  </tip>

  <sect2 xml:id="rbd-mirror-primary-secondary">
   <title>設定主要叢集和次要叢集</title>
   <para>
    <emphasis>主要</emphasis>叢集是用於建立包含影像的原始池的叢集。<emphasis>次要</emphasis>叢集是用於從<emphasis>主要</emphasis>叢集複製池或影像的叢集。
   </para>
   <note>
    <title>相對命名</title>
    <para>
     在複製情境中，<emphasis>主要</emphasis>與<emphasis>次要</emphasis>這兩個術語有可能是相對的，因為相較於叢集來說，它們與個別池更為相關。例如，在雙向複製中，可將一個池從<emphasis>主要</emphasis>叢集鏡像到<emphasis>次要</emphasis>叢集，與此同時，也可以將另一個池從<emphasis>次要</emphasis>叢集鏡像到<emphasis>主要</emphasis>叢集。
    </para>
   </note>
  </sect2>

  <sect2 xml:id="rbd-mirror-daemon-enable">
   <title>啟用 <systemitem class="daemon">rbd-mirror</systemitem> 精靈</title>
   <para>
    下面的程序展示如何使用 <command>rbd</command> 指令來執行設定鏡像的基本管理任務。在 Ceph 叢集中依池來設定鏡像。
   </para>
   <para>
    兩個對等叢集上都應執行池設定步驟。為清楚起見，這些程序假設可從單部主機存取名為「primary」和「secondary」的兩個叢集。
   </para>
   <para>
    <systemitem class="daemon">rbd-mirror</systemitem> 精靈負責執行實際的叢集資料複製。
   </para>
   <procedure>
    <step>
     <para>
      重新命名 <filename>ceph.conf</filename> 和金鑰圈檔案，並將其從主要主機複製到次要主機：
     </para>
<screen>
<prompt>cephuser@secondary &gt; </prompt>cp /etc/ceph/ceph.conf /etc/ceph/primary.conf
<prompt>cephuser@secondary &gt; </prompt>cp /etc/ceph/ceph.admin.client.keyring \
 /etc/ceph/primary.client.admin.keyring
<prompt>cephuser@secondary &gt; </prompt>scp <replaceable>PRIMARY_HOST</replaceable>:/etc/ceph/ceph.conf \
 /etc/ceph/secondary.conf
<prompt>cephuser@secondary &gt; </prompt>scp  <replaceable>PRIMARY_HOST</replaceable>:/etc/ceph/ceph.client.admin.keyring \
 /etc/ceph/secondary.client.admin.keyring
</screen>
    </step>
    <step>
     <para>
      若要使用 <command>rbd</command> 針對池啟用鏡像，請指定 <command>mirror pool enable</command>、池名稱和鏡像模式：
     </para>
<screen><prompt>cephuser@adm &gt; </prompt>rbd mirror pool enable <replaceable>POOL_NAME</replaceable> <replaceable>MODE</replaceable></screen>
     <note>
      <para>
       鏡像模式可以是 <literal>image</literal> 或 <literal>pool</literal>。例如：
      </para>
<screen>
<prompt>cephuser@secondary &gt; </prompt>rbd --cluster primary mirror pool enable image-pool image
<prompt>cephuser@secondary &gt; </prompt>rbd --cluster secondary mirror pool enable image-pool image
</screen>
     </note>
    </step>
    <step>
     <para>
      在 Ceph Dashboard 上，導覽至<menuchoice><guimenu>區塊</guimenu><guimenu>鏡像</guimenu></menuchoice>。<guimenu>精靈</guimenu>表的左側會顯示處於使用中狀態的執行中 <systemitem class="daemon">rbd-mirror</systemitem> 精靈及其狀態。
     </para>
     <figure>
      <title>執行中 <systemitem class="daemon">rbd-mirror</systemitem> 精靈</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="rbd-mirror-daemon.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="rbd-mirror-daemon.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="rbd-mirror-disable">
   <title>停用鏡像</title>
   <para>
    若要使用 <command>rbd</command> 針對池停用鏡像，請指定 <command>mirror pool disable</command> 指令和池名稱：
   </para>
<screen><prompt>cephuser@adm &gt; </prompt>rbd mirror pool disable <replaceable>POOL_NAME</replaceable></screen>
   <para>
    使用這種方法對池停用鏡像時，還會對已為其明確啟用鏡像的所有影像 (該池中) 停用鏡像。
   </para>
  </sect2>

  <sect2 xml:id="rbd-mirror-peer-bootstrap">
   <title>開機對等</title>
   <para>
    為了使 <systemitem class="daemon">rbd-mirror</systemitem> 探查其對等叢集，需要將對等註冊到池，並需要建立使用者帳戶。此程序可以使用 <command>rbd</command> 透過 <command>mirror pool peer bootstrap create</command> 和 <command>mirror pool peer bootstrap import</command> 指令自動完成。
   </para>
   <para>
    若要使用 <command>rbd</command> 手動建立新的開機記號，請指定 <command>mirror pool peer bootstrap create</command> 指令、池名稱以及描述本地叢集的選擇性站台名稱：
   </para>
<screen><prompt>cephuser@adm &gt; </prompt>rbd mirror pool peer bootstrap create [--site-name <replaceable>local-site-name</replaceable>] <replaceable>pool-name</replaceable></screen>
   <para>
    <command>mirror pool peer bootstrap create</command> 的輸出將為應提供給 <command>mirror pool peer bootstrap import</command> 指令的記號。例如，在主要叢集上：
   </para>
<screen><prompt>cephuser@adm &gt; </prompt>rbd --cluster primary mirror pool peer bootstrap create --site-name primary
  image-pool eyJmc2lkIjoiOWY1MjgyZGItYjg5OS00NTk2LTgwOTgtMzIwYzFmYzM5NmYzIiwiY2xpZW50X2lkIjoicmJkL \
  W1pcnJvci1wZWVyIiwia2V5IjoiQVFBUnczOWQwdkhvQmhBQVlMM1I4RmR5dHNJQU50bkFTZ0lOTVE9PSIsIm1vbl9ob3N0I \
  joiW3YyOjE5Mi4xNjguMS4zOjY4MjAsdjE6MTkyLjE2OC4xLjM6NjgyMV0ifQ==</screen>
   <para>
    若要使用 <command>rbd</command> 指令手動輸入另一個叢集建立的開機記號，請指定 <command>mirror pool peer bootstrap import</command> 指令、池名稱、所建立記號的檔案路徑 (或設定為「-」以從標準輸入讀取)，以及描述本地叢集的選擇性站台名稱和鏡像方向 (預設設定為 <literal>rx-tx</literal> 以進行雙向鏡像，但也可設定為 <literal>rx-only</literal> 以進行單向鏡像)：
   </para>
<screen><prompt>cephuser@adm &gt; </prompt>rbd mirror pool peer bootstrap import [--site-name <replaceable>local-site-name</replaceable>] \
[--direction <replaceable>rx-only or rx-tx</replaceable>] <replaceable>pool-name</replaceable> <replaceable>token-path</replaceable></screen>
   <para>
    例如，在次要叢集上：
   </para>
<screen><prompt>cephuser@adm &gt; </prompt>cat &gt;&gt;EOF &lt; token
eyJmc2lkIjoiOWY1MjgyZGItYjg5OS00NTk2LTgwOTgtMzIwYzFmYzM5NmYzIiwiY2xpZW50X2lkIjoicmJkLW \
1pcnJvci1wZWVyIiwia2V5IjoiQVFBUnczOWQwdkhvQmhBQVlMM1I4RmR5dHNJQU50bkFTZ0lOTVE9PSIsIm1v \
bl9ob3N0IjoiW3YyOjE5Mi4xNjguMS4zOjY4MjAsdjE6MTkyLjE2OC4xLjM6NjgyMV0ifQ==
EOF
<prompt>cephuser@adm &gt; </prompt>rbd --cluster secondary mirror pool peer bootstrap import --site-name secondary image-pool token</screen>
  </sect2>

  <sect2 xml:id="rbd-mirror-remove-peers">
   <title>移除叢集對等</title>
   <para>
    若要使用 <command>rbd</command> 指令移除鏡像對等 Ceph 叢集，請指定 <command>mirror pool peer remove</command> 指令、池名稱和對等 UUID (可透過 <command>rbd mirror pool info</command> 指令獲得)：
   </para>
<screen><prompt>cephuser@adm &gt; </prompt>rbd mirror pool peer remove <replaceable>pool-name</replaceable> <replaceable>peer-uuid</replaceable></screen>
  </sect2>

  <sect2 xml:id="rbd-mirror-gui-config">
   <title>在 Ceph Dashboard 中設定池複製</title>
   <para>
    <systemitem class="daemon">rbd-mirror</systemitem> 精靈需要擁有主要叢集的存取權，才能鏡像 RBD 影像。繼續之前，請確定已依據<xref linkend="rbd-mirror-peer-bootstrap"/>中的步驟進行操作。
   </para>
   <procedure>
    <step>
     <para>
      在<emphasis>主要</emphasis>和<emphasis>次要</emphasis>兩個叢集上，建立名稱相同的池，並為其指定 <literal>rbd</literal> 應用程式。如需建立新池的更多詳細資料，請參閱<xref linkend="dashboard-pools-create"/>。
     </para>
     <figure>
      <title>建立具有 RBD 應用程式的池</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="rbd-mirror-pool.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="rbd-mirror-pool.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      在<emphasis>主要</emphasis>和<emphasis>次要</emphasis>兩個叢集的儀表板上，導覽至<menuchoice><guimenu>區塊</guimenu><guimenu>鏡像</guimenu></menuchoice>。在<guimenu>池</guimenu>表右側按一下要複製的池的名稱，然後按一下<guimenu>編輯模式</guimenu>，並選取複製模式。在此範例中，我們將使用<emphasis>池</emphasis>複製模式，也就是說，將複製給定池中的所有影像。按一下<guimenu>更新</guimenu>進行確認。
     </para>
     <figure>
      <title>設定複製模式</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="rbd-mirror-pool-mode.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="rbd-mirror-pool-mode.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
     <important>
      <title>主要叢集上的錯誤或警告</title>
      <para>
       更新複製模式後，右側相應的欄中會顯示錯誤或警告旗標。這是因為尚未為池指定用於複製的對等使用者。對於<emphasis>主要</emphasis>叢集，請省略此旗標，因為我們僅需為<emphasis>次要</emphasis>叢集指定對等使用者。
      </para>
     </important>
    </step>
    <step>
     <para>
      在<emphasis>次要</emphasis>叢集的儀表板上，導覽至<menuchoice><guimenu>區塊</guimenu><guimenu>鏡像</guimenu></menuchoice>。透過選取<guimenu>新增對等</guimenu>來新增池鏡像對等。提供<emphasis>主要</emphasis>叢集的詳細資料：
     </para>
     <figure>
      <title>新增對等身分證明</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="rbd-mirror-pool-peer.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="rbd-mirror-pool-peer.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
     <variablelist>
      <varlistentry>
       <term><guimenu>磁簇名稱</guimenu></term>
       <listitem>
        <para>
         用於識別主要叢集的任意唯一字串，例如「primary」。該叢集名稱不得與實際環境中次要叢集的名稱相同。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><guimenu>CephX ID</guimenu></term>
       <listitem>
        <para>
         您建立做為鏡像對等的 Ceph 使用者 ID。此範例中為「rbd-mirror-peer」。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><guimenu>監控程式位址</guimenu></term>
       <listitem>
        <para>
         主要叢集 Ceph 監控程式節點的 IP 位址的逗號分隔清單。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><guimenu>CephX 金鑰</guimenu></term>
       <listitem>
        <para>
         與對等使用者 ID 相關的金鑰。您可以透過在主要叢集上執行以下範例指令來擷取該金鑰：
        </para>
<screen><prompt>cephuser@adm &gt; </prompt>ceph auth print_key <replaceable>pool-mirror-peer-name</replaceable></screen>
       </listitem>
      </varlistentry>
     </variablelist>
     <para>
      按一下<guimenu>提交</guimenu>以確認。
     </para>
     <figure>
      <title>複本池清單</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="rbd-mirror-pool-list.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="rbd-mirror-pool-list.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="rbd-mirror-test">
   <title>確認 RBD 影像複製是否有效</title>
   <para>
    如果 <systemitem class="daemon">rbd-mirror</systemitem> 精靈正在執行，在 Ceph Dashboard 上設定 RBD 影像複製後，就需要確認複製實際上是否有效：
   </para>
   <procedure>
    <step>
     <para>
      在<emphasis>主要</emphasis>叢集的 Ceph Dashboard 上建立 RBD 影像，並將您已建立用於複製目的的池設為其父池。為影像啟用<option>獨佔鎖定</option>和<option>記錄</option>功能。如需如何建立 RBD 影像的詳細資料，請參閱<xref linkend="dashboard-rbds-create"/>。
     </para>
     <figure>
      <title>新 RBD 影像</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="rbd-mirror-image.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="rbd-mirror-image.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      建立要複製的影像後，開啟<emphasis>次要</emphasis>叢集的 Ceph Dashboard，並導覽至<menuchoice><guimenu>區塊</guimenu><guimenu>鏡像</guimenu></menuchoice>。右側的<guimenu>池</guimenu>表將在<guimenu>遠端數量</guimenu>中所示數量的影像中反映該變更，並會同步<guimenu>本地數量</guimenu>中所示數量的影像。
     </para>
     <figure>
      <title>同步的新 RBD 影像</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="rbd-mirror-pool-list-1.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="rbd-mirror-pool-list-1.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
     <tip>
      <title>複製進度</title>
      <para>
       頁面底部的<guimenu>影像</guimenu>表會顯示 RBD 影像的複製狀態。<guimenu>問題</guimenu>索引標籤包含可能的問題，<guimenu>正在同步</guimenu>索引標籤顯示影像複製的進度，<guimenu>準備就緒</guimenu>索引標籤列出所有已成功複製的影像。
      </para>
      <figure>
       <title>RBD 影像的複製狀態</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-images-status.png" width="100%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-images-status.png" width="100%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </tip>
    </step>
    <step>
     <para>
      在<emphasis>主要</emphasis>叢集上，將資料寫入 RBD 影像。在<emphasis>次要</emphasis>叢集的 Ceph Dashboard 上，導覽至<menuchoice><guimenu>區塊</guimenu><guimenu>影像</guimenu></menuchoice>，並監控相應影像大小的增長是否與主要叢集上寫入的資料一致。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-iscsi">
  <title>管理 iSCSI 閘道</title>

  <tip>
   <title>iSCSI 閘道的更多資訊</title>
   <para>
    如需 iSCSI 閘道的更多一般資訊，請參閱<xref linkend="cha-ceph-iscsi"/>。
   </para>
  </tip>

  <para>
   若要列出所有可用閘道和對應的影像，請按一下主功能表中的<menuchoice><guimenu>區塊</guimenu><guimenu>iSCSI</guimenu></menuchoice>。<guimenu>綜覽</guimenu>索引標籤即會開啟，列出目前設定的 iSCSI 閘道和對應的 RBD 影像。
  </para>

  <para>
   <guimenu>閘道</guimenu>表列出每個閘道的狀態、iSCSI 目標數量及工作階段數量。<guimenu>影像</guimenu>表列出每個對應影像的名稱、相關池名稱、後備儲存類別，以及其他統計資料詳細資訊。
  </para>

  <para>
   <guimenu>目標</guimenu>索引標籤列出目前設定的 iSCSI 目標。
  </para>

  <figure>
   <title>iSCSI 目標清單</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_igws.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_igws.png" width="100%"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   若要檢視有關目標的更多詳細資訊，請按一下表中該目標對應的列上的下拉式箭頭。一個樹狀結構綱要即會開啟，列出磁碟、入口網站、啟動器和群組。按一下某一項可將其展開並檢視詳細內容，右側的表中也可能會顯示其相關組態。
  </para>

  <figure>
   <title>iSCSI 目標詳細資料</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_igws_status.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_igws_status.png" width="100%"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="dashboard-iscsi-create">
   <title>新增 iSCSI 目標</title>
   <para>
    若要新增新的 iSCSI 目標，請按一下<guimenu>目標</guimenu>表左上方的<guimenu>建立</guimenu>，並輸入所需資訊。
   </para>
   <figure>
    <title>新增新目標</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_igws_add.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_igws_add.png" width="100%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      輸入新閘道的目標位址。
     </para>
    </step>
    <step>
     <para>
      按一下<guimenu>新增入口網站</guimenu>，然後從清單中選取一或多個 iSCSI 入口網站。
     </para>
    </step>
    <step>
     <para>
      按一下<guimenu>新增影像</guimenu>，然後為閘道選取一或多個 RBD 影像。
     </para>
    </step>
    <step>
     <para>
      如果您需要使用驗證才能存取閘道，請啟用 <guimenu>ACL 驗證</guimenu>核取方塊並輸入身分證明。選取<guimenu>雙向驗證</guimenu>和<guimenu>探查驗證</guimenu>之後，您可看到更多進階驗證選項。
     </para>
    </step>
    <step>
     <para>
      按一下<guimenu>建立目標</guimenu>進行確認。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dashboard-iscsi-edit">
   <title>編輯 iSCSI 目標</title>
   <para>
    若要編輯某個現有 iSCSI 目標，請按一下<guimenu>目標</guimenu>表中對應的列，然後按一下表左上方的<guimenu>編輯</guimenu>。
   </para>
   <para>
    然後，您便可以修改 iSCSI 目標、新增或刪除入口網站，以及新增或刪除相關 RBD 影像。您還可以調整閘道的驗證資訊。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-iscsi-delete">
   <title>刪除 iSCSI 目標</title>
   <para>
    若要刪除 iSCSI 目標，請選取表中其所對應的列並按一下<guimenu>編輯</guimenu>按鈕旁的下拉式箭頭，然後選取<guimenu>刪除</guimenu>。啟用<guimenu>是的，我確定</guimenu>，然後按一下<guimenu>刪除 iSCSI 目標</guimenu>進行確認。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dash-rbd-qos">
  <title>RBD 服務品質 (QoS)</title>

  <tip>
   <title>相關資訊</title>
   <para>
    如需 RBD QoS 組態選項的更多一般資訊和描述，請參閱<xref linkend="rbd-qos"/>。
   </para>
  </tip>

  <para>
   您可以在不同層級設定 QoS 選項。
  </para>

  <itemizedlist>
   <listitem>
    <para>
     全域
    </para>
   </listitem>
   <listitem>
    <para>
     基於每個池
    </para>
   </listitem>
   <listitem>
    <para>
     基於每個影像
    </para>
   </listitem>
  </itemizedlist>

  <para>
   <emphasis>全域</emphasis>組態位於清單頂部，將用於所有新建立的 RBD 影像，以及不會覆寫池或 RBD 影像層相應值的影像。基於每個池或影像設定的值可能會覆寫全域指定的選項值。針對某個池指定的選項將套用至該池的所有 RBD 影像，除非被針對某個影像設定的組態選項所覆寫。對影像指定的選項將覆寫對池指定的選項以及全域指定的選項。
  </para>

  <para>
   因此可以如此操作：全域定義預設值，對預設值進行調整以適合特定池的所有 RBD 影像，然後覆寫個別 RBD 影像的池組態。
  </para>

  <sect2 xml:id="dash-rbd-qos-global">
   <title>全域設定選項</title>
   <para>
    若要全域設定 RADOS 區塊裝置選項，請從主功能表中選取<menuchoice><guimenu>叢集</guimenu>
    <guimenu>組態</guimenu></menuchoice>。
   </para>
   <procedure>
    <step>
     <para>
      若要列出所有可用的全域組態選項，請在<menuchoice><guimenu>層級</guimenu></menuchoice>旁從下拉式功能表中選擇<menuchoice><guimenu>進階</guimenu></menuchoice>。
     </para>
    </step>
    <step>
     <para>
      在搜尋欄位中過濾 <literal>rbd_qos</literal>，以過濾表的結果。QoS 的所有可用組態選項即會列出。
     </para>
    </step>
    <step>
     <para>
      若要變更某個值，請按一下表中該值對應的列，然後選取表左上方的<guimenu>編輯</guimenu>。<guimenu>編輯</guimenu>對話方塊包含 6 個不同的欄位供您指定值。在 <guimenu>mgr</guimenu> 文字方塊中，RBD 組態選項值是必填的。
     </para>
     <note>
      <para>
       此對話方塊與其他對話方塊不同，不允許您使用方便的單位指定值。您只能使用位元組或 IOPS 單位設定這些值，具體取決於您要編輯的選項。
      </para>
     </note>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dash-rbd-qos-pool-create">
   <title>針對新池設定選項</title>
   <para>
    若要建立新池並對其設定 RBD 組態選項，請按一下<menuchoice><guimenu>池</guimenu>
    <guimenu>建立</guimenu></menuchoice>。選取<guimenu>複本</guimenu>做為池類型。然後，您需要將 <literal>rbd</literal> 應用程式標記新增至池，這樣才能設定 RBD QoS 選項。
   </para>
   <note>
    <para>
     對於糾刪碼池是無法設定 RBD QoS 組態選項的。若要為糾刪碼池設定 RBD QoS 選項，您需要編輯 RBD 影像的複本中繼資料池。該組態隨後將套用於該影像的糾刪碼資料池。
    </para>
   </note>
  </sect2>

  <sect2 xml:id="dash-rbd-qos-pool-edit">
   <title>針對現有池設定選項</title>
   <para>
    若要對某個現有池設定 RBD QoS 選項，請按一下<guimenu>池</guimenu>，然後按一下表中該池對應的列，並選取表左上方的<guimenu>編輯</guimenu>。
   </para>
   <para>
    對話方塊中應該就會顯示 <guimenu>RBD 組態</guimenu>區段，下方是<guimenu>服務品質</guimenu>區段。
   </para>
   <note>
    <para>
     如果 <guimenu>RBD 組態</guimenu>和<guimenu>服務品質</guimenu>區段均未顯示，則可能是因為您正在編輯無法用於設定 RBD 組態選項的<emphasis>糾刪碼</emphasis>池，或該池未設定為供 RBD 影像使用。在下一個案例中，將為池指定 <guimenu>rbd</guimenu> 應用程式標記，相應的組態區段將會顯示。
    </para>
   </note>
  </sect2>

  <sect2 xml:id="dash-rbd-qos-qos">
   <title>組態選項</title>
   <para>
    按一下<guimenu>服務品質 +</guimenu> 以展開組態選項。所有可用選項的清單即會顯示。文字方塊中已顯示組態選項的單位。對於任何每秒位元組數 (BPS) 選項，您可以選擇使用「1M」或「5G」之類的捷徑。系統會自動將其轉換為對應的「1 MB/s」和「5 GB/s」。
   </para>
   <para>
    按一下每個文字方塊右側的重設按鈕，將移除對該池設定的所有值。此操作不會移除全域設定或對 RBD 影像所設定選項的組態值。
   </para>
  </sect2>

  <sect2 xml:id="dash-rbd-qos-image-create">
   <title>使用新 RBD 影像建立 RBD QoS 選項</title>
   <para>
    若要建立 RBD 影像並對該影像設定 RBD QoS 選項，請選取<menuchoice><guimenu>區塊</guimenu> <guimenu>影像</guimenu></menuchoice>，然後按一下<guimenu>建立</guimenu>。按一下<guimenu>進階...</guimenu>可展開進階組態區段。按一下<guimenu>服務品質 +</guimenu> 可開啟所有可用組態選項。
   </para>
  </sect2>

  <sect2 xml:id="dash-rbd-qos-image-edit">
   <title>編輯現有影像的 RBD QoS 選項</title>
   <para>
    若要編輯現有影像的 RBD QoS 選項，請選取<menuchoice><guimenu>區塊</guimenu>
    <guimenu>影像</guimenu></menuchoice>，然後按一下表中該池對應的列，最後按一下<guimenu>編輯</guimenu>。編輯對話方塊隨即顯示。按一下<guimenu>進階...</guimenu>可展開進階組態區段。按一下<guimenu>服務品質 +</guimenu> 可開啟所有可用組態選項。
   </para>
  </sect2>

  <sect2 xml:id="dash-rbd-qos-image-copy">
   <title>在複製或克隆影像時變更組態選項</title>
   <para>
    如果克隆或複製了 RBD 影像，系統預設還會複製對該特定影像設定的值。如果您想在複製或克隆期間變更這些值，可透過在複製/克隆對話方塊中指定更新的組態值來進行變更，此程序與建立或編輯 RBD 影像時的方式相同。執行此操作只能設定 (或重設) 所複製或克隆的 RBD 影像的值，無法變更來源 RBD 影像組態，也無法變更全域組態。
   </para>
   <para>
    如果您選擇在複製/克隆時重設選項值，系統將不會對該影像設定該選項的值。這表示系統將使用為父池指定的該選項的任何值 (如果為父池設定了相應值)。如果沒有為父池設定相應值，則將使用全域預設值。
   </para>
  </sect2>
 </sect1>
</chapter>
