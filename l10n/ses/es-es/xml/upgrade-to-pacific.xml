<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="upgrade-to-pacific.xml" version="5.0" xml:id="upgrade-to-pacific">
 <title>Actualización desde SUSE Enterprise Storage 7 a la versión 7.1</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  En este capítulo se presentan los pasos necesarios para actualizar SUSE Enterprise Storage 7 a la versión 7.1.
 </para>
 <para>
  La actualización incluye las siguientes tareas:
 </para>
 <itemizedlist>
  <listitem>
   <para>
    Actualización de la instancia subyacente de SUSE Linux Enterprise Server 15 SP2 a la versión SUSE Linux Enterprise Server 15 SP3.
   </para>
  </listitem>
  <listitem>
   <para>
    Actualización de Ceph Octopus a Pacific.
   </para>
  </listitem>
 </itemizedlist>
 <sect1 xml:id="before-upgrade-7p">
  <title>Antes de actualizar</title>

  <para>
   Las siguientes tareas <emphasis>deben</emphasis> completarse antes de iniciar la actualización. Puede hacerlo en cualquier momento durante la vida útil de SUSE Enterprise Storage 7.
  </para>

  <sect2 xml:id="upgrade-consider-points-7p">
   <title>Puntos que se deben tener en cuenta</title>
   <para>
    Antes de actualizar, lea atentamente las secciones siguientes para asegurarse de que comprende todas las tareas que deben ejecutarse.
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <emphasis>Lectura de las notas de la versión</emphasis>. En ellas encontrará información adicional sobre los cambios realizados desde la versión previa de SUSE Enterprise Storage. Consulte las notas de versión para comprobar lo siguiente:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        Si el hardware necesita consideraciones especiales.
       </para>
      </listitem>
      <listitem>
       <para>
        Si los paquetes de software usados han cambiado de forma significativa.
       </para>
      </listitem>
      <listitem>
       <para>
        Si es necesario tomar precauciones especiales para la instalación.
       </para>
      </listitem>
     </itemizedlist>
     <para>
      Las notas de la versión también proporcionan información que no pudo publicarse en el manual a tiempo y notas acerca de problemas conocidos.
     </para>
     <para>
      Encontrará las notas de la versión de SES 7.1 en línea en <link xlink:href="https://www.suse.com/releasenotes/"/>.
     </para>
     <para>
      Además, después de instalar el paquete <package>release-notes-ses</package> desde el repositorio de SES 7.1, encontrará las notas de la versión en el directorio <filename>/usr/share/doc/release-notes</filename> o en línea en <link xlink:href="https://www.suse.com/releasenotes/"/>.
     </para>
    </listitem>
    <listitem>
     <para>
      Lea el <xref linkend="ses-deployment"/> para familiarizarse con <systemitem class="resource">ceph-salt</systemitem> y Ceph Orchestrator y, en particular, con la información sobre las especificaciones de servicio.
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="upgrade-backup-config-data-7p">
   <title>Copia de seguridad de la configuración y los datos del clúster</title>
   <para>
    Se recomienda encarecidamente realizar una copia de seguridad de toda la configuración y los datos del clúster antes de iniciar la actualización. Para obtener instrucciones sobre cómo realizar copias de seguridad de todos los datos, consulte <xref linkend="cha-deployment-backup"/>.
   </para>
  </sect2>

  <sect2 xml:id="verify-previous-upgrade-patch-repos-7p">
   <title>Verificación del acceso a repositorios de software e imágenes de contenedor</title>
   <para>
    Verifique que cada nodo del clúster tenga acceso a los repositorios de software de SUSE Linux Enterprise Server 15 SP3 y SUSE Enterprise Storage 7.1, así como al registro de imágenes de contenedor.
   </para>
   <sect3 xml:id="verify-previous-upgrade-patch-repos-repos-7p">
    <title>Repositorios de software</title>
    <para>
     Si todos los nodos están registrados con SCC, podrá utilizar el comando <command>zypper migration</command> para actualizar. Consulte <link xlink:href="https://documentation.suse.com/sles/15-SP3/html/SLES-all/cha-upgrade-online.html#sec-upgrade-online-zypper"/> para obtener más información.
    </para>
    <para>
     Si los nodos <emphasis role="bold">no</emphasis> están registrados con SCC, inhabilite todos los repositorios de software existentes y añada los repositorios <literal>Repositorio</literal> y <literal>Actualizaciones</literal> para cada una de las extensiones siguientes:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       SLE-Product-SLES/15-SP3
      </para>
     </listitem>
     <listitem>
      <para>
       SLE-Module-Basesystem/15-SP3
      </para>
     </listitem>
     <listitem>
      <para>
       SLE-Module-Server-Applications/15-SP3
      </para>
     </listitem>
     <listitem>
      <para>
       SUSE-Enterprise-Storage-7.1
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="verify-previous-upgrade-patch-repos-images-7p">
    <title>Imágenes de contenedor</title>
    <para>
     Todos los nodos de clúster necesitan acceso al registro de imágenes de contenedor. En la mayoría de los casos, utilizará el registro público de SUSE situado en <literal>registration.suse.com</literal>. Necesitará las siguientes imágenes:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/ceph
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/grafana
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/prometheus-server
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/prometheus-node-exporter
      </para>
     </listitem>
     <listitem>
      <para>
       registry.suse.com/ses/7.1/ceph/prometheus-alertmanager
      </para>
     </listitem>
    </itemizedlist>
    <para>
     Como alternativa, por ejemplo para las distribuciones en entornos aislados, configure un registro local y verifique que tiene el conjunto correcto de imágenes de contenedor. Consulte la <xref linkend="deploy-cephadm-configure-registry"/> para obtener más información sobre cómo configurar un registro de imagen de contenedor local.
    </para>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="upgrade-cluster-nodes">
  <title>Migración de SUSE Linux Enterprise Server en cada nodo del clúster a la versión SUSE Linux Enterprise Server 15 SP3</title>

  <para>
   Si los nodos del clúster están configurados para utilizar el Centro de servicios al cliente de SUSE, puede utilizar el comando <command>zypper migration</command>.
  </para>

  <para>
   Si los nodos del clúster tienen repositorios de software configurados manualmente, deberá actualizar los nodos manualmente.
  </para>

  <para>
   Para obtener información detallada sobre la actualización de SUSE Linux Enterprise Server mediante <command>zypper</command>, consulte <link xlink:href="https://documentation.suse.com/sles/15-SP3/html/SLES-all/cha-upgrade-online.html#sec-upgrade-online-zypper"/>.
  </para>
 </sect1>
 <sect1 xml:id="upgrade-ses-packages">
  <title>Actualización de los paquetes relacionados con SUSE Enterprise Storage en cada nodo del clúster</title>

  <para>
   Para actualizar los paquetes de SUSE Enterprise Storage a la versión más reciente, utilice el comando <command>ceph-salt update</command>. Para obtener más información, consulte <xref linkend="cephadm-rolling-updates"/>.
  </para>
 </sect1>
 <sect1 xml:id="upgrade-ses-services">
  <title>Actualización de los servicios de clúster de Ceph existentes</title>

  <para>
   Lleve a cabo la actualización de todo el clúster de Ceph a la versión Pacific ejecutando el siguiente comando desde el nodo de administración:
  </para>

<screen><prompt>cephuser@adm &gt; </prompt>ceph orch upgrade start --image registry.suse.com/ses/7.1/ceph/ceph</screen>
 </sect1>
</chapter>
