<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ceph_iscsi.xml" version="5.0" xml:id="cha-ceph-iscsi">
 <title>Ceph iSCSI Gateway</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  O capítulo aborda especificamente as tarefas de administração relacionadas ao iSCSI Gateway. Para ver o procedimento de implantação, consulte o <xref linkend="deploy-cephadm-day2-service-igw"/>.
 </para>
 <sect1 xml:id="ceph-iscsi-connect">
  <title>Destinos gerenciados pelo <systemitem class="daemon">ceph-iscsi</systemitem></title>

  <para>
   Este capítulo descreve como se conectar a destinos gerenciados por <systemitem class="daemon">ceph-iscsi</systemitem> de clientes com Linux, Microsoft Windows ou VMware.
  </para>

  <sect2 xml:id="ceph-iscsi-connect-linux">
   <title>Conectando-se ao <systemitem>open-iscsi</systemitem></title>
   <para>
    A conexão com destinos iSCSI baseados em <systemitem class="daemon">ceph-iscsi</systemitem> por meio do <systemitem>open-iscsi</systemitem> é um processo de duas etapas. Primeiramente, o iniciador deve descobrir os destinos iSCSI disponíveis no host do gateway, depois ele deve efetuar login e mapear as LUs (Logical Units – Unidades Lógicas) disponíveis.
   </para>
   <para>
    As duas etapas exigem que o daemon <systemitem>open-iscsi</systemitem> esteja em execução. A maneira como você inicia o daemon <systemitem>open-iscsi</systemitem> depende da sua distribuição Linux:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      No SUSE Linux Enterprise Server (SLES) e nos hosts Red Hat Enterprise Linux (RHEL), execute <command>systemctl start iscsid</command> (ou <command>service iscsid start</command> se o <command>systemctl</command> não estiver disponível).
     </para>
    </listitem>
    <listitem>
     <para>
      Nos hosts do Debian e do Ubuntu, execute <command>systemctl start open-iscsi</command> (ou <command>service open-iscsi start</command>).
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Se o host do seu iniciador executa o SUSE Linux Enterprise Server, consulte <link xlink:href="https://documentation.suse.com/sles/15-SP1/single-html/SLES-storage/#sec-iscsi-initiator"/> para obter detalhes sobre como se conectar a um destino iSCSI.
   </para>
   <para>
    Para qualquer outra distribuição Linux com suporte a <systemitem>open-iscsi</systemitem>, prossiga para a descoberta de destinos no gateway <systemitem class="daemon">ceph-iscsi</systemitem>. Este exemplo usa iscsi1.example.com como endereço do portal. Para acesso de múltiplos caminhos, repita estas etapas com iscsi2.example.com:
   </para>
<screen><prompt role="root"># </prompt>iscsiadm -m discovery -t sendtargets -p iscsi1.example.com
192.168.124.104:3260,1 iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol</screen>
   <para>
    Em seguida, efetue login no portal. Se o login for concluído com êxito, quaisquer unidades lógicas baseadas em RBD no portal ficarão imediatamente disponíveis no barramento SCSI do sistema:
   </para>
<screen><prompt role="root"># </prompt>iscsiadm -m node -p iscsi1.example.com --login
Logging in to [iface: default, target: iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260] (multiple)
Login to [iface: default, target: iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260] successful.</screen>
   <para>
    Repita esse processo para outros endereços IP ou hosts do portal.
   </para>
   <para>
    Se o utilitário <systemitem>lsscsi</systemitem> estiver instalado no seu sistema, use-o para enumerar os dispositivos SCSI disponíveis no sistema:
   </para>
<screen>lsscsi
[8:0:0:0]    disk    SUSE     RBD              4.0   /dev/sde
[9:0:0:0]    disk    SUSE     RBD              4.0   /dev/sdf</screen>
   <para>
    Em uma configuração de múltiplos caminhos (em que dois dispositivos iSCSI conectados representam a mesma LU), você também pode examinar o estado do dispositivo de múltiplos caminhos com o utilitário <systemitem>multipath</systemitem>:
   </para>
<screen><prompt role="root"># </prompt>multipath -ll
360014050cf9dcfcb2603933ac3298dca dm-9 SUSE,RBD
size=49G features='0' hwhandler='0' wp=rw
|-+- policy='service-time 0' prio=1 status=active
| `- 8:0:0:0 sde 8:64 active ready running
`-+- policy='service-time 0' prio=1 status=enabled
`- 9:0:0:0 sdf 8:80 active ready running</screen>
   <para>
    Agora, você pode usar esse dispositivo de múltiplos caminhos como qualquer dispositivo de blocos. Por exemplo, você pode usá-lo como um Volume Físico para LVM (Logical Volume Management – Gerenciamento de Volumes Lógicos) Linux ou pode simplesmente criar um sistema de arquivos nele. O exemplo a seguir demonstra como criar um sistema de arquivos XFS no volume iSCSI de múltiplos caminhos recém-conectado:
   </para>
<screen><prompt role="root"># </prompt>mkfs -t xfs /dev/mapper/360014050cf9dcfcb2603933ac3298dca
log stripe unit (4194304 bytes) is too large (maximum is 256KiB)
log stripe unit adjusted to 32KiB
meta-data=/dev/mapper/360014050cf9dcfcb2603933ac3298dca isize=256    agcount=17, agsize=799744 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=0        finobt=0
data     =                       bsize=4096   blocks=12800000, imaxpct=25
         =                       sunit=1024   swidth=1024 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=0
log      =internal log           bsize=4096   blocks=6256, version=2
         =                       sectsz=512   sunit=8 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0</screen>
   <para>
    Como o XFS é um sistema de arquivos sem cluster, você apenas pode montá-lo em um único nó do iniciador iSCSI em determinado momento.
   </para>
   <para>
    Para descontinuar a qualquer momento o uso das LUs iSCSI associadas a determinado destino, execute o seguinte comando:
   </para>
<screen><prompt role="root"># </prompt>iscsiadm -m node -p iscsi1.example.com --logout
Logging out of session [sid: 18, iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260]
Logout of [sid: 18, target: iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260] successful.</screen>
   <para>
    Como ocorre com a descoberta e o login, você deve repetir as etapas de logout para todos os nomes de host ou endereços IP do portal.
   </para>
   <sect3 xml:id="ceph-iscsi-connect-linux-multipath">
    <title>Configurando múltiplos caminhos</title>
    <para>
     A configuração de múltiplos caminhos é mantida nos clientes ou iniciadores e não depende de nenhuma configuração de <systemitem class="daemon">ceph-iscsi</systemitem>. Selecione uma estratégia antes de usar o armazenamento em blocos. Após editar o <filename>/etc/multipath.conf</filename>, reinicie o <systemitem>multipathd</systemitem> com
    </para>
<screen><prompt role="root"># </prompt>systemctl restart multipathd</screen>
    <para>
     Para uma configuração ativa-passiva com nomes amigáveis, adicione
    </para>
<screen>defaults {
  user_friendly_names yes
}</screen>
    <para>
     ao <filename>/etc/multipath.conf</filename>. Após a conexão bem-sucedida com os destinos, execute
    </para>
<screen><prompt role="root"># </prompt>multipath -ll
mpathd (36001405dbb561b2b5e439f0aed2f8e1e) dm-0 SUSE,RBD
size=2.0G features='0' hwhandler='0' wp=rw
|-+- policy='service-time 0' prio=1 status=active
| `- 2:0:0:3 sdl 8:176 active ready running
|-+- policy='service-time 0' prio=1 status=enabled
| `- 3:0:0:3 sdj 8:144 active ready running
`-+- policy='service-time 0' prio=1 status=enabled
  `- 4:0:0:3 sdk 8:160 active ready running</screen>
    <para>
     Observe o status de cada link. Para uma configuração ativa-ativa, adicione
    </para>
<screen>defaults {
  user_friendly_names yes
}

devices {
  device {
    vendor "(LIO-ORG|SUSE)"
    product "RBD"
    path_grouping_policy "multibus"
    path_checker "tur"
    features "0"
    hardware_handler "1 alua"
    prio "alua"
    failback "immediate"
    rr_weight "uniform"
    no_path_retry 12
    rr_min_io 100
  }
}</screen>
    <para>
     ao <filename>/etc/multipath.conf</filename>. Reinicie o <systemitem>multipathd</systemitem> e execute
    </para>
<screen><prompt role="root"># </prompt>multipath -ll
mpathd (36001405dbb561b2b5e439f0aed2f8e1e) dm-3 SUSE,RBD
size=2.0G features='1 queue_if_no_path' hwhandler='1 alua' wp=rw
`-+- policy='service-time 0' prio=50 status=active
  |- 4:0:0:3 sdj 8:144 active ready running
  |- 3:0:0:3 sdk 8:160 active ready running
  `- 2:0:0:3 sdl 8:176 active ready running</screen>
   </sect3>
  </sect2>

  <sect2 xml:id="ceph-iscsi-connect-win">
   <title>Conectando-se ao Microsoft Windows (iniciador iSCSI para Microsoft)</title>
   <para>
    Para se conectar a um destino iSCSI do SUSE Enterprise Storage de um servidor Windows 2012, siga estas etapas:
   </para>
   <procedure>
    <step>
     <para>
      Abra o Gerenciador do Servidor Windows. No Painel de Controle, selecione <menuchoice><guimenu>Tools</guimenu><guimenu> (Ferramentas)iSCSI Initiator</guimenu></menuchoice> (Iniciador iSCSI). A caixa de diálogo <guimenu>iSCSI Initiator Properties</guimenu> (Propriedades do Iniciador iSCSI) é exibida. Selecione a guia <guimenu>Discovery</guimenu> (Descoberta):
     </para>
     <figure>
      <title>Propriedades do iniciador iSCSI</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-initiator-props.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-initiator-props.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Na caixa de diálogo <guimenu>Discover Target Portal</guimenu> (Descobrir Portal de Destino), insira o nome de host ou endereço IP do destino no campo <guimenu>Target</guimenu> (Destino) e clique em <guimenu>OK</guimenu>:
     </para>
     <figure>
      <title>Portal de descoberta de destino</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-target-ip.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-target-ip.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Repita esse processo para todos os outros nomes de host ou endereços IP do gateway. Ao concluir, revise a lista <guimenu>Target Portals</guimenu> (Portais de Destino):
     </para>
     <figure>
      <title>Portais de destino</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-target-ip-list.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-target-ip-list.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Em seguida, alterne para a guia <guimenu>Targets</guimenu> (Destinos) e revise o(s) destino(s) descoberto(s).
     </para>
     <figure>
      <title>Destinos</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-targets.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-targets.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Clique em <guimenu>Connect</guimenu> (Conectar) na guia <guimenu>Targets</guimenu> (Destinos). A caixa de diálogo <guimenu>Connect To Target</guimenu> (Conectar ao Destino) é exibida. Marque a caixa de seleção <guimenu>Enable Multi-path</guimenu> (Habilitar múltiplos caminhos) para habilitar a E/S de múltiplos caminhos (MPIO) e clique em <guimenu>OK</guimenu>:
     </para>
    </step>
    <step>
     <para>
      Quando a caixa de diálogo <guimenu>Connect to Target</guimenu> (Conectar ao Destino) for fechada, selecione <guimenu>Properties</guimenu> (Propriedades) para revisar as propriedades do destino:
     </para>
     <figure>
      <title>Propriedades do destino iSCSI</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-target-properties.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-target-properties.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Selecione <guimenu>Devices</guimenu> (Dispositivos) e clique em <guimenu>MPIO</guimenu> para revisar a configuração de E/S de múltiplos caminhos:
     </para>
     <figure>
      <title>Detalhes do dispositivo</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-device-details.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-device-details.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      A <guimenu>Load Balance policy</guimenu> (Política de Equilíbrio de Carga) padrão é <guimenu>Round Robin With Subset</guimenu> (Rodízio com Subconjunto). Se você preferir uma configuração exclusivamente de failover, mude-a para <guimenu>Fail Over Only</guimenu> (Somente Failover).
     </para>
    </step>
   </procedure>
   <para>
    Isso conclui a configuração do iniciador iSCSI. Agora, os volumes iSCSI estão disponíveis como qualquer outro dispositivo SCSI e podem ser inicializados para uso como volumes e unidades. Clique em <guimenu>OK</guimenu> para fechar a caixa de diálogo <guimenu>iSCSI Initiator Properties</guimenu> (Propriedades do Iniciador iSCSI) e prossiga com a função<guimenu> File and Storage Services</guimenu> (Serviços de Arquivo e Armazenamento) do painel de controle do <guimenu>Server Manager</guimenu> (Gerenciador do Servidor).
   </para>
   <para>
    Observe o volume recém-conectado. Ele é identificado como <emphasis>SUSE RBD SCSI Multi-Path Drive</emphasis> (Unidade de Múltiplos Caminhos SCSI Baseada em RBD SUSE) no barramento iSCSI e é inicialmente marcado com o status <emphasis>Offline</emphasis> e o tipo de tabela de partição <emphasis>Unknown</emphasis> (Desconhecido). Se o novo volume não aparecer imediatamente, selecione <guimenu>Rescan Storage</guimenu> (Explorar Armazenamento Novamente) na caixa suspensa <guimenu>Tasks</guimenu> (Tarefas) para explorar o barramento iSCSI novamente.
   </para>
   <procedure>
    <step>
     <para>
      Clique o botão direito do mouse no volume iSCSI e selecione <guimenu>New Volume</guimenu> (Novo Volume) no menu de contexto. O <guimenu>New Volume Wizard</guimenu> (Assistente de Novo Volume) é exibido. Clique em <guimenu>Next</guimenu> (Avançar), realce o volume iSCSI recém-conectado e clique em <guimenu>Next</guimenu> para começar.
     </para>
     <figure>
      <title>Assistente de novo volume</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-volume-wizard.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-volume-wizard.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Inicialmente, o dispositivo está vazio e não contém uma tabela de partição. Quando solicitado, confirme a caixa de diálogo indicando que o volume será inicializado com uma tabela de partição GPT:
     </para>
     <figure>
      <title>Prompt de disco offline</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-win-prompt1.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-win-prompt1.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Selecione o tamanho do volume. Normalmente, você usa a capacidade total do dispositivo. Em seguida, atribua uma letra de unidade ou nome de diretório no qual o volume recém-criado estará disponível. Na sequência, selecione um sistema de arquivos para criar no novo volume e, por fim, clique em <guimenu>Create</guimenu> (Criar) para confirmar suas seleções e concluir a criação do volume:
     </para>
     <figure>
      <title>Confirmar seleções de volume</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-volume-confirm.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-volume-confirm.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Quando o processo for concluído, revise os resultados e clique em <guimenu>Close</guimenu> (Fechar) para concluir a inicialização da unidade. Quando a inicialização for concluída, o volume (e o respectivo sistema de arquivos NTFS) ficará disponível como uma unidade local recém-inicializada.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="ceph-iscsi-connect-vmware">
   <title>Conectando-se ao VMware</title>
   <para/>
   <procedure>
    <step>
     <para>
      Para se conectar aos volumes iSCSI gerenciados por <systemitem class="daemon">ceph-iscsi</systemitem>, você precisa de um adaptador de software iSCSI configurado. Se não houver um adaptador desse tipo disponível na configuração do vSphere, crie um selecionando <menuchoice><guimenu>Configuration</guimenu><guimenu> (Configuração) Storage Adapters</guimenu> <guimenu> (Adaptadores de Armazenamento) Add</guimenu><guimenu> (Adicionar) iSCSI Software initiator</guimenu></menuchoice> (Iniciador de Software iSCSI).
     </para>
    </step>
    <step>
     <para>
      Quando disponível, selecione as propriedades do adaptador clicando o botão direito do mouse nele e selecionando <guimenu>Properties</guimenu> (Propriedades) no menu de contexto:
     </para>
     <figure>
      <title>Propriedades do iniciador iSCSI</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi_vmware_adapter_props.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi_vmware_adapter_props.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Na caixa de diálogo <guimenu>iSCSI Software Initiator</guimenu> (Iniciador de Software iSCSI), clique no botão <guimenu>Configure</guimenu> (Configurar). Em seguida, vá para a guia <guimenu>Dynamic Discovery</guimenu> (Descoberta Dinâmica) e selecione <guimenu>Add</guimenu> (Adicionar).
     </para>
    </step>
    <step>
     <para>
      Digite o endereço IP ou nome de host do seu gateway iSCSI <systemitem class="daemon">ceph-iscsi</systemitem>. Se você executa vários gateways iSCSI em uma configuração de failover, repita essa etapa para todos os gateways que você opera.
     </para>
     <figure>
      <title>Adicionar servidor de destino</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-add-target.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-add-target.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Após inserir todos os gateways iSCSI, clique em <guimenu>OK</guimenu> na caixa de diálogo para iniciar uma nova exploração do adaptador iSCSI.
     </para>
    </step>
    <step>
     <para>
      Quando a nova exploração for concluída, o novo dispositivo iSCSI aparecerá abaixo da lista <guimenu>Storage Adapters</guimenu> (Adaptadores de Armazenamento) no painel <guimenu>Details</guimenu> (Detalhes). Para dispositivos de múltiplos caminhos, agora você pode clicar o botão direito do mouse no adaptador e selecionar <guimenu>Manage Paths</guimenu> (Gerenciar Caminhos) no menu de contexto:
     </para>
     <figure>
      <title>Gerenciar dispositivos de múltiplos caminhos</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-multipath.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-multipath.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Você agora deve ver todos os caminhos com um ícone verde em <guimenu>Status</guimenu>. Um dos seus caminhos deve estar marcado como <guimenu>Active (I/O)</guimenu> (Ativo (E/S)), e todos os outros apenas como <guimenu>Active</guimenu> (Ativo):
     </para>
     <figure>
      <title>Listagem de caminhos para múltiplos caminhos</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-paths.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-paths.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Agora, você pode alternar de <guimenu>Storage Adapters</guimenu> (Adaptadores de Armazenamento) para o item denominado <guimenu>Storage</guimenu> (Armazenamento). Selecione <guimenu>Add Storage...</guimenu> (Adicionar Armazenamento) no canto superior direito do painel para exibir a caixa de diálogo <guimenu>Add Storage</guimenu> (Adicionar Armazenamento). Em seguida, selecione <guimenu>Disk/LUN</guimenu> (Disco/LUN) e clique em <guimenu>Next</guimenu> (Avançar). O dispositivo iSCSI recém-adicionado aparece na lista <guimenu>Select Disk/LUN</guimenu> (Selecionar Disco/LUN). Selecione-o e, em seguida, clique em <guimenu>Next</guimenu> (Avançar) para continuar:
     </para>
     <figure>
      <title>Caixa de diálogo de adição de armazenamento</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-add-storage-dialog.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-add-storage-dialog.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Clique em <guimenu>Next</guimenu> (Avançar) para aceitar o layout de disco padrão.
     </para>
    </step>
    <step>
     <para>
      No painel <guimenu>Properties</guimenu> (Propriedades), atribua um nome ao novo armazenamento de dados e clique em <guimenu>Next</guimenu> (Avançar). Aceite a configuração padrão para usar todo o espaço do volume para o armazenamento de dados ou selecione <guimenu>Custom Space Setting</guimenu> (Configuração Personalizada de Espaço) para um armazenamento de dados menor:
     </para>
     <figure>
      <title>Configuração personalizada de espaço</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-custom-datastore.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-custom-datastore.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Clique em <guimenu>Finish</guimenu> (Concluir) para concluir a criação do armazenamento de dados.
     </para>
     <para>
      Agora, o novo armazenamento de dados aparece na lista de armazenamentos de dados, e você pode selecioná-lo para recuperar os detalhes. Agora, você pode usar o volume iSCSI baseado em <systemitem class="daemon">ceph-iscsi</systemitem> como qualquer outro armazenamento de dados vSphere.
     </para>
     <figure>
      <title>Visão geral do armazenamento de dados iSCSI</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-overview.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-overview.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="ceph-iscsi-conclude">
  <title>Conclusão</title>

  <para>
   <systemitem class="daemon">ceph-iscsi</systemitem> é um componente fundamental do SUSE Enterprise Storage 7.1 que concede acesso a armazenamento em blocos distribuído e altamente disponível de qualquer servidor ou cliente que reconheça o protocolo iSCSI. Ao usar o <systemitem class="daemon">ceph-iscsi</systemitem> em um ou mais hosts do iSCSI Gateway, as imagens RBD do Ceph tornam-se disponíveis como Unidades Lógicas (LUs, Logical Units) associadas a destinos iSCSI, que podem ser acessados com equilíbrio de carga e alta disponibilidade.
  </para>

  <para>
   Como a configuração de todos os <systemitem class="daemon">ceph-iscsi</systemitem> é inserida no armazenamento de objetos RADOS do Ceph, os hosts do gateway <systemitem class="daemon">ceph-iscsi</systemitem> são inerentemente sem estado persistente e, portanto, podem ser substituídos, aumentados ou reduzidos conforme desejado. Como resultado, o SUSE Enterprise Storage 7.1 permite que os clientes SUSE executem uma tecnologia de armazenamento empresarial verdadeiramente distribuída, altamente disponível, resiliente e autorreparável em um hardware convencional e em uma plataforma totalmente de código-fonte aberto.
  </para>
 </sect1>
</chapter>
