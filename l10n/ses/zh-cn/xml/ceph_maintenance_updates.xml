<?xml version="1.0" encoding="UTF-8"?>
<appendix xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_maintenance_updates.xml" version="5.0">
 <title>基于上游“Octopus”小版本的 Ceph 维护更新</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>是</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  SUSE Enterprise Storage 7 中的几个关键的包均基于 Ceph 的 Octopus 版本系列。当 Ceph 项目 (<link xlink:href="https://github.com/ceph/ceph"/>) 在 Octopus 系列中发布新的小版本时，SUSE Enterprise Storage 7 即会更新，以确保产品应用最新的上游 Bug 修复并可进行功能向后移植。
 </para>
 <para>
  本章简要介绍有关已经或计划在产品中包含的每个上游小版本中的重要更改。
 </para>
 <bridgehead renderas="sect1">Octopus 15.2.5 小版本</bridgehead>
 <para>
  Octopus 15.2.5 小版本引入了以下修复和其他更改：
 </para>
 <itemizedlist>
  <listitem>
   <para>
    CephFS：现在可以使用目录上新的分布式和随机暂时关联扩展属性来配置自动静态子树分区策略。有关详细信息，请参见以下文档：<link xlink:href="https://docs.ceph.com/docs/master/cephfs/multimds/"/>
   </para>
  </listitem>
  <listitem>
   <para>
    Monitor 现有一个配置选项 <option>mon_osd_warn_num_repaired</option>，该选项默认设置为 10。如果任何 OSD 修复的存储数据中的 I/O 错误数超过此数量，则会生成 <literal>OSD_TOO_MANY_REPAIRS</literal> 健康状况警报。
   </para>
  </listitem>
  <listitem>
   <para>
    现在，如果在全局或在存储池级别设置了 <literal>no scrub</literal> 和/或 <literal>no deep-scrub</literal> 标志，将中止已禁用类型的安排洗刷。所有用户启动的洗刷将不会中断。
   </para>
  </listitem>
  <listitem>
   <para>
    修复了在运行状况良好的集群中不会修剪 osdmaps 的问题。
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Octopus 15.2.4 小版本</bridgehead>
 <para>
  Octopus 15.2.4 小版本引入了以下修复和其他更改：
 </para>
 <itemizedlist>
  <listitem>
   <para>
    CVE-2020-10753：rgw: 清理 s3 CORSConfiguration 的 ExposeHeader 中的换行符
   </para>
  </listitem>
  <listitem>
   <para>
    对象网关：处理孤立的 <command>radosgw-admin</command> 子命令（<command>radosgw-admin orphans find</command>、<command>radosgw-admin orphans finish</command> 和 <command>radosgw-admin orphans list-jobs</command>）已被弃用。并不会主动维护这些子命令，并且由于它们会在集群上存储中间结果，因此可能会填充几乎已满的集群。这些子命令已被工具 <command>rgw-orphan-list</command> 所替代，该工具当前被视为是实验性工具。
   </para>
  </listitem>
  <listitem>
   <para>
    RBD：用于存储 RBD 回收站清除日程安排的 RBD 存储池对象的名称已由 <literal>rbd_trash_trash_purge_schedule</literal> 更改为 <literal>rbd_trash_purge_schedule</literal>。已开始使用 RBD 回收站清除日程安排功能并配置了每个存储池或名称空间日程安排的用户，应在升级前将 <literal>rbd_trash_trash_purge_schedule</literal> 对象复制到 <literal>rbd_trash_purge_schedule</literal>，并在之前配置了回收站清除日程安排的每个 RBD 存储池和名称空间中使用以下命令删除 <literal>rbd_trash_purge_schedule</literal>：
   </para>
<screen>
rados -p <replaceable>pool-name</replaceable> [-N namespace] cp rbd_trash_trash_purge_schedule rbd_trash_purge_schedule
rados -p <replaceable>pool-name</replaceable> [-N namespace] rm rbd_trash_trash_purge_schedule
</screen>
   <para>
    或者，使用任何其他简便方法在升级后恢复日程安排。
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Octopus 15.2.3 小版本</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    Octopus 15.2.3 小版本是一个热修复版本，用于解决在同时启用 <option>bluefs_preextend_wal_files</option> 和 <option>bluefs_buffered_io</option> 时发生的 WAL 损坏问题。15.2.3 中的修复只是一种临时措施（将 <option>bluefs_preextend_wal_files</option> 的默认值更改为 <literal>false</literal>）。永久性的修复将是完全删除 <option>bluefs_preextend_wal_files</option> 选项：此修复很可能会在 15.2.6 小版本中实现。
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Octopus 15.2.2 小版本</bridgehead>
 <para>
  Octopus 15.2.2 小版本修补了一个安全漏洞：
 </para>
 <itemizedlist>
  <listitem>
   <para>
    CVE-2020-10736：修复了 MON 和 MGR 中的授权绕过问题
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Octopus 15.2.1 小版本</bridgehead>
 <para>
  Octopus 15.2.1 小版本修复了从 Luminous (SES5.5) 到 Nautilus (SES6) 再到 Octopus (SES7) 的快速升级导致 OSD 崩溃的问题。此外，它还修补了 Octopus (15.2.0) 初始版本中存在的两个安全漏洞：
 </para>
 <itemizedlist>
  <listitem>
   <para>
    CVE-2020-1759：修复了 msgrv2 安全模式下的 nonce 重复使用
   </para>
  </listitem>
  <listitem>
   <para>
    CVE-2020-1760：修复了由于 RGW GetObject 报头拆分而导致的 XSS
   </para>
  </listitem>
 </itemizedlist>
</appendix>
