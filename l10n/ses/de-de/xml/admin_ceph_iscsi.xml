<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ceph_iscsi.xml" version="5.0" xml:id="cha-ceph-iscsi">
 <title>Ceph iSCSI Gateway</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  In diesem Kapitel befassen wir uns hauptsächlich mit Verwaltungsaufgaben, die für das iSCSI Gateway relevant sind. Das Verfahren zur Bereitstellung wird im <xref linkend="deploy-cephadm-day2-service-igw"/> erläutert. 
 </para>
 <sect1 xml:id="ceph-iscsi-connect">
  <title>Mit <systemitem class="daemon">ceph-iscsi</systemitem> verwaltete Ziele</title>

  <para>
   In diesem Kapitel wird erläutert, wie Sie eine Verbindung zu <systemitem class="daemon">ceph-iscsi</systemitem>-verwalteten Zielen von Clients aus herstellen, auf denen Linux, Microsoft Windows oder VMware ausgeführt wird.
  </para>

  <sect2 xml:id="ceph-iscsi-connect-linux">
   <title>Herstellen einer Verbindung mit <systemitem>open-iscsi</systemitem></title>
   <para>
    Die Herstellung einer Verbindung zu <systemitem class="daemon">ceph-iscsi</systemitem>-gestützten iSCSI-Zielen mit <systemitem>open-iscsi</systemitem> erfolgt in zwei Schritten. Zunächst muss der Initiator die iSCSI-Ziele ermitteln, die am Gateway-Host verfügbar sind. Dann muss er sich anmelden und die verfügbaren logischen Einheiten (Logical Unit, LU) zuordnen.
   </para>
   <para>
    Für beide Schritte muss der <systemitem>open-iscsi</systemitem>-Daemon aktiv sein. Die Art und Weise, wie Sie den <systemitem>open-iscsi</systemitem>-Daemon starten, hängt von Ihrer Linux-Distribution ab:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Führen Sie auf SUSE Linux Enterprise Server (SLES)- und Red Hat Enterprise Linux (RHEL)-Hosts <command>systemctl start iscsid</command> aus (oder <command>service iscsid start</command>, falls <command>systemctl</command> nicht verfügbar ist).
     </para>
    </listitem>
    <listitem>
     <para>
      Führen Sie auf Debian- und Ubuntu-Hosts <command>systemctl start open-iscsi</command> aus (oder <command>service open-iscsi start</command>).
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Wenn Ihr Initiator-Host SUSE Linux Enterprise Server ausführt, sehen Sie sich die detaillierten Informationen unter <link xlink:href="https://documentation.suse.com/sles/15-SP1/single-html/SLES-storage/#sec-iscsi-initiator"/> an, um zu erfahren, wie Sie eine Verbindung zu einem iSCSI-Ziel herstellen.
   </para>
   <para>
    Fahren Sie bei allen anderen Linux-Distributionen, die <systemitem>open-iscsi</systemitem> unterstützen, damit fort, Ziele in Ihrem <systemitem class="daemon">ceph-iscsi</systemitem>-Gateway zu ermitteln (in diesem Beispiel verwenden wir „iscsi1.example.com“ als Portaladresse. Wiederholen Sie für einen Multipfadzugriff diese Schritte mit „iscsi2.example.com“):
   </para>
<screen><prompt role="root"># </prompt>iscsiadm -m discovery -t sendtargets -p iscsi1.example.com
192.168.124.104:3260,1 iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol</screen>
   <para>
    Melden Sie sich dann beim Portal an. Nach erfolgreicher Anmeldung stehen sofort alle RBD-unterstützten logischen Einheiten auf dem Portal im System SCSI-Bus zur Verfügung:
   </para>
<screen><prompt role="root"># </prompt>iscsiadm -m node -p iscsi1.example.com --login
Logging in to [iface: default, target: iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260] (multiple)
Login to [iface: default, target: iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260] successful.</screen>
   <para>
    Wiederholen Sie diesen Vorgang für andere Portal-IP-Adressen oder Hosts.
   </para>
   <para>
    Wenn auf Ihrem System das Dienstprogramm <systemitem>lsscsi</systemitem> installiert ist, zählen Sie damit die verfügbaren SCSI-Geräte auf Ihrem System auf:
   </para>
<screen>lsscsi
[8:0:0:0]    disk    SUSE     RBD              4.0   /dev/sde
[9:0:0:0]    disk    SUSE     RBD              4.0   /dev/sdf</screen>
   <para>
    In einer Multipfadkonfiguration (bei der zwei verbundene iSCSI-Geräte ein und dieselbe logische Einheit darstellen) können Sie auch den Zustand des Multipfadgeräts mit dem Dienstprogramm <systemitem>multipath</systemitem> untersuchen:
   </para>
<screen><prompt role="root"># </prompt>multipath -ll
360014050cf9dcfcb2603933ac3298dca dm-9 SUSE,RBD
size=49G features='0' hwhandler='0' wp=rw
|-+- policy='service-time 0' prio=1 status=active
| `- 8:0:0:0 sde 8:64 active ready running
`-+- policy='service-time 0' prio=1 status=enabled
`- 9:0:0:0 sdf 8:80 active ready running</screen>
   <para>
    Daraufhin kann dieses Multipfadgerät wie jedes andere Blockgerät verwendet werden. Sie können dieses Gerät beispielsweise als physisches Volume für Linux Logical Volume Management (LVM) verwenden oder einfach darauf ein Dateisystem erstellen. Im folgenden Beispiel sehen Sie, wie ein XFS-Dateisystem auf dem neu verbundenen Multipfad-iSCSI-Volume erstellt wird:
   </para>
<screen><prompt role="root"># </prompt>mkfs -t xfs /dev/mapper/360014050cf9dcfcb2603933ac3298dca
log stripe unit (4194304 bytes) is too large (maximum is 256KiB)
log stripe unit adjusted to 32KiB
meta-data=/dev/mapper/360014050cf9dcfcb2603933ac3298dca isize=256    agcount=17, agsize=799744 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=0        finobt=0
data     =                       bsize=4096   blocks=12800000, imaxpct=25
         =                       sunit=1024   swidth=1024 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=0
log      =internal log           bsize=4096   blocks=6256, version=2
         =                       sectsz=512   sunit=8 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0</screen>
   <para>
    Beachten Sie, dass XFS ein nicht geclustertes Dateisystem ist und daher zu einem gegebenen Zeitpunkt nur auf einem einzelnen iSCSI-Initiator eingehängt werden darf.
   </para>
   <para>
    Führen Sie folgendes Kommando aus, wenn Sie die mit einem bestimmten Ziel verknüpften iSCSI-LUs irgendwann nicht mehr weiter verwenden möchten:
   </para>
<screen><prompt role="root"># </prompt>iscsiadm -m node -p iscsi1.example.com --logout
Logging out of session [sid: 18, iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260]
Logout of [sid: 18, target: iqn.2003-01.org.linux-iscsi.iscsi.<replaceable>SYSTEM-ARCH</replaceable>:testvol, portal: 192.168.124.104,3260] successful.</screen>
   <para>
    Bei der Ermittlung und Anmeldung müssen Sie die Abmeldeschritte für alle Portal-IP-Adressen oder Hostnamen wiederholen.
   </para>
   <sect3 xml:id="ceph-iscsi-connect-linux-multipath">
    <title>Multipfadkonfiguration</title>
    <para>
     Die Multipfadkonfiguration wird auf den Clients oder Initiatoren beibehalten und ist unabhängig von anderen <systemitem class="daemon">ceph-iscsi</systemitem>-Konfigurationen. Wählen Sie vor Verwendung der Blockspeicherung eine Strategie aus. Starten Sie nach dem Bearbeiten der Datei <filename>/etc/multipath.conf</filename> die Option <systemitem>multipathd</systemitem> neu mit
    </para>
<screen><prompt role="root"># </prompt>systemctl restart multipathd</screen>
    <para>
     Fügen Sie für eine Aktiv/Passiv-Konfiguration mit Anzeigenamen
    </para>
<screen>defaults {
  user_friendly_names yes
}</screen>
    <para>
     zu Ihrer Datei <filename>/etc/multipath.conf</filename> hinzu. Führen Sie nach erfolgreicher Herstellung einer Verbindung zu den Zielen folgendes Kommando aus:
    </para>
<screen><prompt role="root"># </prompt>multipath -ll
mpathd (36001405dbb561b2b5e439f0aed2f8e1e) dm-0 SUSE,RBD
size=2.0G features='0' hwhandler='0' wp=rw
|-+- policy='service-time 0' prio=1 status=active
| `- 2:0:0:3 sdl 8:176 active ready running
|-+- policy='service-time 0' prio=1 status=enabled
| `- 3:0:0:3 sdj 8:144 active ready running
`-+- policy='service-time 0' prio=1 status=enabled
  `- 4:0:0:3 sdk 8:160 active ready running</screen>
    <para>
     Beachten Sie den Status der einzelnen Links. Fügen Sie für eine Aktiv/Aktiv-Konfiguration
    </para>
<screen>defaults {
  user_friendly_names yes
}

devices {
  device {
    vendor "(LIO-ORG|SUSE)"
    product "RBD"
    path_grouping_policy "multibus"
    path_checker "tur"
    features "0"
    hardware_handler "1 alua"
    prio "alua"
    failback "immediate"
    rr_weight "uniform"
    no_path_retry 12
    rr_min_io 100
  }
}</screen>
    <para>
     zu Ihrer Datei <filename>/etc/multipath.conf</filename> hinzu. Starten Sie <systemitem>multipathd</systemitem> neu und führen Sie folgendes Kommando aus:
    </para>
<screen><prompt role="root"># </prompt>multipath -ll
mpathd (36001405dbb561b2b5e439f0aed2f8e1e) dm-3 SUSE,RBD
size=2.0G features='1 queue_if_no_path' hwhandler='1 alua' wp=rw
`-+- policy='service-time 0' prio=50 status=active
  |- 4:0:0:3 sdj 8:144 active ready running
  |- 3:0:0:3 sdk 8:160 active ready running
  `- 2:0:0:3 sdl 8:176 active ready running</screen>
   </sect3>
  </sect2>

  <sect2 xml:id="ceph-iscsi-connect-win">
   <title>Herstellen einer Verbindung zu Microsoft Windows (Microsoft iSCSI-Initiator)</title>
   <para>
    Führen Sie zum Herstellen einer Verbindung zum SUSE Enterprise Storage iSCSI-Ziel auf einem Windows 2012 Server folgende Schritte aus:
   </para>
   <procedure>
    <step>
     <para>
      Öffnen Sie Windows Server Manager. Wählen Sie am Desktop <menuchoice><guimenu>Tools</guimenu><guimenu>iSCSI-Initiator</guimenu></menuchoice> aus. Das Dialogfeld <guimenu>iSCSI Initiator Properties</guimenu> (iSCSI-Initiator-Eigenschaften) wird angezeigt. Wählen Sie die Registerkarte <guimenu>Ermittlung</guimenu> aus:
     </para>
     <figure>
      <title>Eigenschaften des iSCSI-Initiators</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-initiator-props.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-initiator-props.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Geben Sie im Dialogfeld <guimenu>Zielportal ermitteln</guimenu> den Hostnamen oder die IP-Adresse im Feld <guimenu>Ziel</guimenu> ein und klicken Sie auf <guimenu>OK</guimenu>:
     </para>
     <figure>
      <title>Zielportal ermitteln</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-target-ip.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-target-ip.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Wiederholen Sie diesen Vorgang für alle Gateway-Hostnamen oder IP-Adressen. Überprüfen Sie nach Fertigstellung die Liste <guimenu>Zielportale</guimenu>:
     </para>
     <figure>
      <title>Zielportale</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-target-ip-list.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-target-ip-list.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Wechseln Sie anschließend zur Registerkarte <guimenu>Ziele</guimenu> und prüfen Sie die ermittelten Ziele.
     </para>
     <figure>
      <title>Zielgruppen</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-targets.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-targets.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Klicken Sie auf <guimenu>Verbinden</guimenu> auf der Registerkarte <guimenu>Ziele</guimenu>. Das Dialogfeld <guimenu>Mit Ziel verbinden</guimenu> wird angezeigt. Aktivieren Sie das Kontrollkästchen für <guimenu>Multipfad aktivieren</guimenu>, um die Multipfad-E/A (MPIO) zu aktivieren und klicken Sie anschließend auf <guimenu>OK</guimenu>:
     </para>
    </step>
    <step>
     <para>
      Wenn das Dialogfeld <guimenu>Mit Ziel verbinden</guimenu> geschlossen wird, wählen Sie <guimenu>Eigenschaften</guimenu> aus, um die Eigenschaften des Ziels zu prüfen:
     </para>
     <figure>
      <title>Eigenschaften des iSCSI-Ziels</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-target-properties.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-target-properties.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Wählen Sie <guimenu>Geräte</guimenu> aus und klicken Sie auf <guimenu>MPIO</guimenu>, um die Multipath-Konfiguration zu überprüfen:
     </para>
     <figure>
      <title>Gerätedetails</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-device-details.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-device-details.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Die standardmäßige <guimenu>Lastausgleichrichtlinie</guimenu> ist <guimenu>Round-Robin mit Teilmenge</guimenu>. Wenn Sie eine reine Failover-Konfiguration bevorzugen, ändern Sie die Einstellung zu <guimenu>Nur Failover</guimenu>.
     </para>
    </step>
   </procedure>
   <para>
    Damit ist die iSCSI-Initiator-Konfiguration abgeschlossen. Die iSCSI-Volumes sind nun verfügbar wie alle anderen SCSI-Geräte und können zur Verwendung als Volumes und Laufwerke initialisiert werden. Klicken Sie auf <guimenu>OK</guimenu>, um das Dialogfeld <guimenu>Eigenschaften des iSCSI-Initiators</guimenu> zu schließen und fahren Sie mit der Rolle <guimenu>Datei- und Speicherdienste</guimenu> am <guimenu>Server Manager</guimenu>-Dashboard fort.
   </para>
   <para>
    Beobachten Sie das neu verbundene Volume. Es ist am iSCSI-Bus als <emphasis>SUSE RBD SCSI-Multipfadlaufwerk</emphasis> gekennzeichnet. Es ist zu Beginn mit einem <emphasis>Offline</emphasis>-Status markiert und einem Partitionstabellentyp <emphasis>Unbekannt</emphasis>. Wenn das neue Volume nicht sofort angezeigt wird, wählen Sie <guimenu>Speicher neu absuchen</guimenu> aus dem Dropdown-Feld <guimenu>Aufgaben</guimenu> aus, um den iSCSI-Bus neu abzusuchen.
   </para>
   <procedure>
    <step>
     <para>
      Klicken Sie mit der rechten Maustaste auf das iSCSI-Volume und wählen Sie im Kontextmenü <guimenu>Neues Volume</guimenu> aus. Der <guimenu>Assistent für neue Volumes</guimenu> wird angezeigt. Klicken Sie auf <guimenu>Weiter</guimenu>, heben Sie das neu verbundene iSCSI-Volume hervor und klicken Sie auf <guimenu>Weiter</guimenu>, um zu beginnen.
     </para>
     <figure>
      <title>Assistent für neue Volumes</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-volume-wizard.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-volume-wizard.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Zu Beginn ist das Gerät leer und enthält keine Partitionstabelle. Wenn Sie dazu aufgefordert werden, bestätigen Sie den Dialog und geben Sie an, dass das Volume mit einer GPT-Partitionstabelle initialisiert wird:
     </para>
     <figure>
      <title>Eingabeaufforderung für Offline-Datenträger</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-win-prompt1.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-win-prompt1.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Wählen Sie die Volume-Größe aus. Normalerweise würden Sie die volle Kapazität des Geräts nutzen. Weisen Sie in diesem Fall einen Laufwerkbuchstaben oder Verzeichnisnamen zu, in dem das neu erstellte Volumen verfügbar sein soll. Wählen Sie dann ein Dateisystem aus, das am neuen Volume erstellt werden soll. Bestätigen Sie schließlich Ihre Auswahl mit <guimenu>Erstellen</guimenu>, um die Erstellung des Volumes abzuschließen:
     </para>
     <figure>
      <title>Volume-Auswahl bestätigen</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-volume-confirm.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-volume-confirm.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Überprüfen Sie die Ergebnisse nach Abschluss des Vorgangs, klicken Sie dann auf <guimenu>Schließen</guimenu>, um die Laufwerkinitialisierung abzuschließen. Nach Abschluss der Initialisierung steht das Volume (und dessen NTFS-Dateisystem) wie ein neu initialisiertes lokales Laufwerk zur Verfügung.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="ceph-iscsi-connect-vmware">
   <title>Herstellen einer Verbindung zu VMware</title>
   <para/>
   <procedure>
    <step>
     <para>
      Sie benötigen zur Herstellung einer Verbindung zu <systemitem class="daemon">ceph-iscsi</systemitem>-verwalteten iSCSI-Volumen einen konfigurierten iSCSI-Softwareadapter. Wenn in Ihrer vSphere-Konfiguration kein derartiger Adapter verfügbar ist, erstellen Sie einen Adapter, indem Sie die Optionsfolge <menuchoice><guimenu>Configuration (Konfiguration)</guimenu><guimenu>Storage Adapters (Speicheradapter)</guimenu> <guimenu>Add (Hinzufügen)</guimenu><guimenu>iSCSI Software initiator (iSCSI-Software-Initiator)</guimenu></menuchoice> auswählen.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie die Eigenschaften des Adapters aus, falls verfügbar. Klicken Sie dazu mit der rechten Maustaste auf den Adapter und wählen Sie im Kontextmenü die Option <guimenu>Eigenschaften</guimenu> aus:
     </para>
     <figure>
      <title>Eigenschaften des iSCSI-Initiators</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi_vmware_adapter_props.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi_vmware_adapter_props.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Klicken Sie im Dialogfeld <guimenu>iSCSI Software Initiator</guimenu> (iSCSI-Software-Initiator) auf die Schaltfläche <guimenu>Configure</guimenu> (Konfigurieren). Gehen Sie dann zur Registerkarte <guimenu>Dynamic Discovery</guimenu> (Dynamische Ermittlung) und wählen Sie <guimenu>Add</guimenu> (Hinzufügen) aus.
     </para>
    </step>
    <step>
     <para>
      Geben Sie die IP-Adresse oder den Hostnamen Ihres <systemitem class="daemon">ceph-iscsi</systemitem>-iSCSI-Gateways ein. Wenn Sie mehrere iSCSI-Gateways in einer Failover-Konfiguration ausführen, wiederholen Sie diesen Schritt für alle vorhandenen Gateways.
     </para>
     <figure>
      <title>Zielserver hinzufügen</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-add-target.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-add-target.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Klicken Sie nach Eingabe aller iSCSI-Gateways im Dialogfeld auf <guimenu>OK</guimenu>, um eine erneute Absuche des iSCSI-Adapters zu initiieren.
     </para>
    </step>
    <step>
     <para>
      Nach Abschluss der Neuabsuche wird das neue iSCSI-Gerät unterhalb der Liste <guimenu>Storage Adapters</guimenu> (Speicheradapter) im Fensterbereich <guimenu>Details</guimenu> angezeigt. Für Multipfadgeräte können Sie nun mit der rechten Maustaste auf den Adapter klicken und im Kontextmenü <guimenu>Manage Paths</guimenu> (Pfade verwalten) auswählen:
     </para>
     <figure>
      <title>Multipfadgeräte verwalten</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-multipath.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-multipath.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Sie sollten nun alle Pfade mit einer grünen Anzeige unter <guimenu>Status</guimenu> sehen. Einer Ihrer Pfade sollte mit <guimenu>Active (I/O)</guimenu> (Aktiv (E/A)) gekennzeichnet sein und alle anderen einfach mit <guimenu>Active</guimenu> (Aktiv):
     </para>
     <figure>
      <title>Auflistung der Pfade für Multipfad</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-paths.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-paths.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Sie können nun von <guimenu>Storage Adapters</guimenu> (Speicheradapter) zum Element mit dem Label <guimenu>Storage</guimenu> (Speicher) wechseln. Wählen Sie oben rechts im Fensterbereich <guimenu>Add Storage...</guimenu> (Speicher hinzufügen...) aus, um das Dialogfeld <guimenu>Add Storage</guimenu> (Speicher hinzufügen) zu öffnen. Wählen Sie dann <guimenu>Disk/LUN</guimenu> (Datenträger/LUN) aus und klicken Sie auf <guimenu>Weiter</guimenu>. Das neu hinzugefügte iSCSI-Gerät erscheint in der Liste <guimenu>Select Disk/LUN</guimenu> (Datenträger/LUN auswählen). Wählen Sie es aus und klicken Sie dann auf <guimenu>Weiter</guimenu>, um fortzufahren:
     </para>
     <figure>
      <title>Dialogfeld „Speicher hinzufügen“</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-add-storage-dialog.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-add-storage-dialog.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Klicken Sie auf <guimenu>Weiter</guimenu>, um das standardmäßige Datenträger-Layout zu übernehmen.
     </para>
    </step>
    <step>
     <para>
      Weisen Sie im Fensterbereich <guimenu>Eigenschaften</guimenu> der neuen Datenablage einen Namen zu und klicken Sie auf <guimenu>Weiter</guimenu>. Akzeptieren Sie die Standardeinstellung zur Verwendung des gesamten Speicherplatzes des Volumes für die Datenablage oder wählen Sie <guimenu>Custom Space Setting</guimenu> (Benutzerdefinierte Speicherplatzeinstellung) für eine kleinere Datenablage aus:
     </para>
     <figure>
      <title>Benutzerdefinierte Speicherplatzeinstellung</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-custom-datastore.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-custom-datastore.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Klicken Sie auf <guimenu>Finish</guimenu> (Fertig stellen), um die Erstellung der Datenablage abzuschließen.
     </para>
     <para>
      Die neue Datenablage wird nun in der Datenablageliste angezeigt. Wählen Sie sie aus, um die Details abzurufen. Nun sind Sie in der Lage, das <systemitem class="daemon">ceph-iscsi</systemitem>-unterstützte iSCSI-Volume wie jede andere vSphere-Datenablage zu verwenden.
     </para>
     <figure>
      <title>Überblick zur iSCSI-Datenablage</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="iscsi-vmware-overview.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="iscsi-vmware-overview.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="ceph-iscsi-conclude">
  <title>Fazit</title>

  <para>
   <systemitem class="daemon">ceph-iscsi</systemitem> ist eine Schlüsselkomponente von SUSE Enterprise Storage 7.1, die den Zugriff auf dezentrale, hochverfügbare Blockspeicher von jedem Server oder Client aus ermöglicht, der das iSCSI-Protokoll versteht. Durch Verwendung von <systemitem class="daemon">ceph-iscsi</systemitem> auf mindestens einem iSCSI-Gateway-Host werden Ceph RBD-Images als logische Einheiten (Logical Units, LUs) verfügbar, die mit iSCSI-Zielen verknüpft sind. Auf diese kann auf optional lastausgeglichene, hochverfügbare Weise zugegriffen werden.
  </para>

  <para>
   Da die gesamte Konfiguration von <systemitem class="daemon">ceph-iscsi</systemitem> im Ceph RADOS-Objektspeicher gespeichert ist, weisen <systemitem class="daemon">ceph-iscsi</systemitem>-Gateway-Hosts von Natur aus keinen dauerhaften Zustand auf und können daher nach Belieben ersetzt, verbessert oder reduziert werden. SUSE Enterprise Storage 7.1 ermöglicht es SUSE-Kunden folglich, eine echte dezentrale, hochverfügbare, stabile und selbstreparierende Unternehmensspeichertechnologie auf frei erhältlicher Hardware und einer Open Source-Plattform auszuführen.
  </para>
 </sect1>
</chapter>
