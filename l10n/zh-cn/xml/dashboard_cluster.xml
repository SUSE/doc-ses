<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="dashboard_cluster.xml" version="5.0" xml:id="dashboard-cluster">
 <title>查看集群内部</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>是</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <para>
  您可以通过<guimenu>集群</guimenu>菜单项查看有关 Ceph 集群主机、库存、Ceph Monitor、服务、OSD、配置、CRUSH 索引、Ceph Manager、日志和监控文件的详细信息。
 </para>
 <sect1 xml:id="dashboard-cluster-hosts">
  <title>查看集群节点</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>主机</guimenu></menuchoice>可查看集群节点列表。
  </para>

  <figure>
   <title>主机</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_hosts.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_hosts.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   点击<guimenu>主机名</guimenu>列中某个节点名称旁的下拉箭头可查看节点的性能详细信息。
  </para>

  <para>
   <guimenu>服务</guimenu>列中会列出每个相关节点上正在运行的所有守护进程。点击守护进程名称可查看其详细配置。
  </para>
 </sect1>
 <sect1 xml:id="dashboard-cluster-inventory">
  <title>访问集群库存</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>库存</guimenu></menuchoice>可查看设备列表。该列表包含设备路径、类型、可用性、供应商、型号、大小和 OSD。
  </para>

  <para>
   点击以在<guimenu>主机名</guimenu>列中选择节点名称。选择后，点击<guimenu>标识</guimenu>以标识正在运行主机的设备。这会让相应设备上的 LED 闪烁。选择此操作的时长（介于 1、2、5、10 或 15 分钟之间）。点击<guimenu>执行</guimenu>。
  </para>

  <figure>
   <title>服务</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_inventory.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_inventory.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-cluster-monitors">
  <title>查看 Ceph Monitor</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>Monitor</guimenu></menuchoice> 可查看具有正在运行的 Ceph Monitor 的集群节点列表。内容窗格分为两个视图：<literal>状态</literal>和<literal>仲裁成员</literal>或<literal>非仲裁成员</literal>。
  </para>

  <para>
   <guimenu>状态</guimenu>表显示有关运行中 Ceph Monitor 的一般统计数据，包括以下项目：
  </para>

  <itemizedlist>
   <listitem>
    <para>
     集群 ID
    </para>
   </listitem>
   <listitem>
    <para>
     monmap 修改时间
    </para>
   </listitem>
   <listitem>
    <para>
     monmap 版本编号
    </para>
   </listitem>
   <listitem>
    <para>
     仲裁 con
    </para>
   </listitem>
   <listitem>
    <para>
     仲裁 mon
    </para>
   </listitem>
   <listitem>
    <para>
     所需 con
    </para>
   </listitem>
   <listitem>
    <para>
     所需 mon
    </para>
   </listitem>
  </itemizedlist>

  <para>
   <literal>仲裁成员</literal>和<literal>非仲裁成员</literal>窗格包含每个 Monitor 的名称、排位号、公用 IP 地址和活动会话数。
  </para>

  <para>
   点击<guimenu>名称</guimenu>列中的节点名称可查看相关的 Ceph Monitor 配置。
  </para>

  <figure>
   <title>Ceph Monitor</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_mons.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_mons.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-cluster-services">
  <title>显示服务</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>服务</guimenu></menuchoice>可查看每个可用服务的详细信息：<literal>crash</literal>、Ceph Manager 和 Ceph Monitor。该列表包含容器映像名称、容器映像 ID、正在运行项目的状态、大小以及上次刷新时间。
  </para>

  <para>
   点击<guimenu>服务</guimenu>列中某个服务名称旁的下拉箭头可查看守护进程的详细信息。详细信息列表包含主机名、守护进程类型、守护进程 ID、容器 ID、容器映像名称、容器映像 ID、版本号、状态以及上次刷新时间。
  </para>

  <figure>
   <title>服务</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_services.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_services.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-cluster-osds">
  <title>显示 Ceph OSD</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>OSD</guimenu></menuchoice> 可查看具有正在运行的 OSD 守护进程的节点列表。该列表包含每个节点的名称、ID、状态、设备类型、归置组数量、大小、使用率、不同时间的读/写图表和每秒读/写操作次数。
  </para>

  <figure>
   <title>Ceph OSD</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_osds.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_osds.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   从表标题中的<guimenu>集群范围的配置</guimenu>下拉菜单中选择<guimenu>标志</guimenu>，可打开一个弹出窗口。此窗口包含适用于整个集群的标志列表。您可以激活或停用单个标志，然后点击<guimenu>提交</guimenu>进行确认。
  </para>

  <figure>
   <title>OSD 标志</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   从表标题中的<guimenu>集群范围的配置</guimenu>下拉菜单中选择<guimenu>恢复优先级</guimenu>，可打开一个弹出窗口。此窗口包含适用于整个集群的 OSD 恢复优先级列表。您可以激活首选的优先级配置，并对下面的各个值进行微调。点击<guimenu>提交</guimenu>进行确认。
  </para>

  <figure>
   <title>OSD 恢复优先级</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   点击<guimenu>主机</guimenu>列中某个节点名称旁的下拉箭头可查看扩展表，其中包含有关设备设置和性能的详细信息。您可以在数个选项卡之间切换，查看<guimenu>属性</guimenu>、<guimenu>元数据</guimenu>、<guimenu>设备健康状况</guimenu>、<guimenu>性能计数器</guimenu>各列表、读写操作次数的图形<guimenu>直方图</guimenu>，以及<guimenu>性能详细信息</guimenu>。
  </para>

  <figure>
   <title>OSD 详细信息</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_osd_details.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_osd_details.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <tip>
   <title>在 OSD 上执行特定任务</title>
   <para>
    点击某个 OSD 节点名称后，将高亮显示表中的对应行。这意味着现在您可以在该节点上执行任务。您可以选择执行以下任何操作：<guimenu>编辑</guimenu>、<guimenu>创建</guimenu>、<guimenu>洗刷</guimenu>、<guimenu>深层洗刷</guimenu>、<guimenu>重设权重</guimenu>、<guimenu>标记为除名</guimenu>、<guimenu>标记为加入</guimenu>、<guimenu>标记为停用</guimenu>、<guimenu>标记为丢失</guimenu>、<guimenu>清除</guimenu>、<guimenu>销毁</guimenu>或<guimenu>删除</guimenu>。
   </para>
   <para>
    点击表标题左上方<guimenu>创建</guimenu>按钮旁的向下箭头，然后选择要执行的任务。
   </para>
  </tip>

  <sect2 xml:id="dashboard-cluster-osds-add">
   <title>添加 OSD</title>
   <para>
    要添加新的 OSD，请执行以下步骤：
   </para>
   <procedure>
    <step>
     <para>
      确认某些集群节点的存储设备的状态为<literal>可用</literal>。然后点击表标题左上方的向下箭头并选择<guimenu>创建</guimenu>。此操作将打开<guimenu>创建 OSD</guimenu> 窗口。
     </para>
     <figure>
      <title>创建 OSD</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="dash_osd_add.png" width="75%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="dash_osd_add.png" width="75%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      要为 OSD 添加主存储设备，请点击<guimenu>添加</guimenu>。在添加存储设备之前，需要在<guimenu>主设备</guimenu>表的右上方指定过滤准则，例如<guimenu>类型</guimenu> <guimenu>hdd</guimenu>。单击<guimenu>添加</guimenu>进行确认。
     </para>
     <figure>
      <title>添加主设备</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="dash_osd_add_primary.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="dash_osd_add_primary.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      在更新的<guimenu>创建 OSD</guimenu> 窗口中，可以选择添加共享的 WAL 和 BD 设备，或者启用设备加密。
     </para>
     <figure>
      <title>创建添加了主设备的 OSD</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="dash_osd_add_primary_created.png" width="75%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="dash_osd_add_primary_created.png" width="75%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      点击<guimenu>预览</guimenu>可查看您之前所添加设备的 DriveGroups 规范预览。单击<guimenu>创建</guimenu>以确认。
     </para>
     <figure>
      <title/>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="dash_osd_add_primary_preview.png" width="75%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="dash_osd_add_primary_preview.png" width="75%"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      新设备将被添加到 OSD 列表中。
     </para>
     <figure>
      <title>新添加的 OSD</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="dash_osd_add_primary_added.png" width="100%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="dash_osd_add_primary_added.png" width="100%"/>
       </imageobject>
      </mediaobject>
     </figure>
     <note>
      <para>
       OSD 创建过程中无法查看进度。实际创建好 OSD 需要一些时间。部署 OSD 后，它们将显示在列表中。如果您要检查部署状态，请点击<menuchoice><guimenu>集群</guimenu><guimenu>日志</guimenu></menuchoice>查看相关日志。
      </para>
     </note>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-cluster-config">
  <title>查看集群配置</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>配置</guimenu></menuchoice>可查看 Ceph 集群配置选项的完整列表。该列表包含选项的名称、其简短描述、当前值和默认值以及选项是否可编辑。
  </para>

  <figure>
   <title>集群配置</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_cluster_config.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_cluster_config.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   点击<guimenu>名称</guimenu>列中某个配置选项旁的下拉箭头可查看扩展表，其中包含有关该选项的详细信息，例如其值类型、允许的最小值和最大值、是否可以在运行时更新等。
  </para>

  <para>
   高亮显示特定选项后，您可以通过点击表标题左上方的<guimenu>编辑</guimenu>按钮来编辑它的值。点击<guimenu>保存</guimenu>确认更改。
  </para>
 </sect1>
 <sect1 xml:id="dashboard-cluster-crushmap">
  <title>查看 CRUSH 索引</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>CRUSH 索引</guimenu></menuchoice>可查看集群的 CRUSH 索引。有关 CRUSH 索引的更多一般信息，请参见<xref linkend="op-crush"/>。
  </para>

  <para>
   点击根、节点或单个 OSD 可查看更多详细信息，例如 CRUSH 权重、索引树的深度、OSD 的设备类型等等。
  </para>

  <figure>
   <title>CRUSH 索引</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_crushmap.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_crushmap.png" width="100%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-cluster-mgr-plugins">
  <title>查看 Manager 模块</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>Manager 扩展模块</guimenu></menuchoice>可查看可用 Ceph Manager 扩展模块的列表。每行包含扩展模块名称以及该扩展模块当前启用与否的信息。
  </para>

  <figure>
   <title>Manager 模块</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_mgr_modules.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_mgr_modules.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   点击<guimenu>名称</guimenu>列中某个模块旁的下拉箭头，可在下面的<guimenu>详细信息</guimenu>表中查看包含详细设置的扩展表。点击表标题左上方的<guimenu>编辑</guimenu>按钮可进行编辑。点击<guimenu>更新</guimenu>确认更改。
  </para>

  <para>
   点击表标题左上方<guimenu>编辑</guimenu>按钮旁的下拉箭头可<guimenu>启用</guimenu>或<guimenu>禁用</guimenu>模块。
  </para>
 </sect1>
 <sect1 xml:id="dashboard-cluster-logs">
  <title>查看日志</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>日志</guimenu></menuchoice>可查看集群最近日志项的列表。每行包含一个时戳、日志项的类型及自身所记录的讯息。
  </para>

  <para>
   点击<guimenu>审计日志</guimenu>选项卡可查看审计子系统的日志项。有关启用或禁用审计的命令，请参见<xref linkend="dashboard-auditing"/>。
  </para>

  <figure>
   <title>日志</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_logs.png" width="80%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_logs.png" width="80%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-cluster-monitoring">
  <title>查看监控</title>

  <para>
   点击<menuchoice><guimenu>集群</guimenu><guimenu>监控</guimenu></menuchoice>可管理和查看有关 Prometheus 告警的详细信息。
  </para>

  <para>
   如果您启用了 Prometheus，则在此内容窗格中，您可以查看有关<guimenu>活动告警</guimenu>、<guimenu>所有告警</guimenu>或<guimenu>静默</guimenu>的详细信息。
  </para>

  <note>
   <para>
    如果您未部署 Prometheus，则会显示一个信息标题以及转到相关文档的链接。
   </para>
  </note>
 </sect1>
</chapter>
