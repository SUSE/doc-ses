<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="runtime_config.xml" version="5.0" xml:id="cha-ceph-configuration">
 <title>Cephクラスタの設定</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/maintenance/ses6/xml/</dm:editurl>
   <dm:translation>yes</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  この章では、Cephクラスタの重要な設定とその説明のリストを提供します。設定はトピック順にソートされています。
 </para>
 <sect1 xml:id="ceph-config-runtime">
  <title>ランタイム設定</title>

  <para>
   <xref linkend="ds-custom-cephconf"/>は、Ceph設定ファイル<filename>ceph.conf</filename>に変更を加える方法について説明しています。しかし、クラスタの実際の動作は、<filename>ceph.conf</filename>ファイルの現在の状態ではなく、メモリに格納されている、実行中のCephデーモンの設定によって決まります。
  </para>

  <para>
   デーモンが実行されているノードで「admin socket」<emphasis/>を使用して、特定の設定をCephの個々のデーモンに問い合わせることができます。たとえば、次のコマンドは、<option>osd.0</option>という名前のデーモンから<literal>osd_max_write_size</literal>設定パラメータの値を取得します。
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph --admin-daemon /var/run/ceph/ceph-osd.0.asok \
config get osd_max_write_size
{
  "osd_max_write_size": "90"
}</screen>

  <para>
   デーモンの設定をランタイム時に「変更」<emphasis/>することもできます。この変更は一時的で、デーモンを次回再起動すると失われることに注意してください。たとえば、次のコマンドは、クラスタ内にあるすべてのOSDの<option>osd_max_write_size</option>パラメータを「50」に変更します。
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph tell osd.* injectargs --osd_max_write_size 50</screen>

  <warning>
   <title><command>injectargs</command>は信頼性が低い</title>
   <para>
    残念ながら、<command>injectargs</command>コマンドでのクラスタ設定の変更は完全には信頼できません。変更したパラメータを確実にアクティブにする必要がある場合は、すべてのクラスタノードの設定ファイルでパラメータを変更して、クラスタ内のすべてのデーモンを再起動してください。
   </para>
  </warning>
 </sect1>
 <sect1 xml:id="config-osd-and-bluestore">


  <title>Ceph OSDとBlueStore</title>

  <sect2 xml:id="config-auto-cache-sizing">
   <title>自動キャッシュサイズ</title>
   <para>
    <option>tc_malloc</option>がメモリアロケータとして設定されていて、<option>bluestore_cache_autotune</option>設定が有効になっている場合、BlueStoreを、そのキャッシュサイズを自動的に調整するように設定できます。このオプションは現在、デフォルトで有効です。BlueStoreは、<option>osd_memory_target</option>設定オプションを使用して、OSDのヒープメモリ使用量を指定されたターゲットサイズに維持しようとします。これはベストエフォート型のアルゴリズムで、<option>osd_memory_cache_min</option>で指定されている量よりも小さいサイズにキャッシュが縮小されることはありません。キャッシュ比率は、優先度の階層に基づいて選択されます。優先度情報が使用できない場合は、代わりに<option>bluestore_cache_meta_ratio</option>オプションと<option>bluestore_cache_kv_ratio</option>オプションが使用されます。
   </para>
   <variablelist>
    <varlistentry>
     <term>bluestore_cache_autotune</term>
     <listitem>
      <para>
       最小値を優先しながら、異なるBlueStoreキャッシュに割り当てられる比率を自動的に調整します。デフォルトは<option>True</option>です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_target</term>
     <listitem>
      <para>
       <option>tc_malloc</option>および<option>bluestore_cache_autotune</option>が有効な場合、この量のバイトをメモリ内マップした状態を保持しようとします。
      </para>
      <note>
       <para>
        これは、プロセスのRSSメモリ使用量と正確には一致しない場合があります。通常、プロセスによってマップされたヒープメモリの合計量は、このターゲットに近い値を維持しますが、マップ解除済みのメモリをカーネルが実際に再利用する保証はありません。
       </para>
      </note>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_cache_min</term>
     <listitem>
      <para>
       <option>tc_malloc</option>および<option>bluestore_cache_autotune</option>が有効な場合に、キャッシュに使用するメモリの最小量を設定します。
      </para>
      <note>
       <para>
        この値を低く設定しすぎると、多大なキャッシュスラッシングが発生する可能性があります。
       </para>
      </note>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 xml:id="config-ogw">
  <title>Ceph Object Gateway</title>

  <para>
   <filename>/etc/ceph/ceph.conf</filename>ファイルの次の名前のセクションにあるさまざまなオプションにより、Object Gatewayの動作を変更できます。
  </para>

<screen>
[client.radosgw.<replaceable>INSTANCE_NAME</replaceable>]
</screen>

  <para>
   オプションを指定しない場合は、そのデフォルト値が使用されます。次に、Object Gatewayのすべてのオプションのリストを示します。
  </para>



  <sect2>
   <title>一般設定</title>
   <variablelist>
    <varlistentry>
     <term>rgw_frontends</term>
     <listitem>
      <para>
       HTTPフロントエンドを設定します。複数のフロントエンドがある場合は、各項目のカンマ区切リストを指定します。各フロントエンド設定には、スペースで区切ったオプションのリストを含めることができます。この場合、各オプションは「キー=値」または「キー」の形式になります。デフォルトは次のとおりです。
      </para>
<screen>
rgw_frontends = beast port=7480
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data</term>
     <listitem>
      <para>
       Object Gatewayのデータファイルの場所を設定します。デフォルトは<filename>/var/lib/ceph/radosgw/<replaceable>CLUSTER_ID</replaceable></filename>です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_apis</term>
     <listitem>
      <para>
       指定したAPIを有効にします。デフォルトは「s3, swift, swift_auth, admin All APIs」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_enabled</term>
     <listitem>
      <para>
       Object Gatewayキャッシュを有効/無効にします。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_lru_size</term>
     <listitem>
      <para>
       Object Gatewayキャッシュのエントリの数。デフォルトは10000です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_socket_path</term>
     <listitem>
      <para>
       ドメインソケットのソケットパス。<option>FastCgiExternalServer</option>は、このソケットを使用します。ソケットパスを指定しない場合、Object Gatewayは外部サーバとして実行されません。ここで指定するパスは、<filename>rgw.conf</filename>ファイルで指定するパスと同じである必要があります。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_fcgi_socket_backlog</term>
     <listitem>
      <para>
       fcgiのソケットバックログ。デフォルトは1024です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_host</term>
     <listitem>
      <para>
       Object Gatewayインスタンスのホスト。IPアドレスまたはDNS名を指定できます。デフォルトは0.0.0.0です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_port</term>
     <listitem>
      <para>
       インスタンスが要求をリスンするポート番号。指定されていない場合、Object Gatewayは外部のFastCGIを実行します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_dns_name</term>
     <listitem>
      <para>
       サービス対象ドメインのDNS名。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_script_uri</term>
     <listitem>
      <para>
       SCRIPT_URIが要求で設定されていない場合の代替値。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_request_uri</term>
     <listitem>
      <para>
       REQUEST_URIが要求で設定されていない場合の代替値。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_print_continue</term>
     <listitem>
      <para>
       100-continueが使用可能な場合、これを有効にします。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_remote_addr_param</term>
     <listitem>
      <para>
       リモートアドレスパラメータ。たとえば、リモートアドレスが含まれるHTTPフィールド、またはリバースプロキシが使用可能な場合はX-Forwarded-Forアドレス。デフォルトはREMOTE_ADDRです。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_timeout</term>
     <listitem>
      <para>
       開いているスレッドのタイムアウト(秒)。デフォルトは600です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_suicide_timeout</term>
     <listitem>
      <para>
       Object Gatewayプロキシが停止するまでのタイムアウト(秒)。0 (デフォルト)に設定すると無効になります。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_thread_pool_size</term>
     <listitem>
      <para>
       Beastサーバのスレッドの数。より多くの要求を実行する必要がある場合は、値を増やします。デフォルトは100スレッドです。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_rados_handles</term>
     <listitem>
      <para>
       Object GatewayのRADOSクラスタハンドルの数。Object Gatewayの各ワーカスレッドは、その有効期間中、RADOSハンドルを選択するようになりました。このオプションは今後のリリースで廃止され、削除される可能性があります。デフォルトは1です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_control_oids</term>
     <listitem>
      <para>
       異なるrgwインスタンス間のキャッシュ同期に使用する通知オブジェクトの数。デフォルトは8です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_init_timeout</term>
     <listitem>
      <para>
       Object Gatewayが初期化を中止するまでの秒数。デフォルトは30です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_mime_types_file</term>
     <listitem>
      <para>
       MIMEタイプのパスと場所。Swiftによるオブジェクトタイプの自動検出に使用します。デフォルトは<filename>/etc/mime.types</filename>です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_max_objs</term>
     <listitem>
      <para>
       1つのガベージコレクション処理サイクルでガベージコレクションによって処理できるオブジェクトの最大数。デフォルトは32です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_obj_min_wait</term>
     <listitem>
      <para>
       ガベージコレクション処理によってオブジェクトを削除および処理するまでの最大待機時間。デフォルトは2 * 3600です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_max_time</term>
     <listitem>
      <para>
       2つの連続するガベージコレクション処理サイクルを開始する間隔の最大時間。デフォルトは3600です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_period</term>
     <listitem>
      <para>
       ガベージコレクション処理のサイクル時間。デフォルトは3600です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_s3_success_create_obj_status</term>
     <listitem>
      <para>
       <literal>create-obj</literal>に対する代替の成功ステータス応答。デフォルトは0です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_resolve_cname</term>
     <listitem>
      <para>
       Object Gatewayが要求ホスト名フィールドのDNS CNAMEレコードを使用する必要があるかどうか(ホスト名がObject Gateway DNS名に等しくない場合)。デフォルトは「false」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_obj_stripe_size</term>
     <listitem>
      <para>
       Object Gatewayオブジェクトのオブジェクトストライプのサイズ。デフォルトは4&lt;&lt;20です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_extended_http_attrs</term>
     <listitem>
      <para>
       エンティティ(たとえば、ユーザ、バケット、オブジェクト)に設定できる一連の新しい属性を追加します。これらの追加属性は、エンティティを配置したり、POSTメソッドを使用して変更したりする場合に、HTTPヘッダフィールドによって設定できます。設定されている場合、これらの属性は、エンティティに対してGET/HEADを要求したときにHTTPフィールドとして返されます。デフォルトは「content_foo, content_bar, x-foo-bar」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_exit_timeout_secs</term>
     <listitem>
      <para>
       プロセスを待機してから無条件に終了するまでの秒数。デフォルトは120です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_window_size</term>
     <listitem>
      <para>
       1つのオブジェクト要求のウィンドウサイズ(バイト単位)。デフォルトは「16 &lt;&lt; 20」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_max_req_size</term>
     <listitem>
      <para>
       Ceph Storage Clusterに送信される1つのGET操作の最大要求サイズ。デフォルトは4&lt;&lt;20です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_relaxed_s3_bucket_names</term>
     <listitem>
      <para>
       USリージョンのバケットに対して、あいまいなS3バケット名を有効にします。デフォルトは「false」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_list_buckets_max_chunk</term>
     <listitem>
      <para>
       ユーザバケットを一覧にする際に1つの操作で取得するバケットの最大数。デフォルトは1000です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_override_bucket_index_max_shards</term>
     <listitem>
      <para>
       バケットインデックスオブジェクトのシャードの数を表します。0 (デフォルト)の設定は、シャーディングがないことを示します。バケットの一覧のコストが増加するため、大きすぎる値(たとえば、1000)を設定しないことをお勧めします。この変数は、自動的に<command>radosgw-admin</command>コマンドに適用されるよう、クライアントまたはグローバルセクションで設定する必要があります。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_curl_wait_timeout_ms</term>
     <listitem>
      <para>
       特定の<command>curl</command>呼び出しのタイムアウト(ミリ秒)。デフォルトは1000です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress</term>
     <listitem>
      <para>
       コピー操作に時間がかかる場合に、オブジェクトの進行状況の出力を有効にします。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress_every_bytes</term>
     <listitem>
      <para>
       コピーの進行状況出力間の最大バイト数。デフォルトは1024 * 1024です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_admin_entry</term>
     <listitem>
      <para>
       管理要求URLのエントリポイント。デフォルトは「admin」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_content_length_compat</term>
     <listitem>
      <para>
       CONTENT_LENGTHとHTTP_CONTENT_LENGTHの両方が設定されたFCGI要求の互換処理を有効にします。デフォルトは「false」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_quota_ttl</term>
     <listitem>
      <para>
       キャッシュされたクォータ情報を信頼する時間の量(秒単位)。このタイムアウトを過ぎると、クォータ情報はクラスタから再フェッチされます。デフォルトは600です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_bucket_sync_interval</term>
     <listitem>
      <para>
       バケットクォータ情報が蓄積されてからクラスタと同期するまでの時間(秒単位)。この時間の間、他のObject Gatewayインスタンスは、このインスタンスに対する操作に関連したバケットクォータ統計情報の変更を確認しません。デフォルトは180です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_sync_interval</term>
     <listitem>
      <para>
       ユーザクォータ情報が蓄積されてからクラスタと同期するまでの時間(秒数)。この時間の間、他のObject Gatewayインスタンスは、このインスタンスに対する操作に関連したユーザクォータ統計情報の変更を確認しません。デフォルトは180です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_objects</term>
     <listitem>
      <para>
       バケットあたりのオブジェクトのデフォルトの最大数。他のクォータが指定されていない場合、新しいユーザに対して設定され、既存のユーザには影響しません。この変数は、自動的に<command>radosgw-admin</command>コマンドに適用されるよう、クライアントまたはグローバルセクションで設定する必要があります。デフォルトは-1です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_size</term>
     <listitem>
      <para>
       バケットあたりのデフォルトの最大容量(バイト単位)。他のクォータが指定されていない場合、新しいユーザに対して設定され、既存のユーザには影響しません。デフォルトは-1です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_objects</term>
     <listitem>
      <para>
       ユーザのオブジェクトのデフォルトの最大数。これには、ユーザが所有するすべてのバケット内にあるすべてのオブジェクトが含まれます。他のクォータが指定されていない場合、新しいユーザに対して設定され、既存のユーザには影響しません。デフォルトは-1です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_size</term>
     <listitem>
      <para>
       他のクォータが指定されていない場合に新しいユーザに対して設定されるユーザの最大クォータサイズの値(バイト単位)。既存のユーザには影響しません。デフォルトは-1です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_verify_ssl</term>
     <listitem>
      <para>
       要求の実行中にSSL証明書を検証します。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_max_chunk_size</term>
     <listitem>
      <para>
       1回の操作で読み込むデータチャンクの最大サイズ。値を4MB (4194304)に増やすと、大容量オブジェクトの処理時にパフォーマンスが向上します。デフォルトは128KB (131072)です。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>マルチサイト設定</title>
    <varlistentry>
     <term>rgw_zone</term>
     <listitem>
      <para>
       ゲートウェイインスタンスのゾーンの名前。ゾーンが設定されていない場合は、<command>radosgw-admin zone default</command>コマンドでクラスタ全体のデフォルト値を設定できます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_zonegroup</term>
     <listitem>
      <para>
       ゲートウェイインスタンスのゾーングループの名前。ゾーングループが設定されていない場合は、<command>radosgw-admin zonegroup default</command>コマンドでクラスタ全体のデフォルト値を設定できます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_realm</term>
     <listitem>
      <para>
       ゲートウェイインスタンスのレルムの名前。レルムが設定されていない場合は、<command>radosgw-admin realm default</command>コマンドでクラスタ全体のデフォルト値を設定できます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_run_sync_thread</term>
     <listitem>
      <para>
       レルム内に同期元となる他のゾーンがある場合は、データとメタデータの同期を処理するためのスレッドを生成します。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_window</term>
     <listitem>
      <para>
       データログエントリのウィンドウ(秒単位)。デフォルトは30です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_changes_size</term>
     <listitem>
      <para>
       データ変更ログ用に保持するメモリ内エントリの数。デフォルトは1000です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_obj_prefix</term>
     <listitem>
      <para>
       データログのオブジェクト名のプレフィックス。デフォルトは「data_log」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_num_shards</term>
     <listitem>
      <para>
       データ変更ログを保持するシャード(オブジェクト)の数。デフォルトは128です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_md_log_max_shards</term>
     <listitem>
      <para>
       メタデータログのシャードの最大数。デフォルトは64です。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Swift設定</title>
    <varlistentry>
     <term>rgw_enforce_swift_acls</term>
     <listitem>
      <para>
       SwiftのACL (アクセス制御リスト)設定を適用します。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_token_expiration</term>
     <listitem>
      <para>
       Swiftのトークンを期限切れにする時間(秒単位)。デフォルトは24 * 3600です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url</term>
     <listitem>
      <para>
       Ceph Object Gateway Swift APIのURL。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url_prefix</term>
     <listitem>
      <para>
       「/v1」の部分の前に配置するSwift StorageURLのURLプレフィックス。これにより、同じホスト上で複数のゲートウェイインスタンスを実行できます。互換性のため、この設定変数を空に設定すると、デフォルトの「/swift」が使用されます。StorageURLをルートから開始するには、明示的なプレフィックス「/」を使用します。
      </para>
      <warning>
       <para>
        S3 APIが有効な場合、このオプションを「/」に設定しても機能しません。S3を無効にすると、マルチサイト設定でObject Gatewayを展開できなくなることに注意してください。
       </para>
      </warning>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_url</term>
     <listitem>
      <para>
       内部Swift認証が使用されていない場合にv1認証トークンを検証するためのデフォルトのURL。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_entry</term>
     <listitem>
      <para>
       Swift認証URLのエントリポイント。デフォルトは「auth」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_versioning_enabled</term>
     <listitem>
      <para>
       OpenStack Object Storage APIのオブジェクトのバージョン管理を有効にします。これにより、クライアントは、バージョンを管理する必要があるコンテナに<literal>X-Versions-Location</literal>属性を設定できます。この属性では、アーカイブされたバージョンを保存するコンテナの名前を指定します。これは、アクセス制御の検証のため、バージョン管理されたコンテナと同じユーザが所有する必要があります。ACLは考慮「されません」。<emphasis/>これらのコンテナは、S3のバージョン管理メカニズムではバージョン管理できません。デフォルトは「false」です。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>ログ設定</title>
    <varlistentry>
     <term>rgw_log_nonexistent_bucket</term>
     <listitem>
      <para>
       存在しないバケットに対する要求をObject Gatewayがログに記録できるようにします。デフォルトは「false」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name</term>
     <listitem>
      <para>
       オブジェクト名のログ書式。書式指定子の詳細については、マニュアルページ<command>man 1 date</command>を参照してください。デフォルトは「%Y-%m-%d-%H-%i-%n」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name_utc</term>
     <listitem>
      <para>
       ログに記録するオブジェクト名にUTC時刻を含めるかどうか。「false」(デフォルト)に設定すると、ローカル時刻が使用されます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_shards</term>
     <listitem>
      <para>
       使用状況ログ用のシャードの最大数。デフォルトは32です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_user_shards</term>
     <listitem>
      <para>
       1人のユーザの使用状況ログに使用するシャードの最大数。デフォルトは1です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_ops_log</term>
     <listitem>
      <para>
       Object Gatewayの正常な操作それぞれに対してログを有効にします。デフォルトは「false」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_usage_log</term>
     <listitem>
      <para>
       使用状況ログを有効にします。デフォルトは「false」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_rados</term>
     <listitem>
      <para>
       操作ログをCeph Storage Clusterバックエンドに書き込むかどうか。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_socket_path</term>
     <listitem>
      <para>
       操作ログを書き込むためのUnixドメインソケット。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_data_backlog</term>
     <listitem>
      <para>
       Unixドメインソケットに書き込まれる操作ログのデータバックログの最大データサイズ。デフォルトは5&lt;&lt;20です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_flush_threshold</term>
     <listitem>
      <para>
       同期的にフラッシュするまでの、使用状況ログ内のマージされたダーティエントリの数。デフォルトは1024です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_tick_interval</term>
     <listitem>
      <para>
       保留中の使用状況ログデータを「n」秒ごとにフラッシュします。デフォルトは30です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_http_headers</term>
     <listitem>
      <para>
       ログエントリに含めるHTTPヘッダのカンマ区切りリスト。ヘッダ名では大文字と小文字は区別されず、各単語を下線で区切った完全なヘッダ名を使用します。たとえば、「http_x_forwarded_for」「http_x_special_k」のようにします。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name</term>
     <listitem>
      <para>
       インテントログオブジェクト名のログ書式。書式指定子の詳細については、マニュアルページ<command>man 1 date</command>を参照してください。デフォルトは「%Y-%m-%d-%i-%n」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name_utc</term>
     <listitem>
      <para>
       インテントログオブジェクト名にUTC時刻を含めるかどうか。「false」(デフォルト)に設定すると、ローカル時刻が使用されます。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Keystone設定</title>
    <varlistentry>
     <term>rgw_keystone_url</term>
     <listitem>
      <para>
       KeystoneサーバのURL。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_api_version</term>
     <listitem>
      <para>
       Keystoneサーバと通信するために使用するOpenStack Identity APIのバージョン(2または3)。デフォルトは2です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_domain</term>
     <listitem>
      <para>
       OpenStack Identity API v3を使用する場合に管理者特権を持つOpenStackドメインの名前。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_project</term>
     <listitem>
      <para>
       OpenStack Identity API v3を使用する場合に管理者特権を持つOpenStackプロジェクトの名前。設定されていない場合は、代わりに<command>rgw keystone admin tenant</command>の値が使用されます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_token</term>
     <listitem>
      <para>
       Keystone管理者トークン(共有シークレット)。Object Gatewayでは、管理者トークンを使用した認証は、管理者資格情報を使用した認証よりも優先されます(オプション<option>rgw keystone admin user</option>、<option>rgw keystone admin password</option>、<option>rgw keystone admin tenant</option>、<option>rgw keystone admin project</option>、および<option>rgw keystone admin domain</option>)。管理者トークン機能は非推奨と見なされています。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_tenant</term>
     <listitem>
      <para>
       OpenStack Identity API v2を使用する場合に管理者特権を持つOpenStackテナント(サービステナント)の名前。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_user</term>
     <listitem>
      <para>
       OpenStack Identity API v2を使用する場合にKeystone認証用の管理者特権を持つOpenStackユーザ(サービスユーザ)の名前。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_password</term>
     <listitem>
      <para>
       OpenStack Identity API v2を使用する場合のOpenStack管理者ユーザのパスワード。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_accepted_roles</term>
     <listitem>
      <para>
       要求を実行するために必要な役割。デフォルトは「Member, admin」です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_token_cache_size</term>
     <listitem>
      <para>
       各Keystoneトークンキャッシュ内のエントリの最大数。デフォルトは10000です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_revocation_interval</term>
     <listitem>
      <para>
       トークンの失効を確認する間隔の秒数。デフォルトは15 * 60です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_verify_ssl</term>
     <listitem>
      <para>
       Keystoneへのトークン要求の実行中にSSL証明書を検証します。デフォルトは「true」です。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <sect3 xml:id="sec-ceph-rgw-configuration-notes">
    <title>追加の注意事項</title>
    <variablelist>
     <varlistentry>
      <term>rgw_dns_name</term>
      <listitem>
       <para>
        <filename>ceph.conf</filename>にパラメータ<literal>rgw dns name</literal>を追加する場合、<literal>rgw dns name</literal>で指定されたエンドポイントで要求を転送するようS3クライアントを設定してください。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>

  <sect2 xml:id="config-ogw-http-frontends">
   <title>HTTPフロントエンド</title>
   <sect3>
    <title>Beast</title>
    <variablelist>
     <varlistentry>
      <term>port、ssl_port</term>
      <listitem>
       <para>
        IPv4およびIPv6のリスンポート番号。複数のポート番号を指定できます。
       </para>
<screen>
port=80 port=8000 ssl_port=8080
</screen>
       <para>
        デフォルトは80です。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>endpoint、ssl_endpoint</term>
      <listitem>
       <para>
        「address[:port]」の形式のリスンアドレス。アドレスは、ドット区切りの10進数形式のIPv4アドレス文字列、または角括弧で囲んだ16進数形式のIPv6アドレスです。IPv6エンドポイントを指定すると、IPv6のみがリスンされます。オプションのポート番号は、<option>endpoint</option>の場合は80、<option>ssl_endpoint</option>の場合は443にデフォルトで設定されます。複数のアドレスを指定できます。
       </para>
<screen>
endpoint=[::1] endpoint=192.168.0.100:8000 ssl_endpoint=192.168.0.100:8080
</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>ssl_private_key</term>
      <listitem>
       <para>
        SSLが有効なエンドポイントに対して使用する秘密鍵のパス(オプション)。指定されていない場合、<option>ssl_certificate</option>ファイルが秘密鍵として使用されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>tcp_nodelay</term>
      <listitem>
       <para>
        指定されている場合、ソケットオプションにより、接続時にNagleのアルゴリズムが無効化されます。つまり、パケットは、バッファがいっぱいになるかタイムアウトになるまで待つのではなく、できるだけ早く送信されます。
       </para>
       <para>
        「1」は、すべてのソケットに対してNagleのアルゴリズムを無効にします。
       </para>
       <para>
        「0」は、Nagleのアルゴリズムを有効なままにします(デフォルト)。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title><filename>/etc/ceph/ceph.conf</filename>のBeast設定の例</title>
<screen>
rgw_frontends = beast port=8000 ssl_port=443 ssl_certificate=/etc/ssl/ssl.crt error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>CivetWeb</title>
    <variablelist>
     <varlistentry>
      <term>port</term>
      <listitem>
       <para>
        リスンするポート番号。SSLが有効なポートには、サフィックス「s」を追加します(たとえば、「443s」)。特定のIPv4またはIPv6アドレスをバインドするには、「address:port」の形式を使用します。複数のエンドポイントを指定するには、各エンドポイントを「+」で結合するか、複数のオプションを指定します。
       </para>
<screen>
port=127.0.0.1:8000+443s
port=8000 port=443s
</screen>
       <para>
        デフォルトは7480です。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>num_threads</term>
      <listitem>
       <para>
        受信HTTP接続を処理するためにCivetwebによって生成されるスレッドの数。これは実質的に、フロントエンドが処理できる同時接続数を制限します。
       </para>
       <para>
        デフォルトは、<option>rgw_thread_pool_size</option>オプションで指定されている値です。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>request_timeout_ms</term>
      <listitem>
       <para>
        Civetwebが他の受信データを待機してから中止するまでの時間(ミリ秒単位)。
       </para>
       <para>
        デフォルトは30,000ミリ秒です。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>access_log_file</term>
      <listitem>
       <para>
        アクセスログファイルのパス。フルパス、または現在の作業ディレクトリを基準とした相対パスのいずれかを指定できます。指定されていない場合(デフォルト)、アクセスはログに記録されません。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>error_log_file</term>
      <listitem>
       <para>
        エラーログファイルのパス。フルパス、または現在の作業ディレクトリを基準とした相対パスのいずれかを指定できます。指定されていない場合(デフォルト)、エラーはログに記録されません。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title><filename>/etc/ceph/ceph.conf</filename>のCivetweb設定の例</title>
<screen>
rgw_frontends = civetweb port=8000+443s request_timeout_ms=30000 error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>共通オプション</title>
    <variablelist>
     <varlistentry>
      <term>ssl_certificate</term>
      <listitem>
       <para>
        SSLが有効なエンドポイントに対して使用するSSL証明書ファイルのパス。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>prefix</term>
      <listitem>
       <para>
        すべての要求のURLに挿入するプレフィックス文字列。たとえば、Swift専用のフロントエンドでは、URLプレフィックス「/swift」を指定できます。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
</chapter>
