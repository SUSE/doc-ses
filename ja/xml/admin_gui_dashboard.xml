<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_gui_dashboard.xml" version="5.0" xml:id="ceph-dashboard">
 <title>Cephダッシュボード</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Cephダッシュボードは、Webベースの組み込みの監視および管理アプリケーションをCeph Managerに追加するモジュールです(Ceph Managerの詳細については、<xref linkend="storage-intro-core-nodes"/>を参照してください）。Ceph関連の複雑なコマンドを知らなくても、Cephクラスタを管理および監視できるようになりました。Cephダッシュボードの直感的なWebインタフェース、またはその組み込みREST APIのいずれかを使用できます。
 </para>
 <para>
  Cephダッシュボードは、展開手順中にDeepSeaのステージ3で自動的に有効化および設定されます(<xref linkend="ceph-install-stack"/>を参照)。複数のCeph Managerインスタンスを使用するCephクラスタでは、現在アクティブなCeph Managerデーモンで実行されているダッシュボードのみが着信要求を処理します。現在スタンバイ状態にある他のCeph ManagerインスタンスのいずれかでダッシュボードのTCPポートにアクセスすると、現在アクティブなCeph ManagerのダッシュボードのURLに対してHTTPリダイレクト(303)が実行されます。このようにして、任意のCeph Managerインスタンスにブラウザをポイントして、そのダッシュボードにアクセスできます。ファイアウォールを使用してアクセスを保護する場合、またはHAセットアップを計画する場合には、この動作を考慮してください。
 </para>
 <sect1 xml:id="dashboard-webui-general">
  <title>ダッシュボードのWebユーザインタフェース</title>

  <sect2 xml:id="dashboard-webui-login">
   <title>ログイン</title>
   <para>
    ダッシュボードWebアプリケーションにログインするには、ポート番号を含むそのURLにブラウザをポイントします。次のコマンドを実行して、そのアドレスを確認できます。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph mgr services | grep dashboard
"dashboard": "https://ses-dash-node.example.com:8443/",
</screen>
   <figure>
    <title>Cephダッシュボードのログイン画面</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dashboard_login.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dashboard_login.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    ダッシュボードWebアプリケーションにログインするには、ユーザアカウントが必要です。DeepSeaにより、管理者特権を持つデフォルトのユーザ「admin」が自動的に作成されます。デフォルトの「admin」ユーザでログインする場合は、次のコマンドを実行して対応するパスワードを取得します
   </para>
<screen>
<prompt>root@master # </prompt>salt-call grains.get dashboard_creds
</screen>
   <tip>
    <title>カスタムユーザアカウント</title>
    <para>
     Cephダッシュボードにアクセスするのにデフォルトの「admin」アカウントを使用しない場合は、管理者特権を持つカスタムユーザアカウントを作成します。詳細については、<xref linkend="dashboard-user-roles"/>を参照してください。
    </para>
   </tip>
   <para>
    ダッシュボードのユーザインタフェースは、<emphasis/><emphasis/>「ユーティリティメニュー」、<emphasis/>「メインメニュー」、およびメインの<emphasis/>「コンテンツペイン」という複数の「ブロック」にグラフィカルに分かれています。
   </para>
   <figure>
    <title>Cephダッシュボードのホームページ</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dashboard_homepage.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dashboard_homepage.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-util-menu">
   <title>ユーティリティメニュー</title>
   <para>
    画面の右上部分にはユーティリティメニューがあります。ここには、Cephクラスタよりもダッシュボードとの関連性が高い一般的なタスクが含まれます。その項目をクリックすることにより、次のトピックにアクセスできます。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      ダッシュボードのユーザインタフェースの言語を変更する。チェコ語、英語、ドイツ語、スペイン語、フランス語、ポルトガル語、中国語、またはインドネシア語から選択できます。
     </para>
    </listitem>
    <listitem>
     <para>
      バックグラウンドで実行されているCeph関連タスクのリストを表示する。
     </para>
    </listitem>
    <listitem>
     <para>
      ダッシュボードの最近の通知を表示および削除する。
     </para>
    </listitem>
    <listitem>
     <para>
      ダッシュボード、その完全なドキュメント、およびそのREST APIの概要に関する情報を参照するリンクのリストを表示する。
     </para>
    </listitem>
    <listitem>
     <para>
      ダッシュボードのユーザおよびユーザの役割を管理する。コマンドラインの説明の詳細については、<xref linkend="dashboard-user-roles"/>を参照してください。
     </para>
    </listitem>
    <listitem>
     <para>
      ダッシュボードからログアウトする。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="dashboard-main-menu">
   <title>メインメニュー</title>
   <para>
    ダッシュボードのメインメニューは、画面の左上部分にあります。これは次のトピックに対応します。
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>ダッシュボード</guimenu></term>
     <listitem>
      <para>
       Cephダッシュボードのホームページに戻ります。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>クラスタ</guimenu></term>
     <listitem>
      <para>
       クラスタの全体的な設定と、CRUSHマップ、そのホスト、Ceph OSD、Ceph Monitor、およびログファイルの内容に関する詳細情報を表示します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>プール</guimenu></term>
     <listitem>
      <para>
       クラスタプールを表示および管理します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>ブロック</guimenu></term>
     <listitem>
      <para>
       ブロックサービスとそのiSCSIエクスポートを表示および管理します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>NFS</guimenu></term>
     <listitem>
      <para>
       NFS Ganeshaの展開を表示および管理します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>ファイルシステム</guimenu></term>
     <listitem>
      <para>
       CephFSを表示および管理します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Object Gateway</guimenu></term>
     <listitem>
      <para>
       Object Gatewayのデーモン、ユーザ、およびバケットを表示および管理します。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard-cpane">
   <title>コンテンツペイン</title>
   <para>
    コンテンツペインは、ダッシュボードの画面のメイン部分を占めます。ダッシュボードのホームページには、多数の便利なウィジェットが表示されており、クラスタの現在のステータス、容量、およびパフォーマンス情報について簡潔に通知します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-ui-common">
   <title>Web UIの共通機能</title>
   <para>
    Cephダッシュボードでは、プールのリスト、OSDノードのリスト、RBDデバイスのリストなど、「リスト」<emphasis/>を操作することがよくあります。すべてのリストは、デフォルトでは5秒ごとに自動的に更新されます。次の共通ウィジェットは、これらのリストを管理または調整する場合に役立ちます。
   </para>
   <para>
    <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    </inlinemediaobject>をクリックして、リストの手動更新をトリガします。
   </para>
   <para>
    <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> をクリックして、個々のテーブル列の表示/非表示を切り替えます。
   </para>
   <para>
    <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> をクリックして、1ページに表示する行数を選択します。
   </para>
   <para>
    <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> の内部をクリックし、検索する文字列を入力して行をフィルタします。
   </para>
   <para>
    リストが複数のページにわたる場合は、<inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> を使用して、現在表示されているページを変更します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-widgets">
   <title>ダッシュボードウィジェット</title>
   <para>
    各ダッシュボードウィジェットには、実行中のCephクラスタの特定の側面に関連する特定のステータス情報が表示されます。一部のウィジェットはアクティブなリンクになっており、クリックすると、そのウィジェットが表すトピックに関連する詳細ページにリダイレクトされます。
   </para>
   <tip>
    <title>マウスポインタを合わせて詳細を表示</title>
    <para>
     一部のグラフィカルウィジェットでは、マウスポインタを合わせると詳細が表示されます。
    </para>
   </tip>
   <sect3 xml:id="dashboard-widgets-status">
    <title>ステータスウィジェット</title>
    <para>
     <guimenu>ステータス</guimenu>ウィジェットは、クラスタの現在のステータスに関する簡単な概要を提供します。
    </para>
    <figure>
     <title>ステータスウィジェット</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_status.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_status.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>クラスタのステータス</guimenu></term>
      <listitem>
       <para>
        クラスタのヘルスに関する基本的な情報が示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>モニター</guimenu></term>
      <listitem>
       <para>
        実行中のモニターとその定数の数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>OSD</guimenu></term>
      <listitem>
       <para>
        OSDの合計数と、「up」および「in」のOSDの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>マネージャデーモン</guimenu></term>
      <listitem>
       <para>
        アクティブおよびスタンバイ状態のCeph Managerデーモンの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>ホスト</guimenu></term>
      <listitem>
       <para>
        クラスタノードの合計数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Object Gateway</guimenu></term>
      <listitem>
       <para>
        実行中のObject Gatewayの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Metadata Server</guimenu></term>
      <listitem>
       <para>
        Metadata Serverの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>iSCSI Gateway</guimenu></term>
      <listitem>
       <para>
        設定されているiSCSI Gatewayの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3 xml:id="dashboard-widgets-performance">
    <title>パフォーマンスウィジェット</title>
    <para>
     <guimenu>パフォーマンス</guimenu>ウィジェットは、Cephクライアントの基本的なパフォーマンスを参照します。
    </para>
    <figure>
     <title>パフォーマンスウィジェット</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_perf.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_perf.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>クライアントのIOPS</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>クライアントのスループット</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>クライアントの読み取り/書き込み</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>回復スループット</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>スクラブ</guimenu></term>
      <listitem>
       <para/>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3 xml:id="dashboard-widgets-capacity">
    <title>容量のウィジェット</title>
    <para>
     <guimenu>容量</guimenu>ウィジェットには、ストレージ容量に関する簡単な情報が表示されます。
    </para>
    <figure>
     <title>容量のウィジェット</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_capacity.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_capacity.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>プール</guimenu></term>
      <listitem>
       <para>
        クラスタのプールの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>未フォーマット時の容量</guimenu></term>
      <listitem>
       <para>
        使用済みの容量と使用可能な未フォーマット時のストレージ容量の比率が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>オブジェクト</guimenu></term>
      <listitem>
       <para>
        クラスタに保存されているデータオブジェクトの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>OSDあたりの配置グループ数</guimenu></term>
      <listitem>
       <para>
        OSDあたりの配置グループの数が表示されます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>配置グループのステータス</guimenu></term>
      <listitem>
       <para>
        配置グループのチャートがステータスに従って表示されます。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-user-mgmt">
  <title>ダッシュボードのユーザと役割の管理</title>

  <para>
   コマンドラインでCephコマンドを使用して実行するダッシュボードユーザ管理については、<xref linkend="dashboard-user-roles"/>ですでに紹介しています。
  </para>

  <para>
   このセクションでは、ダッシュボードWebユーザインタフェースを使用してユーザアカウントを管理する方法について説明します。
  </para>

  <sect2 xml:id="dashboard-listing-users">
   <title>ユーザの一覧</title>
   <para>
    ユーティリティメニューの <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> をクリックし、<guimenu>ユーザ管理</guimenu>を選択します。
   </para>
   <para>
    このリストには、各ユーザの名前、氏名、電子メール、および割り当てられている役割のリストが含まれます。
   </para>
   <figure>
    <title>ユーザ管理</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_users.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_users.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-adding-users">
   <title>新しいユーザの追加</title>
   <para>
    新しいユーザを追加するには、テーブル見出しの左上の<guimenu>追加</guimenu>をクリックします。ユーザ名、パスワード、およびオプションで氏名と電子メールを入力します。
   </para>
   <figure>
    <title>ユーザの追加</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_user_add.png" width="50%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_user_add.png" width="50%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    事前定義された役割をユーザに割り当てるには、小さいペンのアイコンをクリックします。<guimenu>Create User (ユーザの作成)</guimenu>をクリックして確認します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-editing-users">
   <title>ユーザの編集</title>
   <para>
    ユーザに関する詳細を編集するには、ユーザのテーブル行をクリックし、<guimenu>編集</guimenu>を選択します。<guimenu>ユーザの更新</guimenu>をクリックして確認します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-deleting-users">
   <title>ユーザの削除</title>
   <para>
    ユーザアカウントを削除するには、ユーザのテーブル行をクリックし、<guimenu>削除</guimenu>を選択します。<guimenu>はい</guimenu>チェックボックスをオンにし、<guimenu>Delete User (ユーザの削除)</guimenu>をクリックして確認します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-listing-user-roles">
   <title>ユーザの役割の一覧</title>
   <para>
    ユーティリティメニューの <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> をクリックし、<guimenu>ユーザ管理</guimenu>を選択します。続いて、<guimenu>役割</guimenu>タブをクリックします。
   </para>
   <para>
    このリストには、各役割の名前、説明、およびシステム役割であるかどうかが含まれます。
   </para>
   <figure>
    <title>ユーザの役割</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_roles.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_roles.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-adding-roles">
   <title>カスタム役割の追加</title>
   <para>
    新しいカスタム役割を追加するには、テーブル見出しの左上の<guimenu>追加</guimenu>をクリックします。その名前、説明を入力し、個々のトピックに必要な許可を設定します。
   </para>
   <tip>
    <title>カスタム役割の消去</title>
    <para>
     カスタム役割を作成し、後で<command>ceph.purge</command>ランナを使ってCephクラスタを削除する場合、まずカスタム役割を消去する必要があります。詳細については、<xref linkend="deepsea-ceph-purge"/>を参照してください。
    </para>
   </tip>
   <figure>
    <title>役割の追加</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_roles_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_roles_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <tip>
    <title>複数の有効化</title>
    <para>
     トピック名の前にあるチェックボックスをオンにすると、そのトピックの許可がすべて有効になります。<guimenu>すべて</guimenu>チェックボックスをオンにすると、すべてのトピックの許可がすべて有効になります。
    </para>
   </tip>
   <para>
    <guimenu>Create Role (役割の作成)</guimenu>をクリックして確認します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-editing-roles">
   <title>カスタム役割の編集</title>
   <para>
    カスタムの役割の説明と許可を編集するには、カスタム役割のテーブル行をクリックし、テーブル見出しの左上の<guimenu>編集</guimenu>を選択します。<guimenu>Update Role (役割の更新)</guimenu>をクリックして確認します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-deleting-roles">
   <title>カスタム役割の削除</title>
   <para>
    役割を削除するには、役割のテーブル行をクリックし、<guimenu>削除</guimenu>を選択します。<guimenu>はい</guimenu>チェックボックスをオンにし、<guimenu>Delete Role (役割の削除)</guimenu>をクリックして確認します。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-cluster">
  <title>クラスタの内部情報の表示</title>

  <para>
   <guimenu>クラスタ</guimenu>メニュー項目では、Cephクラスタのホスト、OSD、MON、CRUSHマップ、およびログファイルの内容に関する詳細情報を表示できます。
  </para>

  <sect2 xml:id="dashboard-cluster-hosts">
   <title>クラスタノード</title>
   <para>
    クラスタノードのリストを表示するには、<menuchoice><guimenu>クラスタ</guimenu><guimenu>ホスト</guimenu></menuchoice>をクリックします。
   </para>
   <figure>
    <title>ホスト</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    ノードのパフォーマンスの詳細を表示するには、<guimenu>ホスト名</guimenu>列のノード名をクリックします。
   </para>
   <para>
    <guimenu>サービス</guimenu>列には、関連する各ノードで実行されているすべてのデーモンが一覧にされます。デーモン名をクリックすると、その詳細な設定が表示されます。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-monitors">
   <title>Ceph Monitor</title>
   <para>
    実行中のCeph Monitorが存在するクラスタノードのリストを表示するには、<menuchoice><guimenu>クラスタ</guimenu><guimenu>モニター</guimenu></menuchoice>をクリックします。このリストには、各モニターのランク番号、パブリックIPアドレス、および開いているセッションの数が含まれます。
   </para>
   <para>
    このリストは2つのテーブルに分かれています。1つは定数に「含まれている」Ceph Monitorのリストで<emphasis/>、もう1つは定数に「含まれていない」Ceph Monitorのリストです<emphasis/>。
   </para>
   <para>
    関連するCeph Monitorの設定を表示するには、<guimenu>名前</guimenu>列のノード名をクリックします。
   </para>
   <para>
    <guimenu>ステータス</guimenu>テーブルには、実行中のCeph Monitorに関する一般的な統計情報が表示されます。
   </para>
   <figure>
    <title>Ceph Monitor</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-cluster-osds">
   <title>Ceph OSD</title>
   <para>
    実行中のOSDデーモン/ディスクが存在するノードのリストを表示するには、<menuchoice><guimenu>クラスタ</guimenu><guimenu>OSD</guimenu></menuchoice>をクリックします。このリストには、各ノードの名前、ステータス、配置グループの数、サイズ、使用状況、時間内の読み込み/書き込みチャート、および1秒あたりの読み込み/書き込み操作の速度が含まれます。
   </para>
   <figure>
    <title>Ceph OSD</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    テーブル見出しの<guimenu>Set Cluster-wide Flags (クラスタ全体のフラグを設定)</guimenu>をクリックすると、ポップアップウィンドウに、クラスタ全体に適用されるフラグのリストが表示されます。個々のフラグを有効または無効にし、<guimenu>送信</guimenu>をクリックして確認できます。
   </para>
   <figure>
    <title>OSDフラグ</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    テーブル見出しの<guimenu>Set Cluster-wide Recovery Priority (クラスタ全体に回復優先度を設定)</guimenu>をクリックすると、ポップアップウィンドウに、クラスタ全体に適用されるOSD回復優先度のリストが表示されます。希望する優先度プロファイルを有効にし、次の個々の値を微調整できます。<guimenu>Submit (送信)</guimenu>をクリックして確認します。
   </para>
   <figure>
    <title>OSD回復優先度</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    OSDの設定とパフォーマンスに関する詳細を含む拡張テーブルを表示するには、<guimenu>ホスト</guimenu>列のノード名をクリックします。複数のタブを参照すると、<guimenu>属性</guimenu>、<guimenu>メタデータ</guimenu>、<guimenu>パフォーマンスカウンタ</guimenu>、および読み込みと書き込みをグラフィカルに表示する<guimenu>ヒストグラム</guimenu>の各リストを確認できます。
   </para>
   <figure>
    <title>OSDの詳細</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <tip>
    <title>OSDでの固有のタスクの実行</title>
    <para>
     OSDノード名をクリックすると、テーブル行の色が少し変わります。これは、ノードでタスクを実行できるようになったことを示します。テーブル見出しの左上にある下向き矢印をクリックし、<guimenu>ディープスクラブ</guimenu>など、実行するタスクを選択します。オプションで、タスクに必要な値を入力し、確認してノードでタスクを実行します。
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dahsboard-cluster-config">
   <title>クラスタ設定</title>
   <para>
    Cephクラスタ設定オプションの完全なリストを表示するには、<menuchoice><guimenu>クラスタ</guimenu><guimenu>設定</guimenu></menuchoice>をクリックします。このリストには、オプションの名前、その簡単な説明、および現在値とデフォルト値が含まれます。
   </para>
   <figure>
    <title>クラスタ設定</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    特定のオプション行をクリックすると、値のタイプ、指定できる最小値と最大値、実行時に値を更新できるかどうかなど、オプションに関する詳細情報が強調表示されます。
   </para>
   <para>
    特定のオプションを強調表示した後で、テーブル見出しの左上の<guimenu>編集</guimenu>ボタンをクリックして、その値を編集できます。<guimenu>保存</guimenu>をクリックして変更を確定します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-crushmap">
   <title>CRUSHマップ</title>
   <para>
    クラスタのCRUSHマップを表示するには、<menuchoice><guimenu>クラスタ</guimenu><guimenu>CRUSHマップ</guimenu></menuchoice>をクリックします。CRUSHマップの全般的な情報については、<xref linkend="op-crush"/>を参照してください。
   </para>
   <para>
    ルート、ノード、または個々のOSDをクリックすると、CRUSHの重み、マップツリー内での深さ、OSDのデバイスクラスなどの詳細情報が表示されます。
   </para>
   <figure>
    <title>CRUSHマップ</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-cluster-mgr-plugins">
   <title>マネージャモジュール</title>
   <para>
    使用可能なCeph Managerモジュールのリストを表示するには、<menuchoice><guimenu>クラスタ</guimenu><guimenu>マネージャモジュール</guimenu></menuchoice>をクリックします。各行は、モジュール名と、そのモジュールが現在有効かどうかに関する情報で構成されます。
   </para>
   <figure>
    <title>マネージャモジュール</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    特定のモジュールを強調表示すると、下の<guimenu>詳細</guimenu>テーブルに詳細な設定が表示されます。設定を編集するには、テーブル見出しの左上の<guimenu>編集</guimenu>ボタンをクリックします。<guimenu>更新</guimenu>をクリックして変更を確定します。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-logs">
   <title>ログ</title>
   <para>
    クラスタの最近のログエントリのリストを表示するには、<menuchoice><guimenu>クラスタ</guimenu><guimenu>ログ</guimenu></menuchoice>をクリックします。各行は、タイムスタンプ、ログエントリのタイプ、およびログに記録されたメッセージ自体で構成されます。
   </para>
   <para>
    監査サブシステムのログエントリを表示するには、<guimenu>監査ログ</guimenu>タブをクリックします。監査を有効または無効にするためのコマンドについては、<xref linkend="dashboard-auditing"/>を参照してください。
   </para>
   <figure>
    <title>ログ</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-pools">
  <title>プールの管理</title>

  <tip>
   <title>プールについての詳細</title>
   <para>
    Cephのプールの全般的な情報については、<xref linkend="ceph-pools"/>を参照してください。イレージャコーディングプールに固有の情報については、<xref linkend="cha-ceph-erasure"/>を参照してください。
   </para>
  </tip>

  <para>
   利用可能なすべてのプールを一覧にするには、メインメニューから<guimenu>Pools (プール)</guimenu>をクリックします。
  </para>

  <para>
   このリストには、各プールの名前、タイプ、関連するアプリケーション、配置グループのステータス、レプリカサイズ、イレージャコーディングプロファイル、使用量、および読み書きの統計情報が表示されます。
  </para>

  <figure>
   <title>プールのリスト</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   プールに関するより詳細な情報を表示するには、そのテーブル行を有効にします。
  </para>

  <sect2 xml:id="dashboard-pools-create">
   <title>新しいプールの追加</title>
   <para>
    新しいプールを追加するには、プールテーブルの左上の<guimenu>追加</guimenu>をクリックします。プールのフォームに、プールの名前、タイプ、配置グループの数、および追加情報(プールのアプリケーション、圧縮モード、アルゴリズムなど)を入力できます。この特定のプールに最適な配置グループの数は、プールのフォームそのものによって事前に計算されます。この計算は、クラスタ内のOSDの量、および選択したプールタイプとその特定の設定に基づきます。配置グループ数を手動で設定すると、すぐに計算された数に置き換えられます。<guimenu>プールの作成</guimenu>をクリックして確認します。
   </para>
   <figure>
    <title>新しいプールの追加</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-pools-delete">
   <title>プールの削除</title>
   <para>
    プールを削除するには、そのテーブル行をクリックし、プールテーブルの左上の<guimenu>削除</guimenu>をクリックします。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-pools-edit">
   <title>プールのオプションの編集</title>
   <para>
    プールのオプションを編集するには、そのテーブル行をクリックし、プールテーブルの左上の<guimenu>編集</guimenu>を選択します。
   </para>
   <para>
    プールの名前を変更したり、配置グループの数を増やしたり、プールのアプリケーションのリストや圧縮設定を変更したりできます。<guimenu>Edit pool (プールの編集)</guimenu>をクリックして確認します。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-rbds">
  <title>RADOS Block Deviceの管理</title>

  <para>
   利用可能なすべてのRBD (RADOS Block Devices)を一覧にするには、メインメニューから<menuchoice><guimenu>ブロック</guimenu><guimenu>イメージ</guimenu></menuchoice>をクリックします。
  </para>

  <para>
   このリストには、デバイスの名前、関連するプール名、デバイスのサイズ、デバイス上のオブジェクトの数とサイズなど、デバイスに関する簡単な情報が表示されます。
  </para>

  <figure>
   <title>RBDイメージのリスト</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_rbd_images.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_rbd_images.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="dashboard-rbds-details">
   <title>RBDに関する詳細の表示</title>
   <para>
    デバイスに関する詳細情報を表示するには、テーブルでそのデバイスの行をクリックします。
   </para>
   <figure>
    <title>RBDの詳細</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_details.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_details.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-rbds-configuration">
   <title>RBDの設定の表示</title>
   <para>
    デバイスの詳細な設定を表示するには、テーブルでそのデバイスの行をクリックし、続いてその下のテーブルで<guimenu>設定</guimenu>タブをクリックします。
   </para>
   <figure>
    <title>RBD設定</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_config.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_config.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-rbds-create">
   <title>RBDの作成</title>
   <para>
    新しいデバイスを追加するには、テーブル見出しの左上の<guimenu>追加</guimenu>をクリックして、<guimenu>Create RBD (RBDの作成)</guimenu>画面で次の操作を行います。
   </para>
   <figure>
    <title>新しいRBDの追加</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbd_add.png" width="85%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbd_add.png" width="85%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      新しいデバイスの名前を入力します。命名の制限については、<xref linkend="sysreq-naming"/>を参照してください。
     </para>
    </step>
    <step>
     <para>
      新しいRBDデバイスの作成元となる、「RBD」アプリケーションが割り当てられたプールを選択します。
     </para>
    </step>
    <step>
     <para>
      新しいデバイスのサイズを指定します。
     </para>
    </step>
    <step>
     <para>
      デバイスの追加オプションを指定します。デバイスのパラメータを微調整するには、<guimenu>詳細</guimenu>をクリックし、オブジェクトサイズ、ストライプユニット、またはストライプ数の値を入力します。QoS (サービス品質)の制限を入力するには、<guimenu>サービス品質</guimenu>をクリックし、制限値を入力します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>Create RBD (RBDの作成)</guimenu>をクリックして確認します。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dashboard-rbd-delete">
   <title>RBDの削除</title>
   <para>
    デバイスを削除するには、テーブルでそのデバイスの行をクリックし、テーブル見出しの左上の<guimenu>削除</guimenu>を選択します。<guimenu>Delete RBD (RBDの削除)</guimenu>をクリックして削除を確認します。
   </para>
   <tip>
    <title>RBDのごみ箱への移動</title>
    <para>
     RBDの削除は元に戻せないアクションです。代わりに<guimenu>ごみ箱に移動する</guimenu>を実行すると、後でメインテーブルの<guimenu>ごみ箱</guimenu>タブでデバイスを選択し、テーブル見出しの左上の<guimenu>復元</guimenu>をクリックしてデバイスを復元できます。
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dashboard-rbds-snapshots">
   <title>RADOS Block Deviceのスナップショット</title>
   <para>
    RADOS Block Deviceのスナップショットを作成するには、デバイスのテーブル行をクリックし、メインテーブルの下の<guimenu>スナップショット</guimenu>タブで、テーブル見出しの左上の<guimenu>作成</guimenu>をクリックします。スナップショットの名前を入力し、<guimenu>スナップショットの作成</guimenu>をクリックして確認します。
   </para>
   <para>
    スナップショットを選択した後で、デバイスの名前の変更、保護、複製、コピー、削除などの追加のアクションを実行できます。<guimenu>Rollback (ロールバック)</guimenu>は、現在のスナップショットからデバイスの状態を復元します。
   </para>
   <figure>
    <title>RBDのスナップショット</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_snapshots.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_snapshots.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-iscsi">
   <title>iSCSI Gatewayの管理</title>
   <tip>
    <title>iSCSI Gatewayについての詳細</title>
    <para>
     iSCSIの全般的な情報については、<xref linkend="cha-ceph-as-iscsi"/>および<xref linkend="cha-ceph-iscsi"/>を参照してください。
    </para>
   </tip>
   <para>
    利用可能なすべてのゲートウェイとマップ済みイメージを一覧にするには、メインメニューから<menuchoice><guimenu>ブロック</guimenu><guimenu>iSCSI</guimenu></menuchoice>をクリックします。<guimenu>概要</guimenu>タブを開くと、現在設定されているiSCSI Gatewayとマップ済みのRBDイメージが一覧にされます。
   </para>
   <para>
    <guimenu>ゲートウェイ</guimenu>テーブルには、各ゲートウェイの状態、iSCSIターゲットの数、およびセッションの数が一覧にされます。<guimenu>イメージ</guimenu>テーブルには、各マップ済みイメージの名前、関連するプール名のバックストアタイプ、および他の統計情報の詳細が一覧にされます。
   </para>
   <para>
    <guimenu>ターゲット</guimenu>タブには、現在設定されているiSCSIターゲットが一覧にされます。
   </para>
   <figure>
    <title>iSCSIターゲットのリスト</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_igws.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_igws.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    ターゲットに関する詳細情報を表示するには、そのテーブル行をクリックします。ツリー構造のスキーマが開き、ディスク、ポータル、イニシエータ、およびグループが一覧にされます。項目をクリックして展開し、その詳細コンテンツを表示します。オプションで右側の表に関連する設定が表示されます。
   </para>
   <figure>
    <title>iSCSIターゲット詳細</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3 xml:id="dashboard-iscsi-create">
    <title>iSCSIターゲットの追加</title>
    <para>
     新しいiSCSIターゲットを追加するには、<guimenu>ターゲット</guimenu>テーブルの左上の<guimenu>追加</guimenu>をクリックして、必要な情報を入力します。
    </para>
    <figure>
     <title>新しいターゲットの追加</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       新しいゲートウェイのターゲットアドレスを入力します。
      </para>
     </step>
     <step>
      <para>
       <guimenu>Add portal (ポータルの追加)</guimenu>をクリックして、リストから1つまたは複数のiSCSIポータルを選択します。
      </para>
     </step>
     <step>
      <para>
       <guimenu>Add image (イメージの追加)</guimenu>をクリックして、ゲートウェイのRBDイメージを1つまたは複数選択します。
      </para>
     </step>
     <step>
      <para>
       認証を使用してゲートウェイにアクセスする必要がある場合は、<guimenu>Authentication (認証)</guimenu>チェックボックスをオンにして資格情報を入力します。<guimenu>Mutual authentication (相互認証)</guimenu>および<guimenu>Discovery authentication (ディスカバリ認証)</guimenu>を有効にすると、より高度な認証オプションが表示されます。
      </para>
     </step>
     <step>
      <para>
       <guimenu>Create Target (ターゲットの作成)</guimenu>をクリックして確認します。
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="dashboard-iscsi-edit">
    <title>iSCSIターゲットの編集</title>
    <para>
     既存のiSCSIターゲットを編集するには、<guimenu>ターゲット</guimenu>テーブルでその行をクリックし、テーブルの左上の<guimenu>編集</guimenu>をクリックします。
    </para>
    <para>
     その後、iSCSIターゲットの追加、ポータルの追加または削除、および関連するRBDイメージの追加または削除を行うことができます。ゲートウェイの認証情報を調整することもできます。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-iscsi-delete">
    <title>iSCSIターゲットの削除</title>
    <para>
     iSCSIターゲットを削除するには、そのテーブル行をクリックし、ゲートウェイテーブルの左上の<guimenu>削除</guimenu>を選択します。<guimenu>はい</guimenu>を有効にして、<guimenu>Delete iSCSI (iSCSIの削除)</guimenu>をクリックして確認します。
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dash-rbd-qos">
   <title>RBD QoS (サービス品質)</title>
   <tip>
    <title>その他の情報</title>
    <para>
     RBD QoS設定オプションの全般的な情報と説明については、<xref linkend="rbd-qos"/>を参照してください。
    </para>
   </tip>
   <para>
    QoSオプションは次の複数のレベルで設定できます。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      グローバル
     </para>
    </listitem>
    <listitem>
     <para>
      プールごと
     </para>
    </listitem>
    <listitem>
     <para>
      イメージごと
     </para>
    </listitem>
   </itemizedlist>
   <para>
    <emphasis/>「グローバル」の設定はリストの一番上にあり、新しく作成されたすべてのRBDイメージと、プールまたはRBDイメージ層でこれらの値を上書きしないイメージに使用されます。グローバルに指定されたオプション値をプールごとまたはイメージごとに上書きできます。プールに対して指定されたオプションは、そのプールのすべてのRBDイメージに適用されます。ただし、イメージに対して設定された設定オプションで上書きされる場合を除きます。イメージに対して指定されたオプションは、プールに対して指定されたオプションを上書きし、グローバルに指定されたオプションを上書きします。
   </para>
   <para>
    このようにして、デフォルトをグローバルに定義して、特定のプールのすべてのRBDイメージに適合させ、個々のRBDイメージのプール設定を上書きできます。
   </para>
   <sect3 xml:id="dash-rbd-qos-global">
    <title>オプションのグローバルな設定</title>
    <para>
     RBDオプションをグローバルに設定するには、メインメニューから<menuchoice><guimenu>クラスタ</guimenu>
     <guimenu>設定</guimenu></menuchoice>を選択します。
    </para>
    <para>
     使用可能なすべてのグローバル設定オプションを一覧にするには、<menuchoice><guimenu>レベル</guimenu>
     <guimenu>詳細</guimenu></menuchoice>をクリックします。次に、検索フィールドで「rbd_qos」をフィルタリングして、テーブルの結果をフィルタします。これにより、QoSで使用可能なすべての設定オプションが一覧にされます。値を変更するには、テーブルでその行をクリックし、テーブルの左上の<guimenu>編集</guimenu>を選択します。<guimenu>編集</guimenu>ダイアログには、値を指定するための6つの異なるフィールドが含まれます。<guimenu>mgr</guimenu>テキストボックスには、RBD設定オプションの値を入力する必要があります。他のダイアログとは異なり、このダイアログでは便利な単位で値を指定できないことに注意してください。編集するオプションによっては、バイトまたはIOPSのいずれかでこれらの値を設定する必要があります。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-pool-create">
    <title>新しいプールでのオプションの設定</title>
    <para>
     新しいプールを作成し、そのプールにRBD設定オプションを設定するには、<menuchoice><guimenu>プール</guimenu>
     <guimenu>作成</guimenu></menuchoice>をクリックします。プールタイプとして<guimenu>replicated (複製)</guimenu>を選択します。RBD QoSオプションを設定できるようにするには、プールに<guimenu>rbd</guimenu>アプリケーションタグを追加する必要があります。
    </para>
    <note>
     <para>
      イレージャコーディングプールにRBD QoS設定オプションを設定することはできません。イレージャコーディングプールにRBD QoSオプションを設定するには、RBDイメージの複製されたメタデータプールを編集する必要があります。これにより、そのイメージのイレージャコーディングデータプールに設定が適用されます。
     </para>
    </note>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-pool-edit">
    <title>既存のプールでのオプションの設定</title>
    <para>
     既存のプールにRBD QoSオプションを設定するには、<guimenu>プール</guimenu>をクリックし、プールのテーブル行をクリックして、テーブルの左上の<guimenu>編集</guimenu>を選択します。
    </para>
    <para>
     ダイアログに<guimenu>RBD設定</guimenu>セクションが表示され、その後に<guimenu>サービス品質</guimenu>セクションが表示されます。
    </para>
    <note>
     <para>
      <guimenu>RBD設定</guimenu>セクションも<guimenu>サービス品質</guimenu>セクションも表示されない場合は、RBD設定オプションの設定に使用できない<emphasis/>「イレージャコーディング」プールを編集しているか、RBDイメージで使用するようにプールが設定されていない可能性があります。後者の場合は、<guimenu>RBD</guimenu>アプリケーションタグをプールに割り当てます。これにより、対応する設定セクションが表示されます。
     </para>
    </note>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-qos">
    <title>設定オプション</title>
    <para>
     設定オプションを展開するには、<guimenu>サービス品質+</guimenu>をクリックします。使用可能なすべてのオプションのリストが表示されます。設定オプションの単位は、テキストボックスにすでに表示されています。BPS (1秒あたりのバイト数)オプションの場合は、「1M」や「5G」などのショートカットを自由に使用できます。これらはそれぞれ自動的に「1MB/秒」と「5GB/秒」に変換されます。
    </para>
    <para>
     各テキストボックスの右にあるリセットボタンをクリックすると、プールに設定されている値が削除されます。グローバルに設定されたオプションやRBDイメージに設定されたオプションの設定値は削除されません。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-create">
    <title>新しいRBDイメージを使用したRBD QoSオプションの作成</title>
    <para>
     イメージにRBD QoSオプションが設定された状態でRBDイメージを作成するには、<menuchoice><guimenu>ブロック</guimenu>
     <guimenu>イメージ</guimenu></menuchoice>を選択し、<guimenu>作成</guimenu>をクリックします。詳細設定セクションを展開するには、<guimenu>詳細</guimenu>をクリックします。使用可能なすべての設定オプションを開くには、<guimenu>サービス品質</guimenu>をクリックします。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-edit">
    <title>既存のイメージでのRBD QoSの編集</title>
    <para>
     既存のイメージでRBD QoSオプションを編集するには、<menuchoice><guimenu>ブロック</guimenu>
     <guimenu>イメージ</guimenu></menuchoice>を選択し、プールのテーブル行をクリックして、最後に<guimenu>編集</guimenu>をクリックします。編集ダイアログが表示されます。詳細設定セクションを展開するには、<guimenu>詳細</guimenu>をクリックします。使用可能なすべての設定オプションを開くには、<guimenu>サービス品質</guimenu>をクリックします。
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-copy">
    <title>イメージをコピーまたは複製する際の設定オプションの変更</title>
    <para>
     RBDイメージを複製またはコピーする場合、デフォルトでは、その特定のイメージに設定された値もコピーされます。コピーまたは複製時にRBDイメージを変更する場合は、RBDイメージを作成または編集する場合と同様に、コピー/複製ダイアログで、更新された設定値を指定できます。この場合、コピーまたは複製するRBDイメージの値のみが設定(またはリセット)されます。この操作では、ソースRBDイメージの設定もグローバル設定も変更されません。
    </para>
    <para>
     コピー/複製時にオプションの値をリセットすることを選択した場合、そのオプションの値は、そのイメージに設定されません。つまり、親プールに値が設定されている場合、親プールに指定されたそのオプションの値が使用されます。親プールに値が設定されていない場合は、グローバルなデフォルトが使用されます。
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dash-rbd-mirror">
   <title>RBDミラーリング</title>
   <tip>
    <title>一般情報</title>
    <para>
     RADOS Block Deviceのミラーリングの一般情報とコマンドラインによるアプローチについては、<xref linkend="ceph-rbd-mirror"/>を参照してください。
    </para>
   </tip>
   <para>
    Cephダッシュボードを使用して、2つ以上のクラスタ間でRBDイメージを複製するよう設定できます。
   </para>
   <sect3 xml:id="rbd-mirror-primary-secondary">
    <title>プライマリクラスタとセカンダリクラスタ</title>
    <para>
     <emphasis/>「プライマリ」クラスタは、イメージを含む元のプールが作成される場所です。<emphasis/>「セカンダリ」クラスタは、「プライマリ」クラスタからプール/イメージが複製される場所です。<emphasis/>
    </para>
    <note>
     <title>相対命名</title>
     <para>
      <emphasis/>「プライマリ」および<emphasis/>「セカンダリ」という用語は、クラスタよりも個々のプールとの関連性が高いため、レプリケーションのコンテキストでは相対的に使用できます。たとえば、双方向レプリケーションにおいて、あるプールを<emphasis/>「プライマリ」クラスタから<emphasis/>「セカンダリ」クラスタにミラーリングし、別のプールを<emphasis/>「セカンダリ」クラスタから<emphasis/>「プライマリ」クラスタにミラーリングできます。
     </para>
    </note>
   </sect3>
   <sect3 xml:id="rbd-mirroring-replication-modes">
    <title>レプリケーションモード</title>
    <para>
     データレプリケーションのモードには次の2つがあります。
    </para>
    <itemizedlist>
     <listitem>
      <para>
       <emphasis/>「プール」モードを使用して、プール内のすべてのRBDイメージを複製します。
      </para>
     </listitem>
     <listitem>
      <para>
       <emphasis/>「イメージ」モードを使用して、プール内の特定のイメージに対してのみミラーリングを有効にできます。
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="rbd-mirror-gui-daemon">
    <title><systemitem class="daemon">rbd-mirror</systemitem>デーモンの設定</title>
    <para>
     <systemitem class="daemon">rbd-mirror</systemitem>デーモンは、クラスタデータの実際のレプリケーションを実行します。このデーモンをインストール、設定、および実行するには、次の手順に従います。
    </para>
    <procedure>
     <step>
      <para>
       <systemitem class="daemon">rbd-mirror</systemitem>デーモンは、管理ノード以外の「セカンダリ」<emphasis/>クラスタ上にあるノードの1つで実行する必要があります。このデーモンはデフォルトではインストールされないため、インストールします。
      </para>
<screen><prompt>root@minion &gt; </prompt>zypper install rbd-mirror</screen>
     </step>
     <step>
      <para>
       <emphasis/>「プライマリ」クラスタで、<systemitem class="daemon">rbd-mirror</systemitem>デーモンプロセス用に固有のCephユーザIDを作成します。この例では、ユーザIDとして「uid1」を使用します。
      </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph auth get-or-create client.rbd-mirror.uid1 \
 mon 'profile rbd-mirror' osd 'profile rbd'
[client.rbd-mirror.uid1]
	key = AQBbDJddZKLBIxAAdsmSCCjXoKwzGkGmCpUQ9g==</screen>
     </step>
     <step>
      <para>
       「セカンダリクラスタ」上にある、以前に
       <package>rbd-mirror</package> パッケージをインストールしたノードで、<emphasis/>同じCephユーザを作成し、キーリングに出力を保存します。
      </para>
<screen><prompt>root@minion &gt; </prompt>ceph auth get-or-create client.rbd-mirror.uid1 \
 mon 'profile rbd-mirror' osd 'profile rbd' \
 &gt; /etc/ceph/ceph.client.rbd-mirror.uid1.keyring</screen>
     </step>
     <step>
      <para>
       同じノードで、<systemitem class="daemon">rbd-mirror</systemitem>サービスを有効にして実行します。
      </para>
<screen><prompt>root@minion &gt; </prompt>systemctl enable ceph-rbd-mirror@rbd-mirror.uid1
<prompt>root@minion &gt; </prompt>systemctl start ceph-rbd-mirror@rbd-mirror.uid1
<prompt>root@minion &gt; </prompt>systemctl status ceph-rbd-mirror@rbd-mirror.uid1
● ceph-rbd-mirror@rbd-mirror.uid1.service - Ceph rbd mirror daemon
   Loaded: loaded (/usr/lib/systemd/system/ceph-rbd-mirror@.service; enabled; vendor preset: disabled)
   Active: active (running) since Fri 2019-10-04 07:48:53 EDT; 2 days ago
 Main PID: 212434 (rbd-mirror)
    Tasks: 47
   CGroup: /system.slice/system-ceph\x2drbd\x2dmirror.slice/ceph-rbd-mirror@rbd-mirror.uid1.service
           └─212434 /usr/bin/rbd-mirror -f --cluster ceph --id rbd-mirror.test --setuser ceph --setgroup ceph

Oct 04 07:48:53 doc-ses6min4 systemd[1]: Started Ceph rbd mirror daemon.
</screen>
     </step>
     <step>
      <para>
       <emphasis/>「セカンダリ」クラスタのCephダッシュボードで、<menuchoice><guimenu>ブロック</guimenu><guimenu>ミラーリング</guimenu></menuchoice>に移動します。左側の<guimenu>デーモン</guimenu>テーブルに、アクティブに実行されている<systemitem>rbd-mirror</systemitem>デーモンとそのヘルスが表示されます。
      </para>
      <figure>
       <title><systemitem class="daemon">rbd-mirror</systemitem>デーモンの実行</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-daemon.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-daemon.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="rbd-mirror-gui">
    <title>Cephダッシュボードでのプールのレプリケーションの設定</title>
    <para>
     RBDイメージをミラーリングできるようにするには、<systemitem class="daemon">rbd-mirror</systemitem>デーモンがプライマリクラスタへのアクセス権を持っている必要があります。したがって、プライマリクラスタに<emphasis/>「ピア」Cephユーザアカウントを作成し、セカンダリクラスタにそのキーリングについて知らせる必要があります。
    </para>
    <procedure>
     <step>
      <para>
       <emphasis/>「プライマリ」クラスタで、データレプリケーションに使用する新しい「client.rbd-mirror-peer」ユーザを作成します。
      </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph auth get-or-create client.rbd-mirror-peer \
 mon 'profile rbd' osd 'profile rbd'
[client.rbd-mirror-peer]
	key = AQBbDJddZKLBIxAAdsmSCCjXoKwzGkGmCpUQ9g==</screen>
     </step>
     <step>
      <para>
       <emphasis/>「プライマリ」および<emphasis/>「セカンダリ」クラスタの両方で同じ名前のプールを作成し、それに「rbd」アプリケーションを割り当てます。新しいプールの作成の詳細については、<xref linkend="dashboard-pools-create"/>を参照してください。
      </para>
      <figure>
       <title>RBDアプリケーションを使用したプールの作成</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       <emphasis/>「プライマリ」および<emphasis/>「セカンダリ」クラスタの両方のダッシュボードで、<menuchoice><guimenu>ブロック</guimenu><guimenu>ミラーリング</guimenu></menuchoice>に移動します。右側の<guimenu>プール</guimenu>テーブルで、複製するプールの名前をクリックし、<guimenu>モードの編集</guimenu>をクリックした後で、レプリケーションモードを選択します。この例では、<emphasis/>「プール」レプリケーションモードを使用します。つまり、指定したプール内のすべてのイメージが複製されます。<guimenu>更新</guimenu>をクリックして確認します。
      </para>
      <figure>
       <title>レプリケーションモードの設定</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-mode.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-mode.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <important>
       <title>プライマリクラスタでのエラーまたは警告</title>
       <para>
        レプリケーションモードを更新すると、対応する右側の列にエラーまたは警告フラグが表示されます。これは、まだプールにレプリケーション用のピアユーザが割り当てられていないためです。ピアユーザは<emphasis/>「セカンダリ」クラスタにのみ割り当てるので、<emphasis/>「プライマリ」クラスタではこのフラグは無視してください。
       </para>
      </important>
     </step>
     <step>
      <para>
       <emphasis/>「セカンダリ」クラスタのダッシュボードで、<menuchoice><guimenu>ブロック</guimenu><guimenu>ミラーリング</guimenu></menuchoice>に移動します。プールの名前をクリックして、<guimenu>ピアの追加</guimenu>を選択し、ユーザキーリング「client.rbd-mirror-peer」をミラーリングされたプールに登録します。<emphasis/>「プライマリ」クラスタの詳細を指定します。
      </para>
      <figure>
       <title>ピア資格情報の追加</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-peer.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-peer.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <variablelist>
       <varlistentry>
        <term><guimenu>クラスタ名</guimenu></term>
        <listitem>
         <para>
          プライマリクラスタを識別する任意の固有の文字列(「primary」など)。このクラスタ名は、実際のセカンダリクラスタの名前とは異なる必要があります。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>CephX ID</guimenu></term>
        <listitem>
         <para>
          ミラーリングピアとして作成したCephユーザID。この例では、「rbd-mirror-peer」です。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>モニターアドレス</guimenu></term>
        <listitem>
         <para>
          プライマリクラスタのCeph MonitorノードのIPアドレス/ホスト名のカンマ区切りリスト。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>CephXキー</guimenu></term>
        <listitem>
         <para>
          ピアユーザIDに関連したキー。このキーを取得するには、プライマリクラスタで次のサンプルコマンドを実行します。
         </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph auth print_key client.rbd-mirror-peer</screen>
        </listitem>
       </varlistentry>
      </variablelist>
      <para>
       <guimenu>送信</guimenu>をクリックして確認します。
      </para>
      <figure>
       <title>複製されたプールのリスト</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-list.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-list.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="rbd-mirror-test">
    <title>RBDイメージのレプリケーションが機能することの確認</title>
    <para>
     <systemitem class="daemon">rbd-mirror</systemitem>デーモンが実行されていて、CephダッシュボードでRBDイメージレプリケーションが設定されている場合、ここで、レプリケーションが実際に機能するかどうかを確認します。
    </para>
    <procedure>
     <step>
      <para>
       <emphasis/>「プライマリ」クラスタのCephダッシュボードで、RBDイメージを作成し、その親プールが、レプリケーション用にすでに作成済みのプールになるようにします。イメージに対して［<option>排他ロック</option>］機能と［<option>ジャーナリング</option>］機能を有効にします。RBDイメージの作成方法の詳細については、<xref linkend="dashboard-rbds-create"/>を参照してください。
      </para>
      <figure>
       <title>新しいRBDイメージ</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-image.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-image.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       複製するイメージを作成した後で、<emphasis/>「セカンダリ」クラスタのCephダッシュボードを開き、<menuchoice><guimenu>ブロック</guimenu><guimenu>ミラーリング</guimenu></menuchoice>に移動します。右側の<guimenu>プール</guimenu>テーブルは、<guimenu>#リモート</guimenu>イメージの数の変更を反映し、<guimenu>#ローカル</guimenu>イメージの数を同期します。
      </para>
      <figure>
       <title>新しいRBDイメージが同期される</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-list-1.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-list-1.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <tip>
       <title>レプリケーションの進行状況</title>
       <para>
        ページ下部の<guimenu>イメージ</guimenu>テーブルには、RBDイメージのレプリケーションのステータスが表示されます。<guimenu>問題</guimenu>タブには、考えられる問題が含まれており、<guimenu>同期中</guimenu>タブには、イメージのレプリケーションの進行状況が表示され、<guimenu>準備完了</guimenu>タブには、レプリケーションが正常に完了したすべてのイメージが一覧にされます。
       </para>
       <figure>
        <title>RBDイメージのレプリケーションステータス</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="rbd-mirror-images-status.png" width="75%"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="rbd-mirror-images-status.png" width="75%"/>
         </imageobject>
        </mediaobject>
       </figure>
      </tip>
     </step>
     <step>
      <para>
       <emphasis/>「プライマリ」クラスタで、データをRBDイメージに書き込みます。<emphasis/>「セカンダリ」クラスタのCephダッシュボードで、<menuchoice><guimenu>ブロック</guimenu><guimenu>イメージ</guimenu></menuchoice>に移動して、プライマリクラスタのデータが書き込まれるにつれて、対応するイメージのサイズが大きくなっているかどうかを監視します。
      </para>
     </step>
    </procedure>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dash-webui-nfs">
  <title>NFS Ganeshaの管理</title>

  <tip>
   <title>NFS Ganeshaについての詳細</title>
   <para>
    NFS Ganeshaの全般的な情報については、<xref linkend="cha-ceph-nfsganesha"/>を参照してください。
   </para>
  </tip>

  <para>
   利用可能なすべてのNFSエクスポートを一覧にするには、メインメニューから<guimenu>NFS</guimenu>をクリックします。
  </para>

  <para>
   各エクスポートのディレクトリ、デーモンのホスト名、ストレージバックエンドのタイプ、およびアクセスタイプがリストに表示されます。
  </para>

  <figure>
   <title>NFSエクスポートのリスト</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   NFSエクスポートの詳細情報を表示するには、テーブルでそのテーブル行をクリックします。
  </para>

  <figure>
   <title>NFSエクスポートの詳細</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="dash-webui-nfs-create">
   <title>NFSエクスポートの追加</title>
   <para>
    新しいNFSエクスポートを追加するには、エクスポートテーブルの左上で<guimenu>Add (追加)</guimenu>をクリックして、必要な情報を入力します。
   </para>
   <figure>
    <title>新しいNFSエクスポートの追加</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      エクスポートを実行するNFS Ganeshaデーモンを1つ以上選択します。
     </para>
    </step>
    <step>
     <para>
      ストレージバックエンドを選択します。<guimenu>CephFS</guimenu>または<guimenu>Object Gateway</guimenu>のいずれかを選択します。
     </para>
    </step>
    <step>
     <para>
      ユーザIDと、その他のバックエンド関連オプションを選択します。
     </para>
    </step>
    <step>
     <para>
      NFSエクスポートのディレクトリパスを入力します。指定したディレクトリがサーバ上に存在しない場合、新しく作成されます。
     </para>
    </step>
    <step>
     <para>
      他のNFS関連オプションを指定します。たとえば、サポートされるNFSプロトコルのバージョン、疑似、アクセスタイプ、スカッシュ、トランスポートプロトコルなどです。
     </para>
    </step>
    <step>
     <para>
      アクセスを特定のクライアントだけに制限する必要がある場合、<guimenu>クライアントの追加</guimenu>をクリックして、クライアントのIPアドレスと共に、アクセスタイプと(ルート権限無効化オプションを指定します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>送信</guimenu>をクリックして確認します。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dash-webui-nfs-delete">
   <title>NFSエクスポートの削除</title>
   <para>
    エクスポートを削除するには、そのテーブル行をクリックし、エクスポートテーブルの左上の<guimenu>削除</guimenu>を選択します。
   </para>
  </sect2>

  <sect2 xml:id="dash-webui-nfs-edit">
   <title>NFSエクスポートの編集</title>
   <para>
    既存のエクスポートを編集するには、そのテーブル行をクリックし、エクスポートテーブルの左上の<guimenu>編集</guimenu>をクリックします。
   </para>
   <para>
    その後、NFSエクスポートのすべての詳細を調整できます。
   </para>
   <figure>
    <title>NFSエクスポートの編集</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-mds">
  <title>Cephファイルシステムの管理</title>

  <tip>
   <title>その他の情報</title>
   <para>
    CephFSの詳細情報については、<xref linkend="cha-ceph-cephfs"/>を参照してください。
   </para>
  </tip>

  <sect2 xml:id="dashboard-mds-overview">
   <title>CephFSの概要の表示</title>
   <para>
    設定されているファイルシステムの概要を表示するには、メインメニューから<guimenu>ファイルシステム</guimenu>をクリックします。メインテーブルには、各ファイルシステムの名前、作成日、および有効かどうか表示されます。
   </para>
   <para>
    ファイルシステムのテーブル行をクリックすると、そのランクと、ファイルシステムに追加されたプールの詳細が表示されます。
   </para>
   <figure>
    <title>CephFSの詳細</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_cephfs_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_cephfs_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    画面の下部に、関連するMDS iノードとクライアント要求の数をリアルタイムで収集した統計情報カウントが表示されます。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-ogw">
  <title>Object Gatewayの管理</title>

  <tip>
   <title>Object Gatewayについての詳細</title>
   <para>
    Object Gatewayの全般的な情報については、<xref linkend="cha-ceph-gw"/>を参照してください。
   </para>
  </tip>

  <sect2 xml:id="dashboard-ogw-view">
   <title>Object Gatewayの表示</title>
   <para>
    設定されているObject Gatewayのリストを表示するには、<menuchoice><guimenu>オブジェクトゲートウェイ</guimenu><guimenu>デーモン</guimenu></menuchoice>をクリックします。このリストには、ゲートウェイのID、ゲートウェイデーモンが実行されているクラスタノードのホスト名、およびゲートウェイのバージョン番号が含まれます。
   </para>
   <para>
    ゲートウェイの詳細情報を表示するには、そのゲートウェイのテーブル行をクリックします。<guimenu>パフォーマンスカウンタ</guimenu>タブには、読み込み/書き込み操作とキャッシュ統計情報の詳細が表示されます。
   </para>
   <figure>
    <title>ゲートウェイの詳細</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_ogw_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_ogw_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-ogw-user">
   <title>Object Gatewayユーザの管理</title>
   <para>
    既存のObject Gatewayユーザのリストを表示するには、<menuchoice><guimenu>オブジェクトゲートウェイ</guimenu><guimenu>ユーザ</guimenu></menuchoice>をクリックします。
   </para>
   <para>
    ユーザのテーブル行をクリックすると、ステータス情報、ユーザとバケットクォータの詳細など、ユーザアカウントの詳細が表示されます。
   </para>
   <figure>
    <title>ゲートウェイユーザ</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_ogw_users_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_ogw_users_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3 xml:id="dashboard-ogw-user-create">
    <title>新しい Gatewayユーザの追加</title>
    <para>
     新しいゲートウェイユーザを追加するには、テーブル見出しの左上の<guimenu>追加</guimenu>をクリックします。資格情報、S3キーとユーザ/バケットクォータの詳細を入力し、<guimenu>追加</guimenu>をクリックして確認します。
    </para>
    <figure>
     <title>新しい Gatewayユーザの追加</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_ogw_user_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_ogw_user_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3 xml:id="dashboard-ogw-user-delete">
    <title>ゲートウェイユーザの削除</title>
    <para>
     ゲートウェイユーザを削除するには、そのユーザのテーブル行をクリックし、テーブル見出しの左上の<guimenu>削除</guimenu>を選択します。<guimenu>はい</guimenu>チェックボックスをオンにし、<guimenu>Delete User (ユーザの削除)</guimenu>をクリックして確認します。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-user-edit">
    <title>ゲートウェイユーザの詳細の編集</title>
    <para>
     ゲートウェイユーザの詳細を変更するには、そのユーザのテーブル行をクリックし、テーブル見出しの左上の<guimenu>編集</guimenu>を選択します。
    </para>
    <para>
     機能、キー、サブユーザ、クォータ情報など、基本または追加のユーザ情報を変更します。<guimenu>更新</guimenu>をクリックして確認します。
    </para>
    <para>
     <guimenu>キー</guimenu>タブには、ゲートウェイユーザ、およびそのアクセスキーと秘密鍵の読み込み専用リストが含まれます。キーを表示するには、リストでユーザ名をクリックし、テーブル見出しの左上の<guimenu>表示</guimenu>を選択します。<guimenu>S3キー</guimenu>ダイアログで、「目」のアイコンをクリックしてキーを表示するか、クリップボードアイコンをクリックして関連するキーをクリップボードにコピーします。
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-ogw-bucket">
   <title>Object Gatewayバケットの管理</title>
   <para>
    OGW (Object Gateway)バケットは、OpenStack Swiftコンテナの機能を実装しています。Object Gatewayバケットは、データオブジェクトを保存するためのコンテナとして機能します。
   </para>
   <para>
    <menuchoice><guimenu>オブジェクトゲートウェイ</guimenu><guimenu>バケット</guimenu></menuchoice>をクリックして、OGWバケットのリストを表示します。
   </para>
   <sect3 xml:id="dashboard-ogw-bucket-create">
    <title>新しいバケットの追加</title>
    <para>
     新しいOGWバケットを追加するには、テーブル見出しの左上の<guimenu>追加</guimenu>をクリックします。バケット名を入力し、その所有者を選択します。<guimenu>追加</guimenu>をクリックして確認してください。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-view">
    <title>バケットの詳細の表示</title>
    <para>
     OGWバケットの詳細情報を表示するには、そのテーブル行をクリックします。
    </para>
    <figure>
     <title>ゲートウェイバケットの詳細</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_ogw_bucket_details.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_ogw_bucket_details.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <tip>
     <title>バケットクォータ</title>
     <para>
      <guimenu>詳細</guimenu>テーブルの下で、バケットクォータ設定の詳細を確認できます。
     </para>
    </tip>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-edit">
    <title>バケットの所有者の更新</title>
    <para>
     バケットのテーブル行をクリックし、テーブル見出しの左上の<guimenu>編集</guimenu>を選択します。
    </para>
    <para>
     バケットの所有者を更新し、<guimenu>更新</guimenu>をクリックして確認します。
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-delete">
    <title>バケットの削除</title>
    <para>
     OGWバケットを削除するには、そのテーブル行をクリックし、テーブル見出しの左上の<guimenu>削除</guimenu>を選択します。<guimenu>はい</guimenu>チェックボックスをオンにし、<guimenu>Delete bucket (バケットの削除)</guimenu>をクリックして確認します。
    </para>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-initial-configuration">
  <title>手動設定</title>

  <para>
   このセクションでは、コマンドラインでダッシュボードを手動で設定したいユーザ向けの詳細情報を紹介します。
  </para>

  <sect2 xml:id="dashboard-ssl">
   <title>TLS/SSLのサポート</title>
   <para>
    ダッシュボードとのすべてのHTTP接続は、デフォルトでSSL/TLSによって保護されています。セキュア接続にはSSL証明書が必要です。自己署名証明書を使用することも、証明書を生成して既知のCA (認証局)で署名することもできます。
   </para>
   <tip>
    <title>SSLの無効化</title>
    <para>
     特定の理由がある場合、SSLのサポートを無効にできます。たとえば、SSLをサポートしないプロキシの後方でダッシュボードを実行する場合などです。
    </para>
    <para>
     SSLを無効にする場合は注意してください。「ユーザ名とパスワード」<emphasis role="bold"/>は「暗号化されずに」<emphasis role="bold"/>ダッシュボードに送信されます。
    </para>
    <para>
     SSLを無効にするには、次のコマンドを実行します。
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/ssl false
</screen>
   </tip>
   <tip>
    <title>Ceph Managerプロセスの再起動</title>
    <para>
     SSL証明書とキーを変更した後で、Ceph Managerプロセスを手動で再起動する必要があります。このためには、次のコマンドを実行します。
    </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph mgr fail<replaceable>ACTIVE-MANAGER-NAME</replaceable></screen>
    <para>
     または、ダッシュボードモジュールを無効化して再度有効化することもできます。この場合、マネージャが自身を再起動します。
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph mgr module disable dashboard
<prompt>cephadm@adm &gt; </prompt>ceph mgr module enable dashboard
</screen>
   </tip>
   <sect3 xml:id="self-sign-certificates">
    <title>自己署名証明書</title>
    <para>
     セキュア通信用の自己署名証明書の作成は簡単です。これにより、ダッシュボードの実行を高速化できます。
    </para>
    <note>
     <title>Webブラウザでの警告の表示</title>
     <para>
      ほとんどのWebブラウザでは、自己署名証明書を使用すると警告が表示され、ダッシュボードへのセキュアな接続を確立するには明示的に確認する必要があります。
     </para>
    </note>
    <para>
     自己署名証明書を生成してインストールするには、次の組み込みコマンドを使用します。
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard create-self-signed-cert
</screen>
   </sect3>
   <sect3 xml:id="cert-sign-CA">
    <title>CAによって署名された証明書</title>
    <para>
     ダッシュボードへの接続を適切に保護し、Webブラウザで自己署名証明書に関する警告が表示されないようにするため、CAによって署名された証明書を使用することをお勧めします。
    </para>
    <para>
     次のようなコマンドを使用して証明書キーペアを生成できます。
    </para>
<screen>
<prompt>root # </prompt>openssl req -new -nodes -x509 \
  -subj "/O=IT/CN=ceph-mgr-dashboard" -days 3650 \
  -keyout dashboard.key -out dashboard.crt -extensions v3_ca
</screen>
    <para>
     上のコマンドは、<filename>dashboard.key</filename>ファイルと<filename>dashboard.crt</filename>ファイルを出力します。<filename>dashboard.crt</filename>ファイルがCAによって署名されたら、次のコマンドを実行して、すべてのCeph Managerインスタンスに対してその証明書を有効にします。
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/crt -i dashboard.crt
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/key -i dashboard.key
</screen>
    <tip>
     <title>各マネージャインスタンスに対して異なる証明書が必要な場合</title>
     <para>
      Ceph Managerの各インスタンスに対して異なる証明書が必要な場合は、次のようにコマンドを変更してインスタンスの名前を含めます。<replaceable>NAME</replaceable>は、Ceph Managerインスタンスの名前(通常は関連するホスト名)で置き換えます。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/crt -i dashboard.crt
<prompt>cephadm@adm &gt; </prompt>ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/key -i dashboard.key
</screen>
    </tip>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-hostname-port">
   <title>ホスト名とポート番号</title>
   <para>
    CephダッシュボードWebアプリケーションは、特定のTCP/IPアドレスとTCPポートにバインドされます。デフォルトでは、ダッシュボードをホストする現在アクティブなCeph Managerは、TCPポート8443 (SSLが無効な場合は8080)にバインドされます。
   </para>
   <para>
    ダッシュボードWebアプリケーションは、デフォルトで「::」にバインドされます。これは、使用可能なすべてのIPv4およびIPv6アドレスに対応します。次のコマンドを使用すると、すべてのCeph Managerインスタンスに適用されるようにWebアプリケーションのIPアドレスとポート番号を変更できます。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/server_addr <replaceable>IP_ADDRESS</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   <tip>
    <title>Ceph Managerインスタンスの個別の設定</title>
    <para>
     各<systemitem class="daemon">ceph-mgr</systemitem>デーモンは専用のダッシュボードインスタンスをホストするため、インスタンスを個別に設定しなければならない場合があります。次のコマンドを使用して、特定のマネージャインスタンスのIPアドレスとポート番号を変更します(<replaceable>NAME</replaceable>を<systemitem class="daemon">ceph-mgr</systemitem>のIDで置き換えます)。
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_addr <replaceable>IP_ADDRESS</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   </tip>
   <tip>
    <title>設定されているエンドポイントの一覧</title>
    <para>
     <command>ceph mgr services</command>コマンドは、現在設定されているすべてのエンドポイントを表示します。「dashboard」キーを検索して、ダッシュボードにアクセスするためのURLを取得します。
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dashboard-username-password">
   <title>ユーザ名とパスワード</title>
   <para>
    デフォルトの管理者アカウントを使用しない場合は、別のユーザアカウントを作成して、それを少なくとも1つの役割に関連付けます。事前定義済みの一連のシステム役割が用意されており、これらの役割を使用できます。詳細については、<xref linkend="dashboard-user-roles"/>を参照してください。
   </para>
   <para>
    管理者特権を持つユーザを作成するには、次のコマンドを使用します。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-create <replaceable>USER_NAME</replaceable> <replaceable>PASSWORD</replaceable> administrator
</screen>
  </sect2>

  <sect2 xml:id="dashboard-ogw-enabling">
   <title>Object Gateway管理フロントエンドの有効化</title>
   <para>
    ダッシュボードのObject Gateway管理機能を使用するには、「system」フラグが有効なユーザのログインアカウント情報を指定する必要があります。
   </para>
   <procedure>
    <step>
     <para>
      「system」フラグが設定されたユーザがいない場合は、作成します。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>radosgw-admin user create --uid=<replaceable>USER_ID</replaceable> --display-name=<replaceable>DISPLAY_NAME</replaceable> --system
</screen>
     <para>
      コマンドの出力で「access_key」および「secret_key」のキーを記録します。
     </para>
    </step>
    <step>
     <para>
      <command>radosgw-admin</command>コマンドを使用して、既存のユーザの資格情報を取得することもできます。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>radosgw-admin user info --uid=<replaceable>USER_ID</replaceable>
</screen>
    </step>
    <step>
     <para>
      受け取った資格情報をダッシュボードに提供します。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-access-key <replaceable>ACCESS_KEY</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-secret-key <replaceable>SECRET_KEY</replaceable>
</screen>
    </step>
   </procedure>
   <para>
    考慮すべき点がいくつかあります。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Object Gatewayのホスト名とポート番号は自動的に決定されます。
     </para>
    </listitem>
    <listitem>
     <para>
      複数のゾーンを使用している場合、マスタゾーングループとマスタゾーン内のホストは自動的に決定されます。ほとんどのセットアップではこれで十分ですが、状況によってはホスト名とポートを手動で設定したい場合があります。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-host <replaceable>HOST</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-port <replaceable>PORT</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      次の追加設定が必要になる場合があります。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-scheme <replaceable>SCHEME</replaceable>  # http or https
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-admin-resource <replaceable>ADMIN_RESOURCE</replaceable>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-user-id <replaceable>USER_ID</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      Object Gatewayのセットアップで自己署名証明書(<xref linkend="dashboard-ssl"/>)を使用している場合は、不明なCAによって署名された証明書、またはホスト名が一致しないことによって接続が拒否されないようにするため、ダッシュボードで証明書の検証を無効にします。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rgw-api-ssl-verify False
</screen>
    </listitem>
    <listitem>
     <para>
      Object Gatewayで要求の処理に時間がかかりすぎて、ダッシュボードがタイムアウトする場合は、タイムアウト値を調整できます(デフォルトは45秒)。
     </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-rest-requests-timeout <replaceable>SECONDS</replaceable>
</screen>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="dashboard-sso">
   <title>シングルサインオンの有効化</title>
   <para>
    <emphasis/>SSO (「シングルサインオン」)は、ユーザが複数のアプリケーションに1つのIDとパスワードで同時にログインできるアクセス制御方法です。
   </para>
   <para>
    Cephダッシュボードは、SAML 2.0プロトコルを介したユーザの外部認証をサポートしています。<emphasis/>「権限付与」は引き続きダッシュボードによって実行されるため、まずユーザアカウントを作成し、それを目的の役割に関連付ける必要があります。ただし、<emphasis/>「認証」プロセスは、既存の<emphasis/>IdP (「Identity Provider」)によって実行できます。
   </para>
   <para>
    シングルサインオンを設定するには、次のコマンドを使用します。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso setup saml2 <replaceable>CEPH_DASHBOARD_BASE_URL</replaceable> \
 <replaceable>IDP_METADATA</replaceable> <replaceable>IDP_USERNAME_ATTRIBUTE</replaceable> \
 <replaceable>IDP_ENTITY_ID</replaceable> <replaceable>SP_X_509_CERT</replaceable> \
 <replaceable>SP_PRIVATE_KEY</replaceable>
</screen>
   <para>
    パラメータ:
   </para>
   <variablelist>
    <varlistentry>
     <term><replaceable>CEPH_DASHBOARD_BASE_URL</replaceable></term>
     <listitem>
      <para>
       Cephダッシュボードにアクセス可能なベースURL(たとえば、「https://cephdashboard.local」)。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_METADATA</replaceable></term>
     <listitem>
      <para>
       IdPメタデータXMLのURL、ファイルパス、または内容(たとえば、「https://myidp/metadata」)。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_USERNAME_ATTRIBUTE</replaceable></term>
     <listitem>
      <para>
       オプション。認証応答からユーザ名を取得するために使用される属性。デフォルトは「uid」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_ENTITY_ID</replaceable></term>
     <listitem>
      <para>
       オプション。IdPメタデータに複数のエンティティIDが存在する場合に使用します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>SP_X_509_CERT</replaceable> / <replaceable>SP_PRIVATE_KEY</replaceable></term>
     <listitem>
      <para>
       オプション。署名と暗号化のためにCephダッシュボード(サービスプロバイダ)によって使用される証明書のファイルパスまたは内容。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <note>
    <title>SAML要求</title>
    <para>
     SAML要求の発行者の値は次のパターンに従います。
    </para>
<screen>
<replaceable>CEPH_DASHBOARD_BASE_URL</replaceable>/auth/saml2/metadata
</screen>
   </note>
   <para>
    SAML 2.0の現在の設定を表示するには、次のコマンドを実行します。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso show saml2
</screen>
   <para>
    シングルサインオンを無効にするには、次のコマンドを実行します。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso disable
</screen>
   <para>
    SSOが有効かどうかを確認するには、次のコマンドを実行します。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso status
</screen>
   <para>
    SSOを有効にするには、次のコマンドを実行します。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard sso enable saml2
</screen>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-user-roles">
  <title>コマンドラインでのユーザと役割の管理</title>

  <para>
   このセクションでは、Cephダッシュボードによって使用されるユーザアカウントを管理する方法について説明します。これは、ユーザアカウントを作成または変更する場合や、適切なユーザ役割と許可を設定する場合に役立ちます。
  </para>

  <sect2 xml:id="dahsboard-user-accounts">
   <title>ユーザアカウント</title>
   <para>
    Cephダッシュボードは、複数のユーザアカウントの管理をサポートしています。各ユーザアカウントは、ユーザ名、パスワード(<literal>bcrypt</literal>を使用して暗号化された形式で保存)、オプションの名前、およびオプションの電子メールアドレスで構成されます。
   </para>
   <para>
    ユーザアカウントはCeph Monitorの設定データベースに保存され、すべてのCeph Managerインスタンス間でグローバルに共有されます。
   </para>
   <para>
    ユーザアカウントを管理するには、次のコマンドを使用します。
   </para>
   <variablelist>
    <varlistentry>
     <term>既存のユーザの表示</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-show [<replaceable>USERNAME</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>新しいユーザの作成</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-create <replaceable>USERNAME</replaceable> [<replaceable>PASSWORD</replaceable>] [<replaceable>ROLENAME</replaceable>] [<replaceable>NAME</replaceable>] [<replaceable>EMAIL</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>ユーザの削除</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-delete <replaceable>USERNAME</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>ユーザのパスワードの変更</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-password <replaceable>USERNAME</replaceable> <replaceable>PASSWORD</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>ユーザの名前と電子メールの変更</term>
     <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-info <replaceable>USERNAME</replaceable> <replaceable>NAME</replaceable> <replaceable>EMAIL</replaceable>
</screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard-permissions">
   <title>ユーザの役割と許可</title>
   <para>
    このセクションでは、ユーザの役割に割り当てることができるセキュリティスコープ、ユーザの役割を管理する方法、およびユーザの役割をユーザアカウントに割り当てる方法について説明します。
   </para>
   <sect3>
    <title>セキュリティスコープ</title>
    <para>
     ユーザアカウントは、ユーザがダッシュボードのどの部分にアクセスできるかを定義する一連の役割に関連付けられます。ダッシュボードの各部分は、<emphasis/>「セキュリティ」スコープ内でグループ化されます。セキュリティスコープは事前定義されていて静的です。現在のところ、次のセキュリティスコープを使用できます。
    </para>
    <variablelist>
     <varlistentry>
      <term>hosts</term>
      <listitem>
       <para>
        <guimenu>ホスト</guimenu>メニューエントリに関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>config-opt</term>
      <listitem>
       <para>
        Ceph設定オプションの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool</term>
      <listitem>
       <para>
        プールの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>osd</term>
      <listitem>
       <para>
        Ceph OSDの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>monitor</term>
      <listitem>
       <para>
        Ceph Monitorの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-image</term>
      <listitem>
       <para>
        RADOS Block Deviceイメージの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-mirroring</term>
      <listitem>
       <para>
        RADOS Block Deviceのミラーリングの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>iscsi</term>
      <listitem>
       <para>
        iSCSIの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw</term>
      <listitem>
       <para>
        Object Gatewayの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs</term>
      <listitem>
       <para>
        CephFSの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>manager</term>
      <listitem>
       <para>
        Ceph Managerの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>log</term>
      <listitem>
       <para>
        Cephのログの管理に関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>grafana</term>
      <listitem>
       <para>
        Grafanaプロキシに関連するすべての機能が含まれます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>dashboard-settings</term>
      <listitem>
       <para>
        ダッシュボードの設定を変更できます。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>ユーザの役割</title>
    <para>
     「役割」<emphasis/>は、<emphasis/>「セキュリティスコープ」と一連の<emphasis/>「許可」との間の一連のマッピングを指定するものです。許可には、「read」、「create」、「update」、および「delete」の4つのタイプがあります。
    </para>
    <para>
     次の例では、ユーザがプールの管理に関連する機能に対して「read」許可と「create」許可を持ち、RBDイメージの管理に関連する機能に対して完全な許可を持つ役割を指定します。
    </para>
<screen>
{
  'role': 'my_new_role',
  'description': 'My new role',
  'scopes_permissions': {
    'pool': ['read', 'create'],
    'rbd-image': ['read', 'create', 'update', 'delete']
  }
}
</screen>
    <para>
     ダッシュボードには、<emphasis/>「システム役割」と呼ばれる、事前定義済みの一連の役割があらかじめ用意されています。これらの役割は、Cephダッシュボードを新規インストールした後ですぐに使用できます。
    </para>
    <variablelist>
     <varlistentry>
      <term>administrator</term>
      <listitem>
       <para>
        すべてのセキュリティスコープに対する完全な許可を提供します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>read-only</term>
      <listitem>
       <para>
        ダッシュボード設定を除くすべてのセキュリティスコープの読み込み許可を提供します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>block-manager</term>
      <listitem>
       <para>
        「rbd-image」、「rbd-mirroring」、および「iscsi」のスコープに対する完全な許可を提供します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw-manager</term>
      <listitem>
       <para>
        「rgw」スコープに対する完全な許可を提供します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cluster-manager</term>
      <listitem>
       <para>
        「hosts」、「osd」、「monitor」、「manager」、および「config-opt」のスコープに対する完全な許可を提供します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool-manager</term>
      <listitem>
       <para>
        「pool」スコープに対する完全な許可を提供します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs-manager</term>
      <listitem>
       <para>
        「cephfs」スコープに対する完全な許可を提供します。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <sect4>
     <title>カスタム役割の管理</title>
     <para>
      次のコマンドを使用して、新しいユーザの役割を作成できます。
     </para>
     <variablelist>
      <varlistentry>
       <term>新規ロール(役割)を作成します:</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-create <replaceable>ROLENAME</replaceable> [<replaceable>DESCRIPTION</replaceable>]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>役割の削除:</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-delete <replaceable>ROLENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>役割へのスコープ許可の追加</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-add-scope-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable> <replaceable>PERMISSION</replaceable> [<replaceable>PERMISSION</replaceable>...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>役割からのスコープ許可の削除</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-del-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
    </sect4>
    <sect4>
     <title>ユーザアカウントへの役割の割り当て</title>
     <para>
      役割をユーザに割り当てるには、次のコマンドを使用します。
     </para>
     <variablelist>
      <varlistentry>
       <term>ユーザの役割の設定</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>ユーザへの追加の役割の追加</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-add-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>ユーザからの役割の削除</term>
       <listitem>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-del-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
     <tip>
      <title>カスタム役割の消去</title>
      <para>
       カスタム役割を作成し、後で<command>ceph.purge</command>ランナを使ってCephクラスタを削除する場合、まずカスタム役割を消去する必要があります。詳細については、<xref linkend="deepsea-ceph-purge"/>を参照してください。
      </para>
     </tip>
    </sect4>
    <sect4>
     <title>例: ユーザとカスタム役割の作成</title>
     <para>
      このセクションでは、RBDイメージの管理、Cephプールの表示と作成、および他のスコープへの読み込み専用アクセスを行うことができるユーザアカウントの作成手順について説明します。
     </para>
     <procedure>
      <step>
       <para>
        「tux」という名前の新しいユーザを作成します。
       </para>
<screen>
 <prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-create tux <replaceable>PASSWORD</replaceable>
</screen>
      </step>
      <step>
       <para>
        役割を作成し、スコープ許可を指定します。
       </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-create rbd/pool-manager
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-add-scope-perms rbd/pool-manager \
 rbd-image read create update delete
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-role-add-scope-perms rbd/pool-manager pool read create
</screen>
      </step>
      <step>
       <para>
        役割を「tux」ユーザに関連付けます。
       </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard ac-user-set-roles tux rbd/pool-manager read-only
</screen>
      </step>
     </procedure>
    </sect4>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-proxy">
   <title>リバースプロキシ</title>
   <para>
    リバースプロキシ設定を使用してダッシュボードにアクセスしている場合は、URLプレフィックスを使用してダッシュボードを提供しなければならないことがあります。ダッシュボードがプレフィックスを含むハイパーリンクを使用できるようにするには、<option>url_prefix</option>設定を設定できます。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph config set mgr mgr/dashboard/url_prefix <replaceable>URL_PREFIX</replaceable>
</screen>
   <para>
    これにより、<literal>http://<replaceable>HOST_NAME</replaceable>:<replaceable>PORT_NUMBER</replaceable>/<replaceable>URL_PREFIX</replaceable>/</literal>でダッシュボードにアクセスできます。
   </para>
  </sect2>

  <sect2 xml:id="dashboard-auditing">
   <title>監査</title>
   <para>
    CephダッシュボードのREST APIは、PUT、POST、およびDELETEの各要求をCeph監査ログに記録できます。ログはデフォルトでは無効ですが、次のコマンドで有効にできます。
   </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-audit-api-enabled true
</screen>
   <para>
    ログが有効な場合、要求ごとに次のパラメータがログに記録されます。
   </para>
   <variablelist>
    <varlistentry>
     <term>from</term>
     <listitem>
      <para>
       「https://[::1]:44410」などの要求の発信元。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>path</term>
     <listitem>
      <para>
       「/api/auth」などのREST APIパス。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>method</term>
     <listitem>
      <para>
       「PUT」、「POST」、または「DELETE」。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>user</term>
     <listitem>
      <para>
       ユーザの名前(または「None」)。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    次に、ログエントリの例を示します。
   </para>
<screen>
2019-02-06 10:33:01.302514 mgr.x [INF] [DASHBOARD] \
 from='https://[::ffff:127.0.0.1]:37022' path='/api/rgw/user/exu' method='PUT' \
 user='admin' params='{"max_buckets": "1000", "display_name": "Example User", "uid": "exu", "suspended": "0", "email": "user@example.com"}'
</screen>
   <tip>
    <title>要求ペイロードのログの無効化</title>
    <para>
     要求ペイロード(引数とその値のリスト)のログは、デフォルトで有効になっています。これは、次のコマンドを使用して無効にできます。
    </para>
<screen>
<prompt>cephadm@adm &gt; </prompt>ceph dashboard set-audit-api-log-payload false
</screen>
   </tip>
  </sect2>
 </sect1>
</chapter>
