<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="runtime_config.xml" version="5.0" xml:id="cha-ceph-configuration">
 <title>Configuração do cluster do Ceph</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>sim</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Este capítulo apresenta uma lista de configurações importantes do cluster do Ceph e a respectiva descrição. As configurações são classificadas por tópico.
 </para>
 <sect1 xml:id="ceph-config-runtime">
  <title>Configuração de tempo de execução</title>

  <para>
   A <xref linkend="ds-custom-cephconf"/> descreve como fazer mudanças no arquivo de configuração do Ceph <filename>ceph.conf</filename>. Entretanto, o comportamento real do cluster não é determinado pelo estado atual do arquivo <filename>ceph.conf</filename>, mas sim pela configuração dos daemons Ceph em execução, que são armazenados na memória.
  </para>

  <para>
   É possível consultar determinada configuração em um daemon Ceph usando o <emphasis>soquete de admin</emphasis> no nó em que o daemon está em execução. Por exemplo, o seguinte comando obtém o valor do parâmetro de configuração <option>osd_max_write_size</option> do daemon denominado <literal>osd.0</literal>:
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph --admin-daemon /var/run/ceph/ceph-osd.0.asok \
config get osd_max_write_size
{
  "osd_max_write_size": "90"
}</screen>

  <para>
   Você também pode <emphasis>mudar</emphasis> as configurações dos daemons em tempo de execução. Lembre-se de que essa mudança é temporária e será perdida após a reinicialização do próximo daemon. Por exemplo, o seguinte comando muda o parâmetro <option>osd_max_write_size</option> para “50” em todos os OSDs no cluster:
  </para>

<screen><prompt>cephadm@adm &gt; </prompt>ceph tell osd.* injectargs --osd_max_write_size 50</screen>

  <warning>
   <title><command>injectargs</command> Não é Confiável</title>
   <para>
    Mudar as configurações do cluster com o comando <command>injectargs</command> não é 100% confiável. Se você precisa ter certeza de que o parâmetro mudado está ativo, mude-o nos arquivos de configuração em todos os nós do cluster e reinicie todos os daemons no cluster.
   </para>
  </warning>
 </sect1>
 <sect1 xml:id="config-osd-and-bluestore">


  <title>Ceph OSD e BlueStore</title>

  <sect2 xml:id="config-auto-cache-sizing">
   <title>Dimensionamento automático do cache</title>
   <para>
    É possível configurar o BlueStore para redimensionar automaticamente os caches quando <option>tc_malloc</option> está configurado como o alocador de memória e a configuração <option>bluestore_cache_autotune</option> está habilitada. Por padrão, essa opção está habilitada atualmente. O BlueStore tentará manter o uso de memória heap OSD abaixo de um tamanho de destino designado por meio da opção de configuração <option>osd_memory_target</option>. Esse é um algoritmo de melhor esforço, e os caches não terão um tamanho menor do que o valor especificado por <option>osd_memory_cache_min</option>. Os índices do cache serão escolhidos com base em uma hierarquia de prioridades. Se as informações de prioridade não estiverem disponíveis, as opções <option>bluestore_cache_meta_ratio</option> e <option>bluestore_cache_kv_ratio</option> serão usadas como fallbacks.
   </para>
   <variablelist>
    <varlistentry>
     <term>bluestore_cache_autotune</term>
     <listitem>
      <para>
       Ajusta automaticamente os índices atribuídos aos diferentes caches do BlueStore respeitando os valores mínimos. O padrão é <option>True</option> (Verdadeiro).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_target</term>
     <listitem>
      <para>
       Quando <option>tc_malloc</option> e <option>bluestore_cache_autotune</option> estão habilitados, tenta manter essa quantidade de bytes mapeada na memória.
      </para>
      <note>
       <para>
        Talvez esse valor não corresponda exatamente ao uso de memória RSS do processo. Embora a quantidade total de memória heap mapeada pelo processo deva geralmente ficar próxima a esse destino, não há garantia de que o kernel recuperará de fato a memória que não foi mapeada.
       </para>
      </note>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>osd_memory_cache_min</term>
     <listitem>
      <para>
       Quando <option>tc_malloc</option> e <option>bluestore_cache_autotune</option> estão habilitados, define a quantidade mínima de memória usada para os caches.
      </para>
      <note>
       <para>
        Se for definido um valor muito baixo, o resultado poderá ser uma ultrapaginação do cache.
       </para>
      </note>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 xml:id="config-ogw">
  <title>Ceph Object Gateway</title>

  <para>
   É possível influenciar o comportamento do Object Gateway usando várias opções no arquivo <filename>/etc/ceph/ceph.conf</filename> abaixo das seções denominadas
  </para>

<screen>
[client.radosgw.<replaceable>INSTANCE_NAME</replaceable>]
</screen>

  <para>
   Se uma opção não for especificada, seu valor padrão será usado. Veja a seguir uma lista completa das opções do Object Gateway:
  </para>



  <sect2>
   <title>Configurações gerais</title>
   <variablelist>
    <varlistentry>
     <term>rgw_frontends</term>
     <listitem>
      <para>
       Configura o(s) front end(s) HTTP. Especifique vários front ends em uma lista delimitada por vírgula. Cada configuração de front end pode incluir uma lista de opções separadas por espaços, com cada opção no formato “chave=valor” ou “chave”. O padrão é
      </para>
<screen>
rgw_frontends = beast port=7480
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data</term>
     <listitem>
      <para>
       Define o local dos arquivos de dados para o Object Gateway. O padrão é <filename>/var/lib/ceph/radosgw/<replaceable>CLUSTER_ID</replaceable></filename>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_apis</term>
     <listitem>
      <para>
       Habilita as APIs especificadas. O padrão é “s3, swift, swift_auth, admin All APIs”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_enabled</term>
     <listitem>
      <para>
       Habilita ou desabilita o cache do Object Gateway. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_cache_lru_size</term>
     <listitem>
      <para>
       O número de entradas no cache do Object Gateway. O padrão é 10000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_socket_path</term>
     <listitem>
      <para>
       O caminho do soquete de domínio. <option>FastCgiExternalServer</option> usa esse soquete. Se você não especificar um caminho de soquete, o Object Gateway não será executado como um servidor externo. O caminho que você especifica aqui precisa ser o mesmo especificado no arquivo <filename>rgw.conf</filename>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_fcgi_socket_backlog</term>
     <listitem>
      <para>
       A lista de pendências do soquete para o fcgi. O padrão é 1024.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_host</term>
     <listitem>
      <para>
       O host para a instância do Object Gateway. Pode ser um endereço IP ou um nome de host. O padrão é 0.0.0.0
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_port</term>
     <listitem>
      <para>
       O número da porta que a instância usa para escutar as solicitações. Se não for especificado, o Object Gateway executará o FastCGI externo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_dns_name</term>
     <listitem>
      <para>
       O nome DNS do domínio atendido.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_script_uri</term>
     <listitem>
      <para>
       O valor alternativo para o SCRIPT_URI, se não for definido na solicitação.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_request_uri</term>
     <listitem>
      <para>
       O valor alternativo para o REQUEST_URI, se não for definido na solicitação.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_print_continue</term>
     <listitem>
      <para>
       Habilite 100-continue se for operacional. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_remote_addr_param</term>
     <listitem>
      <para>
       O parâmetro de endereço remoto. Por exemplo, o campo HTTP com o endereço remoto ou o endereço X-Forwarded-For, se um proxy reverso for operacional. O padrão é REMOTE_ADDR.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_timeout</term>
     <listitem>
      <para>
       O tempo de espera em segundos para threads abertos. O padrão é 600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_op_thread_suicide_timeout</term>
     <listitem>
      <para>
       O tempo de espera em segundos para o processo do Object Gateway ser encerrado. Desabilitado se definido como 0 (padrão).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_thread_pool_size</term>
     <listitem>
      <para>
       Número de threads para o servidor Beast. Aumente para um valor mais alto se você precisa atender a mais solicitações. O padrão é 100 threads.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_rados_handles</term>
     <listitem>
      <para>
       O número de manipuladores do cluster RADOS para o Object Gateway. Agora, cada thread do worker do Object Gateway precisa selecionar um manipulador do RADOS para sua vida útil. Essa opção pode ser descontinuada e removida em versões futuras. O padrão é 1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_num_control_oids</term>
     <listitem>
      <para>
       O número de objetos de notificação usados para sincronização de cache entre diferentes instâncias do rgw. O padrão é 8.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_init_timeout</term>
     <listitem>
      <para>
       O número de segundos até o Object Gateway desistir da inicialização. O padrão é 30.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_mime_types_file</term>
     <listitem>
      <para>
       O caminho e o local dos tipos MIME. Usado para detecção automática de tipos de objeto do Swift. O padrão é <filename>/etc/mime.types</filename>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_max_objs</term>
     <listitem>
      <para>
       O número máximo de objetos que podem ser processados pela coleta de lixo em um ciclo de processamento de coleta de lixo. O padrão é 32.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_obj_min_wait</term>
     <listitem>
      <para>
       O tempo mínimo de espera antes que o objeto possa ser removido e processado pela coleta de lixo. O padrão é 2*3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_max_time</term>
     <listitem>
      <para>
       O tempo máximo entre o início dos dois ciclos consecutivos de processamento da coleta de lixo. O padrão é 3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_gc_processor_period</term>
     <listitem>
      <para>
       O tempo do ciclo para o processamento da coleta de lixo. O padrão é 3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_s3_success_create_obj_status</term>
     <listitem>
      <para>
       A resposta alternativa de status de êxito para <literal>create-obj</literal>. O padrão é 0.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_resolve_cname</term>
     <listitem>
      <para>
       Se o Object Gateway deve usar o registro DNS CNAME do campo de nome de host da solicitação (se o nome de host não for igual ao nome name DNS do Object Gateway). O padrão é “false” (falso).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_obj_stripe_size</term>
     <listitem>
      <para>
       O tamanho de uma faixa de objetos do Object Gateway. O padrão é 4 &lt;&lt; 20.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_extended_http_attrs</term>
     <listitem>
      <para>
       Adicione um novo conjunto de atributos que podem ser definidos em uma entidade (por exemplo, um usuário, um compartimento de memória ou um objeto). Esses atributos extras podem ser definidos por meio de campos de cabeçalho HTTP ao especificar a entidade ou modificá-la usando o método POST. Se definidos, esses atributos serão retornados como campos HTTP ao solicitar GET/HEAD na entidade. O padrão é “content_foo, content_bar, x-foo-bar”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_exit_timeout_secs</term>
     <listitem>
      <para>
       Por quantos segundos esperar por um processo antes de sair incondicionalmente. O padrão é 120.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_window_size</term>
     <listitem>
      <para>
       O tamanho da janela em bytes para uma solicitação única de objeto. O padrão é “16 &lt;&lt; 20”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_get_obj_max_req_size</term>
     <listitem>
      <para>
       O tamanho máximo da solicitação de uma única operação GET enviada para o Cluster de Armazenamento do Ceph. O padrão é 4 &lt;&lt; 20.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_relaxed_s3_bucket_names</term>
     <listitem>
      <para>
       Habilita regras de nome de compartimento de memória S3 flexíveis para compartimentos de memória na região EUA. O padrão é “false” (falso).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_list_buckets_max_chunk</term>
     <listitem>
      <para>
       O número máximo de compartimentos de memória a serem recuperados em uma única operação ao listar compartimentos de memória de usuário. O padrão é 1000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_override_bucket_index_max_shards</term>
     <listitem>
      <para>
       Representa o número de fragmentos para o objeto Índice do compartimento de memória. A configuração 0 (padrão) indica que não há fragmentação. Não é recomendado definir um valor muito grande (por exemplo, 1000), pois isso aumenta o custo para listagem de compartimentos de memória. Essa variável deve ser definida no cliente ou nas seções globais para ser automaticamente aplicada aos comandos <command>radosgw-admin</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_curl_wait_timeout_ms</term>
     <listitem>
      <para>
       O tempo de espera em milissegundos para determinadas chamadas <command>curl</command>. O padrão é 1000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress</term>
     <listitem>
      <para>
       Habilita a saída do progresso do objeto durante operações longas de cópia. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_copy_obj_progress_every_bytes</term>
     <listitem>
      <para>
       O mínimo de bytes entre a saída do progresso da cópia. O padrão é 1024*1024.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_admin_entry</term>
     <listitem>
      <para>
       O ponto de entrada para um URL de solicitação de admin. O padrão é “admin”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_content_length_compat</term>
     <listitem>
      <para>
       Habilita o processamento de compatibilidade de solicitações FCGI com os dois comandos CONTENT_LENGTH e HTTP_CONTENT_LENGTH definidos. O padrão é “false” (falso).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_quota_ttl</term>
     <listitem>
      <para>
       Por quanto tempo em segundos as informações de cota armazenadas em cache são confiáveis. Após esse tempo, as informações de cota serão buscadas novamente do cluster. O padrão é 600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_bucket_sync_interval</term>
     <listitem>
      <para>
       Por quanto tempo em segundos as informações de cota de compartimento de memória são acumuladas antes da sincronização com o cluster. Durante esse tempo, outras instâncias do Object Gateway não verão as mudanças nas estatísticas de cota de compartimento de memória relacionadas às operações nesta instância. O padrão é 180.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_quota_sync_interval</term>
     <listitem>
      <para>
       Por quanto tempo em segundos as informações de cota de usuário são acumuladas antes da sincronização com o cluster. Durante esse tempo, outras instâncias do Object Gateway não verão as mudanças nas estatísticas de cota de usuário relacionadas às operações nesta instância. O padrão é 180.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_objects</term>
     <listitem>
      <para>
       Número máximo padrão de objetos por compartimento de memória. Ele será definido com base nos novos usuários, se nenhuma outra cota for especificada, e não terá efeito sobre os usuários existentes. Essa variável deve ser definida no cliente ou nas seções globais para ser automaticamente aplicada aos comandos <command>radosgw-admin</command>. O padrão é -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_bucket_default_quota_max_size</term>
     <listitem>
      <para>
       Capacidade máxima padrão por compartimento de memória em bytes. Ela será definida com base nos novos usuários, se nenhuma outra cota for especificada, e não terá efeito sobre os usuários existentes. O padrão é -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_objects</term>
     <listitem>
      <para>
       Número máximo padrão de objetos para um usuário. Isso inclui todos os objetos em todos os compartimentos de memória de propriedade do usuário. Ele será definido com base nos novos usuários, se nenhuma outra cota for especificada, e não terá efeito sobre os usuários existentes. O padrão é -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_user_default_quota_max_size</term>
     <listitem>
      <para>
       O valor da cota de tamanho máximo do usuário em bytes definido com base nos novos usuários, se nenhuma outra cota for especificada. Ele não tem efeito sobre os usuários existentes. O padrão é -1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_verify_ssl</term>
     <listitem>
      <para>
       Verificar os certificados SSL ao fazer as solicitações. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_max_chunk_size</term>
     <listitem>
      <para>
       Tamanho máximo de um pacote de dados que será lido em uma única operação. Aumentar o valor para 4 MB (4194304) proporcionará um melhor desempenho ao processar objetos grandes. O padrão é 128 KB (131072).
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Configurações multissite</title>
    <varlistentry>
     <term>rgw_zone</term>
     <listitem>
      <para>
       O nome da zona para a instância do gateway. Se nenhuma zona for definida, um padrão do tamanho do cluster poderá ser configurado com o comando <command>radosgw-admin zone default</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_zonegroup</term>
     <listitem>
      <para>
       O nome do grupo de zonas para a instância do gateway. Se nenhum grupo de zonas for definido, um padrão do tamanho do cluster poderá ser configurado com o comando <command>radosgw-admin zonegroup default</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_realm</term>
     <listitem>
      <para>
       O nome do domínio Kerberos para a instância do gateway. Se nenhum domínio Kerberos for definido, um padrão do tamanho do cluster poderá ser configurado com o comando <command>radosgw-admin realm default</command>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_run_sync_thread</term>
     <listitem>
      <para>
       Se houver outras zonas no domínio Kerberos das quais sincronizar, gere threads para processar a sincronização dos dados e metadados. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_window</term>
     <listitem>
      <para>
       As janelas de entradas de registro de dados em segundos. O padrão é 30.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_changes_size</term>
     <listitem>
      <para>
       O número de entradas na memória a serem armazenadas para o registro de mudanças de dados. O padrão é 1000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_obj_prefix</term>
     <listitem>
      <para>
       O prefixo do nome do objeto para o registro de dados. O padrão é “data_log”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_data_log_num_shards</term>
     <listitem>
      <para>
       O número de fragmentos (objetos) nos quais manter o registro de mudanças de dados. O padrão é 128.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_md_log_max_shards</term>
     <listitem>
      <para>
       O número máximo de fragmentos para o registro de metadados. O padrão é 64.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Configurações do Swift</title>
    <varlistentry>
     <term>rgw_enforce_swift_acls</term>
     <listitem>
      <para>
       Impõe as configurações da Lista de Controle de Acesso (ACL, Access Control List) do Swift. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_token_expiration</term>
     <listitem>
      <para>
       O tempo em segundos para expirar um token Swift. O padrão é 24*3600.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url</term>
     <listitem>
      <para>
       O URL para a API Swift do Ceph Object Gateway.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_url_prefix</term>
     <listitem>
      <para>
       O prefixo de URL para o StorageURL do Swift que fica na frente da parte "/v1". Isso permite executar várias instâncias do Gateway no mesmo host. Para compatibilidade, se essa variável de configuração for definida como vazia, o "/swift" padrão será usado. Use o prefixo “/” explícito para iniciar o StorageURL na raiz.
      </para>
      <warning>
       <para>
        Se essa opção for definida como “/”, ela não funcionará se a API S3 estiver habilitada. Saiba que a desabilitação do S3 impossibilita a implantação do Object Gateway na configuração multissite!
       </para>
      </warning>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_url</term>
     <listitem>
      <para>
       URL padrão para verificar os tokens de autenticação v1 quando a autenticação interna do Swift não é usada.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_auth_entry</term>
     <listitem>
      <para>
       O ponto de entrada para um URL de autenticação do Swift. O padrão é “auth”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_swift_versioning_enabled</term>
     <listitem>
      <para>
       Habilita o Controle de Versão de Objeto da API de Armazenamento de Objetos do OpenStack. Isso permite que os clientes insiram o atributo <literal>X-Versions-Location</literal> nos containers que devem ter o controle de versão. O atributo especifica o nome do container que armazena as versões arquivadas. Ele deve ser de propriedade do mesmo usuário que o container com controle de versão, por motivos de verificação de controle de acesso. As ACLs <emphasis>não</emphasis> são levadas em consideração. Não é possível controlar a versão desses containers usando o mecanismo de controle de versão de objetos do S3. O padrão é “false” (falso).
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Configurações de registro</title>
    <varlistentry>
     <term>rgw_log_nonexistent_bucket</term>
     <listitem>
      <para>
       Permite que o Object Gateway registre uma solicitação para um compartimento de memória não existente. O padrão é “false” (falso).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name</term>
     <listitem>
      <para>
       O formato de registro para um nome de objeto. Consulte a página de manual <command>man 1 date</command> para obter detalhes sobre especificadores de formato. O padrão é “%Y-%m-%d-%H-%i-%n”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_object_name_utc</term>
     <listitem>
      <para>
       Se um nome de objeto registrado inclui horário UTC. Se definido como "false" (padrão), será usado o horário local.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_shards</term>
     <listitem>
      <para>
       O número máximo de fragmentos para registro de uso. O padrão é 32.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_max_user_shards</term>
     <listitem>
      <para>
       O número máximo de fragmentos usados para registro de uso de um único usuário. O padrão é 1.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_ops_log</term>
     <listitem>
      <para>
       Habilitar o registro para cada operação bem-sucedida do Object Gateway. O padrão é “false” (falso).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_enable_usage_log</term>
     <listitem>
      <para>
       Habilitar o registro de uso. O padrão é “false” (falso).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_rados</term>
     <listitem>
      <para>
       Se o registro de operações deve ser gravado no back end do Cluster de Armazenamento do Ceph. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_socket_path</term>
     <listitem>
      <para>
       O soquete de domínio do Unix para gravação de registros de operações.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_ops_log_data_backlog</term>
     <listitem>
      <para>
       O tamanho máximo dos dados da lista de pendências para registros de operações gravados em um soquete de domínio do Unix. O padrão é 5 &lt;&lt; 20.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_flush_threshold</term>
     <listitem>
      <para>
       O número de entradas fundidas modificadas no registro de uso antes do descarregamento sincronizado. O padrão é 1024.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_usage_log_tick_interval</term>
     <listitem>
      <para>
       Descarregar os dados de registro de uso pendentes a cada “n” segundos. O padrão é 30.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_log_http_headers</term>
     <listitem>
      <para>
       Lista delimitada por vírgula de cabeçalhos HTTP para incluir nas entradas de registro. Os nomes de cabeçalho não diferenciam maiúsculas de minúsculas e usam o nome completo do cabeçalho com palavras separadas por sublinhados. Por exemplo, “http_x_forwarded_for”, “http_x_special_k”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name</term>
     <listitem>
      <para>
       O formato de registro para o nome do objeto de registro de intenções. Consulte a página de manual <command>man 1 date</command> para obter detalhes sobre especificadores de formato. O padrão é “%Y-%m-%d-%i-%n”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_intent_log_object_name_utc</term>
     <listitem>
      <para>
       Se o nome do objeto de registro de intenções inclui horário UTC. Se definido como "false" (padrão), será usado o horário local.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Configurações do Keystone</title>
    <varlistentry>
     <term>rgw_keystone_url</term>
     <listitem>
      <para>
       O URL para o servidor Keystone.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_api_version</term>
     <listitem>
      <para>
       A versão (2 ou 3) da API OpenStack Identity que deve ser usada para comunicação com o servidor Keystone. O padrão é 2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_domain</term>
     <listitem>
      <para>
       O nome do domínio do OpenStack com o privilégio de administrador ao usar a API OpenStack Identity v3.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_project</term>
     <listitem>
      <para>
       O nome do projeto do OpenStack com o privilégio de administrador ao usar a API OpenStack Identity v3. Se não for definido, o valor de <command>rgw keystone admin tenant</command> será usado.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_token</term>
     <listitem>
      <para>
       O token de administrador do Keystone (segredo compartilhado). No Object Gateway, a autenticação com o token de administrador tem prioridade em relação à autenticação com as credenciais de administrador (opções <option>rgw keystone admin user</option>, <option>rgw keystone admin password</option>, <option>rgw keystone admin tenant</option>, <option>rgw keystone admin project</option> e <option>rgw keystone admin domain</option>). O recurso de token de administrador é considerado descontinuado.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_tenant</term>
     <listitem>
      <para>
       O nome do locatário do OpenStack com o privilégio de administrador (Locatário de Serviço) ao usar a API OpenStack Identity v2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_user</term>
     <listitem>
      <para>
       O nome do usuário do OpenStack com o privilégio de administrador para autenticação do Keystone (Usuário de Serviço) ao usar a API OpenStack Identity v2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_admin_password</term>
     <listitem>
      <para>
       A senha para o usuário administrador do OpenStack ao usar a API OpenStack Identity v2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_accepted_roles</term>
     <listitem>
      <para>
       As funções necessárias para atender às solicitações. O padrão é “Member, admin”.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_token_cache_size</term>
     <listitem>
      <para>
       O número máximo de entradas em cada cache de token do Keystone. O padrão é 10000.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_revocation_interval</term>
     <listitem>
      <para>
       O número de segundos entre as verificações de revogação de token. O padrão é 15*60.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rgw_keystone_verify_ssl</term>
     <listitem>
      <para>
       Verificar os certificados SSL ao fazer as solicitações de token para o Keystone. O padrão é “true”.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <sect3 xml:id="sec-ceph-rgw-configuration-notes">
    <title>Notas adicionais</title>
    <variablelist>
     <varlistentry>
      <term>rgw_dns_name</term>
      <listitem>
       <para>
        Se o parâmetro <literal>rgw dns name</literal> for adicionado a <filename>ceph.conf</filename>, verifique se o cliente S3 foi configurado para direcionar as solicitações no endpoint especificado por <literal>rgw dns name</literal>.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>

  <sect2 xml:id="config-ogw-http-frontends">
   <title>Front ends HTTP</title>
   <sect3>
    <title>Beast</title>
    <variablelist>
     <varlistentry>
      <term>porta, ssl_port</term>
      <listitem>
       <para>
        Números de porta de escuta IPv4 e IPv6. Você pode especificar vários números de porta:
       </para>
<screen>
port=80 port=8000 ssl_port=8080
</screen>
       <para>
        O padrão é 80.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>endpoint, ssl_endpoint</term>
      <listitem>
       <para>
        Os endereços de escuta no formato “endereço[:porta]”, em que o endereço é uma string de endereço IPv4 no formato decimal com pontos ou um endereço IPv6 na notação hexadecimal entre colchetes. Se for especificado um endpoint IPv6, a escuta será apenas no IPv6. O número da porta opcional considera o padrão de 80 para <option>endpoint</option> e 443 para <option>ssl_endpoint</option>. Você pode especificar vários endereços:
       </para>
<screen>
endpoint=[::1] endpoint=192.168.0.100:8000 ssl_endpoint=192.168.0.100:8080
</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>ssl_private_key</term>
      <listitem>
       <para>
        Caminho opcional para o arquivo de chave privada usado para endpoints habilitados para SSL. Se não for especificado, o arquivo <option>ssl_certificate</option> será usado como uma chave privada.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>tcp_nodelay</term>
      <listitem>
       <para>
        Se especificado, a opção de soquete desabilitará o algoritmo Nagle na conexão. Isso significa que os pacotes serão enviados o mais rápido possível, em vez de esperar por um buffer completo ou o tempo de espera se esgotar.
       </para>
       <para>
        “1” desabilita o algoritmo Nagle para todos os soquetes.
       </para>
       <para>
        “0” mantém o algoritmo Nagle habilitado (padrão).
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title>Exemplo de configuração do Beast em <filename>/etc/ceph/ceph.conf</filename></title>
<screen>
rgw_frontends = beast port=8000 ssl_port=443 ssl_certificate=/etc/ssl/ssl.crt error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>CivetWeb</title>
    <variablelist>
     <varlistentry>
      <term>port</term>
      <listitem>
       <para>
        O número da porta de escuta. Para as portas habilitadas para SSL, adicione um sufixo "s" (por exemplo, “443s”). Para vincular um endereço IPv4 ou IPv6 específico, use o formato “endereço:porta”. Você pode especificar vários endpoints adicionando “+” ou inserindo várias opções:
       </para>
<screen>
port=127.0.0.1:8000+443s
port=8000 port=443s
</screen>
       <para>
        O padrão é 7480.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>num_threads</term>
      <listitem>
       <para>
        O número de threads gerados pelo Civetweb para processar as conexões HTTP recebidas. Efetivamente, isso limita o número de conexões simultâneas que o front end pode atender.
       </para>
       <para>
        O padrão é o valor especificado pela opção <option>rgw_thread_pool_size</option>.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>request_timeout_ms</term>
      <listitem>
       <para>
        Por quanto tempo em milissegundos o Civetweb aguardará por mais dados recebidos antes de desistir.
       </para>
       <para>
        O padrão é de 30.000 milissegundos.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>access_log_file</term>
      <listitem>
       <para>
        Caminho para o arquivo de registro de acessos. Você pode especificar um caminho completo ou um caminho relativo ao diretório de trabalho atual. Se não for especificado (padrão), os acessos não serão registrados.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>error_log_file</term>
      <listitem>
       <para>
        Caminho para o arquivo de registro de erros. Você pode especificar um caminho completo ou um caminho relativo ao diretório de trabalho atual. Se não for especificado (padrão), os erros não serão registrados.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <example>
     <title>Exemplo de configuração do Civetweb em <filename>/etc/ceph/ceph.conf</filename></title>
<screen>
rgw_frontends = civetweb port=8000+443s request_timeout_ms=30000 error_log_file=/var/log/radosgw/civetweb.error.log
</screen>
    </example>
   </sect3>
   <sect3>
    <title>Opções comuns</title>
    <variablelist>
     <varlistentry>
      <term>ssl_certificate</term>
      <listitem>
       <para>
        Caminho para o arquivo de certificado SSL usado para endpoints habilitados para SSL.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>prefix</term>
      <listitem>
       <para>
        Uma string de prefixo que é inserida no URI de todas as solicitações. Por exemplo, um front end apenas Swift pode fornecer um prefixo de URI “/swift”.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
</chapter>
