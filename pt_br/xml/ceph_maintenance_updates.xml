<?xml version="1.0" encoding="UTF-8"?>
<appendix xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_maintenance_updates.xml" version="5.0">
 <title>Atualizações de manutenção do Ceph baseadas nos point releases de upstream do “Nautilus”</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>editando</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes (sim)</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Vários pacotes importantes no SUSE Enterprise Storage 6 são baseados na série de lançamentos Nautilus do Ceph. Quando o projeto do Ceph (<link xlink:href="https://github.com/ceph/ceph"/>) publica novos point releases na série Nautilus, o SUSE Enterprise Storage 6 é atualizado para garantir que o produto aproveite as correções de bug de upstream e os backports de recursos mais recentes.
 </para>
 <para>
  Este capítulo contém resumos das mudanças importantes contidas em cada point release de upstream que foi, ou está planejado para ser incluído no produto.
 </para>
 <bridgehead renderas="sect1">Point release do Nautilus 14.2.4</bridgehead>
 <para>
  Esse point release corrige uma regressão grave que acabou passando no point release 14.2.3. Essa regressão não afetou os clientes do SUSE Enterprise Storage porque não distribuímos uma versão com base na 14.2.3.
 </para>
 <bridgehead renderas="sect1">Point release do Nautilus 14.2.3</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    Uma vulnerabilidade de negação de serviço foi corrigida, na qual um cliente não autenticado do Ceph Object Gateway era capaz de provocar uma falha de uma exceção não detectada.
   </para>
  </listitem>
  <listitem>
   <para>
    Os clientes librbd com base no Nautilus agora podem abrir imagens em clusters Jewel.
   </para>
  </listitem>
  <listitem>
   <para>
    O <option>num_rados_handles</option> do Object Gateway foi removido. Se você estava usando um valor de <option>num_rados_handles</option> maior do que 1, multiplique os parâmetros <option>objecter_inflight_ops</option> e <option>objecter_inflight_op_bytes</option> atuais pelo <option>num_rados_handles</option> antigo para conseguir o mesmo comportamento de obstrução.
   </para>
  </listitem>
  <listitem>
   <para>
    O modo seguro do protocolo Messenger v2 não é mais experimental com esta versão. Esse modo é agora preferencial para conexão de monitores.
   </para>
  </listitem>
  <listitem>
   <para>
    <option>osd_deep_scrub_large_omap_object_key_threshold</option> foi reduzido para detectar mais facilmente um objeto com um número grande de chaves omap.
   </para>
  </listitem>
  <listitem>
   <para>
    Agora, o Ceph Dashboard permite silenciar as notificações do Prometheus.
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Point release do Nautilus 14.2.2</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    Os comandos relacionados <literal>no{up,down,in,out}</literal> foram reformulados. Agora há duas maneiras de definir os flags <literal>no{up,down,in,out}</literal>: o comando antigo
   </para>
<screen>ceph osd [un]set <replaceable>FLAG</replaceable></screen>
   <para>
    que define os flags de todo o cluster; e o novo comando
   </para>
<screen>ceph osd [un]set-group <replaceable>FLAGS</replaceable> <replaceable>WHO</replaceable></screen>
   <para>
    que define os flags em lote na granularidade de qualquer nó de crush ou classe de dispositivo.
   </para>
  </listitem>
  <listitem>
   <para>
    <command>radosgw-admin</command> introduz dois subcomandos que permitem o gerenciamento de objetos de expiração-esvaziamento que podem ser esquecidos após a refragmentação de um compartimento de memória nas versões anteriores do Object Gateway. Um subcomando lista esses objetos, e o outro os apaga.
   </para>
  </listitem>
  <listitem>
   <para>
    As versões anteriores do Nautilus (14.2.1 e 14.2.0) têm um problema em que a implantação de um novo e único OSD BlueStore do Nautilus em um cluster do qual foi feito o upgrade (ex. um que foi originalmente implantado antes do Nautilus) interrompe as estatísticas de utilização do pool relatadas pelo <command>ceph df</command>. Até que todos os OSDs sejam reprovisionados ou atualizados (por meio de <command>ceph-bluestore-tool repair</command>), as estatísticas do pool mostrarão valores inferiores aos valores reais. Isso foi resolvido na versão 14.2.2, de modo que o cluster apenas mudará para o uso de estatísticas mais precisas por pool depois que <emphasis>todos</emphasis> os OSDs forem da versão 14.2.2 ou posterior, de Armazenamento de Blocos e atualizados por meio da função de conserto, caso tenham sido criados antes do Nautilus.
   </para>
  </listitem>
  <listitem>
   <para>
    O valor padrão para <option>mon_crush_min_required_version</option> foi mudado de <literal>firefly</literal> para <literal>hammer</literal>, o que significa que o cluster emitirá um aviso de saúde se os tunables do CRUSH forem mais antigos do que os do Hammer. Em geral, há uma pequena (mas não zero) quantidade de dados que serão movidos ao alternar para os tunables do Hammer.
   </para>
   <para>
    Se possível, recomendamos definir o cliente mais antigo com permissão como <literal>hammer</literal> ou posterior. Para exibir o cliente mais antigo com permissão atual, execute:
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph osd dump | grep min_compat_client</screen>
   <para>
    Se o valor atual for mais antigo do que <literal>hammer</literal>, execute o seguinte comando para determinar se é seguro fazer essa mudança verificando se não há clientes mais antigos do que o Hammer atualmente conectados ao cluster:
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph features</screen>
   <para>
    O tipo de compartimento de memória do CRUSH <literal>straw2</literal> foi incluído no Hammer. Se você verificar que todos os clientes são do Hammer ou mais recente, ele permitirá o uso de novos recursos suportados apenas para compartimentos de memória <literal>straw2</literal>, incluindo o modo <literal>crush-compat</literal> para o Balanceador (<xref linkend="mgr-modules-balancer"/>).
   </para>
  </listitem>
 </itemizedlist>
 <para>
  Encontre informações detalhadas sobre o patch em <link xlink:href="https://download.suse.com/Download?buildid=D38A7mekBz4~"/>
 </para>
 <bridgehead renderas="sect1">Point release do Nautilus 14.2.1</bridgehead>
 <para>
  Esse foi o primeiro point release após a versão original do Nautilus (14.2.0). A versão original (“Disponibilidade Geral” ou “GA”) do SUSE Enterprise Storage 6 foi baseada nesse point release.
 </para>
</appendix>
