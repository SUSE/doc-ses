<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_prompts.xml" version="5.0">
 <title>Privilégios de usuário e prompts de comando</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>editando</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes (sim)</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  Como administrador de cluster do Ceph, você configura e ajusta o comportamento do cluster executando comandos específicos. Há vários tipos de comandos que serão necessários:
 </para>
 <sect1>
  <title>Comandos relacionados ao Salt/DeepSea</title>

  <para>
   Esses comandos ajudam você a implantar ou fazer upgrade do cluster do Ceph, executar comandos em vários (ou todos) nós do cluster ao mesmo tempo ou ajudá-lo a adicionar ou remover nós do cluster. Os comandos mais usados são <command>salt</command>, <command>salt-run</command> e <command>deepsea</command>. Você precisa executar os comandos do Salt no nó master Salt (consulte o <xref linkend="deepsea-description"/> para obter detalhes) como <systemitem class="username">root</systemitem>. Esses comandos são introduzidos com o seguinte prompt:
  </para>

<screen>
<prompt>root@master # </prompt>
</screen>

  <para>
   Por exemplo:
  </para>

<screen>
<prompt>root@master # </prompt>salt '*.example.net' test.ping
</screen>
 </sect1>
 <sect1>
  <title>Comandos relacionados ao Ceph</title>

  <para>
   Trata-se de comandos de nível inferior que configuram e ajustam todos os aspectos do cluster e seus gateways na linha de comando. <command>ceph</command>, <command>rbd</command>, <command>radosgw-admin</command> ou <command>crushtool</command> são alguns deles.
  </para>

  <para>
   Para executar os comandos relacionados ao Ceph, você precisa ter acesso de leitura a uma chave do Ceph. Os recursos da chave definem seus privilégios no ambiente do Ceph. Uma opção é executar os comandos do Ceph como <systemitem class="username">root</systemitem> (ou por meio do <command>sudo</command>) e usar o chaveiro padrão irrestrito “ceph.client.admin.key”.
  </para>

  <para>
   A opção mais segura e recomendada é criar uma chave individual mais restritiva para cada usuário administrador e colocá-la em um diretório onde os usuários possam lê-la. Por exemplo:
  </para>

<screen>~/.ceph/ceph.client.<replaceable>USERNAME</replaceable>.keyring</screen>

  <tip>
   <title>Caminho para Chaves do Ceph</title>
   <para>
    Para utilizar um usuário admin e um chaveiro personalizados, você precisa especificar o nome de usuário e o caminho para a chave toda vez que executar o comando <command>ceph</command> com as opções <option>-n client.<replaceable>USER_NAME</replaceable></option> e <option>--keyring <replaceable>PATH/TO/KEYRING</replaceable></option>.
   </para>
   <para>
    Para evitar isso, inclua essas opções na variável <varname>CEPH_ARGS</varname> nos arquivos <filename>~/.bashrc</filename> dos usuários individuais.
   </para>
  </tip>

  <para>
   É possível executar os comandos relacionados ao Ceph em qualquer nó do cluster, mas a recomendação é executá-los no Nó de Admin. Esta documentação utiliza o usuário <systemitem class="username">cephadm</systemitem> para executar os comandos, portanto, eles são introduzidos com o seguinte prompt:
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>
</screen>

  <para>
   Por exemplo:
  </para>

<screen>
<prompt>cephadm@adm &gt; </prompt>ceph auth list
</screen>

  <tip>
   <title>Comandos para Nós Específicos</title>
   <para>
    Se a documentação orientar você a executar um comando em um nó do cluster com uma função específica, isso será processado pelo prompt. Por exemplo:
   </para>
<screen>
<prompt>cephadm@mon &gt; </prompt>
</screen>
  </tip>
 </sect1>
 <sect1>
  <title>Comandos gerais do Linux</title>

  <para>
   Os comandos do Linux não relacionados ao Ceph ou ao DeepSea, como <command>mount</command>, <command>cat</command> ou <command>openssl</command>, são introduzidos com os prompts <prompt>cephadm@adm &gt;</prompt> ou <prompt>root #</prompt>, dependendo dos privilégios exigidos pelo comando relacionado.
  </para>
 </sect1>
 <sect1>
  <title>Informações adicionais</title>

  <para>
   Para obter mais informações sobre o gerenciamento de chaves do Ceph, consulte a <xref linkend="storage-cephx-keymgmt"/>.
  </para>
 </sect1>
</chapter>
