<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ceph_faqs.xml" version="5.0" xml:id="storage-faqs">
 <title>Perguntas frequentes (FAQ)</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>sim</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para/>
 <sect1 xml:id="storage-bp-tuneups-pg-num">
  <title>Como o número de grupos de posicionamento afeta o desempenho do cluster?</title>

  <para>
   Quando o cluster está atingindo 70 a 80% de sua capacidade, é hora de adicionar OSDs a ele. Ao aumentar o número de OSDs, você pode considerar também o aumento do número de grupos de posicionamento.
  </para>

  <warning>
   <para>
    Mudar o número de PGs provoca a transferência de muitos dados no cluster.
   </para>
  </warning>

  <para>
   O cálculo do valor ideal para o cluster recém-dimensionado é uma tarefa complexa.
  </para>

  <para>
   Um alto número de PGs cria pequenos pacotes de dados. Isso acelera a recuperação após a falha em um OSD, mas sobrecarrega os nós do monitor, pois eles são responsáveis por calcular o local dos dados.
  </para>

  <para>
   Por outro lado, um baixo número de PGs leva mais tempo e exige a transferência de dados para recuperação de uma falha no OSD, mas não impõe tanta carga sobre os nós do monitor, já que eles precisam calcular os locais para menos pacotes de dados (porém, maiores).
  </para>

  <para>
   Encontre mais informações sobre o número ideal de PGs para o seu cluster na <xref linkend="op-pgs-pg-num"/>.
  </para>
 </sect1>
 <sect1 xml:id="storage-bp-tuneups-mix-ssd">
  <title>Posso usar SSDs e discos rígidos no mesmo cluster?</title>

  <para>
   Geralmente, as SSDs (Solid-State Drives – Unidades de Estado Sólido) são mais rápidas do que os discos rígidos. Se você combinar os dois tipos de discos na mesma operação de gravação, os dados que estiverem sendo gravados no disco SSD ficarão mais lentos por causa do desempenho do disco rígido. Portanto, você <emphasis>nunca deve combinar SSDs e discos rígidos</emphasis> para gravação de dados, seguindo <emphasis>a mesma regra</emphasis> (consulte a <xref linkend="datamgm-rules"/> para obter mais informações sobre as regras de armazenamento de dados).
  </para>

  <para>
   Geralmente, há dois casos em que o uso de SSD e disco rígido no mesmo cluster é ideal:
  </para>

  <orderedlist spacing="normal">
   <listitem>
    <para>
     Usar cada tipo de disco para gravar dados seguindo regras diferentes. Nesse caso, você precisa ter uma regra separada para o disco SSD e outra regra para o disco rígido.
    </para>
   </listitem>
   <listitem>
    <para>
     Usar cada tipo de disco para uma finalidade específica. Por exemplo, o disco SSD para diário, e o disco rígido para armazenamento de dados.
    </para>
   </listitem>
  </orderedlist>
 </sect1>
 <sect1 xml:id="storage-bp-tuneups-ssd-tradeoffs">
  <title>Quais são as compensações de usar um diário na SSD?</title>

  <para>
   O uso de SSDs para diário(s) OSD é melhor para o desempenho, pois o diário costuma ser o gargalo dos OSDs apenas de disco rígido. Em geral, as SSDs são usadas para compartilhar diários de vários OSDs.
  </para>

  <para>
   Veja a seguir uma lista das possíveis desvantagens de uso de SSDs para diário OSD:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Os discos SSD são mais caros do que os discos rígidos. Porém, como um diário OSD requer apenas até 6 GB de espaço em disco, o preço talvez não seja tão decisivo.
    </para>
   </listitem>
   <listitem>
    <para>
     O disco SSD consome slots de armazenamento que podem ser usados por um disco rígido grande para estender a capacidade do cluster.
    </para>
   </listitem>
   <listitem>
    <para>
     Os discos SSD reduziram os ciclos de gravação em comparação com os discos rígidos, mas as tecnologias modernas estão começando a eliminar o problema.
    </para>
   </listitem>
   <listitem>
    <para>
     Se você compartilha mais diários no mesmo disco SSD, corre o risco de perder todos os OSDs relacionados depois de uma falha no disco SSD. Isso exigirá a migração de muitos dados para redistribuir o cluster.
    </para>
   </listitem>
   <listitem>
    <para>
     Os discos de HotPlug tornam-se mais complexos, pois o mapeamento de dados não é 1:1 em relação ao OSD com falha e o disco de diário.
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="storage-bp-monitoring-diskfails">
  <title>O que acontece quando há falha em um disco?</title>

  <para>
   Quando um disco com dados de cluster armazenados tem algum problema de hardware e para de funcionar, veja o que acontece:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     O OSD relacionado falha e é automaticamente removido do cluster.
    </para>
   </listitem>
   <listitem>
    <para>
     Os dados do disco com falha são replicados para outro OSD no cluster com base em outras cópias dos mesmos dados armazenados em outros OSDs.
    </para>
   </listitem>
   <listitem>
    <para>
     Em seguida, você deve remover o disco do Mapa CRUSH do cluster e fisicamente do hardware de host.
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="storage-bp-monitoring-journalfails">
  <title>O que acontece quando há falha em um disco de diário?</title>

  <para>
   É possível configurar o Ceph para armazenar diários ou gravar registros antecipados em dispositivos separados dos OSDs. Quando há falha em um disco dedicado a um diário, também há falha no(s) OSD(s) relacionado(s) (consulte a <xref linkend="storage-bp-monitoring-diskfails"/>).
  </para>

  <warning>
   <title>Hospedando vários diários em um disco</title>
   <para>
    Para melhorar o desempenho, você pode usar um disco rápido (como SSD) para armazenar partições de diário para vários OSDs. Não recomendamos hospedar diários para mais do que quatro OSDs em um disco, já que em caso de falha no disco do diário, você corre o risco de perder os dados armazenados de todos os discos dos OSDs relacionados.
   </para>
  </warning>
 </sect1>
</chapter>
