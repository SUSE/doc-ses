<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ds_backup.xml" version="5.0" xml:id="cha.deployment_backup">
 <title>Sichern der Cluster-Konfiguration</title>
 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer>tbazant@suse.com</dm:maintainer>
        <dm:status>Bearbeiten</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>Ja</dm:translation>
        <dm:languages/>
        <dm:release>SES 5</dm:release>
      </dm:docmanager>
    </info>
    <para>
  In diesem Kapitel wird erklärt, welche Dateien im Admin Node gesichert werden sollten. Sobald Sie Ihre Cluster-Bereitstellung oder Migration abgeschlossen haben, erstellen Sie eine Sicherung dieser Verzeichnisse.
 </para>
 <sect1 xml:id="sec.deployment_backup.salt">
  <title>Sichern der Salt-Konfiguration</title>

  <para>
   Das Verzeichnis <filename>/etc/salt/</filename> kann gesichert werden. Es enthält die Salt-Konfigurationsdateien, beispielsweise den Salt Master-Schlüssel und die akzeptierten Client-Schlüssel.
  </para>

  <para>
   Die Salt-Dateien sind zum Sichern des Admin Node nicht unbedingt erforderlich, doch die erneute Bereitstellung des Salt Clusters wird dadurch einfacher. Wenn diese Dateien nicht gesichert sind, müssen die Salt Minions erneut beim neuen Admin Node registriert werden.
  </para>

  <note>
   <title>Sicherheit des privaten Salt Master-Schlüssels</title>
   <para>
    Vergewissern Sie sich, dass die Sicherungskopien des privaten Salt Master-Schlüssels an einem sicheren Ort verwahrt sind. Mit dem Salt Master-Schlüssel können alle Cluster Nodes manipuliert werden.
   </para>
  </note>

  <para>
   Nach dem Wiederherstellen des Verzeichnisses <filename>/etc/salt</filename> von einer Sicherung starten Sie die Salt Services neu:
  </para>

<screen><prompt>root@master # </prompt><command>systemctl</command> restart salt-master
<prompt>root@master # </prompt><command>systemctl</command> restart salt-minion</screen>
 </sect1>
 <sect1 xml:id="sec.deployment_backup.deepsea">
  <title>Sichern der DeepSea-Konfiguration</title>

  <para>
   Alle für DeepSea erforderlichen Dateien sind unter <filename>/srv/pillar/</filename>, <filename>/srv/salt/</filename> und <filename>/etc/salt/master.d</filename> gespeichert.
  </para>

  <para>
   Wenn Sie den Admin Node erneut bereitstellen müssen, installieren Sie das DeepSea-Paket im neuen Knoten und verschieben Sie die gesicherten Daten in die Verzeichnisse zurück. DeepSea kann dann wieder verwendet werden, ohne dass weitere Änderungen erforderlich sind. Bevor Sie DeepSea wieder verwenden, vergewissern Sie sich, dass alle Salt Minions im Admin Node korrekt registriert sind.
  </para>
 </sect1>
</chapter>
