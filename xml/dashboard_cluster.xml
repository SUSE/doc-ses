<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="dashboard-cluster">
 <title>Viewing Cluster Internals</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/maintenance/ses6/xml/</dm:editurl>
   <dm:translation>yes</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  The <guimenu>Cluster</guimenu> menu item lets you view detailed information
  about &ceph; cluster hosts, OSDs, MONs, &crushmap;, and the content of log
  files.
 </para>
 <sect1 xml:id="dashboard-cluster-hosts">
  <title>Cluster Nodes</title>

  <para>
   Click
   <menuchoice><guimenu>Cluster</guimenu><guimenu>Hosts</guimenu></menuchoice>
   to view a list of cluster nodes.
  </para>

  <figure>
   <title>Hosts</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   Click a node name in the <guimenu>Hostname</guimenu> column to view
   performance details of the node.
  </para>

  <para>
   The <guimenu>Services</guimenu> column lists all daemons that are running on
   each related node. Click a daemon name to view its detailed configuration.
  </para>
 </sect1>
 <sect1 xml:id="dashboard-cluster-monitors">
  <title>&mon;s</title>

  <para>
   Click
   <menuchoice><guimenu>Cluster</guimenu><guimenu>Monitors</guimenu></menuchoice>
   to view a list of cluster nodes with running &ceph; monitors. The list
   includes each monitor's rank number, public IP address, and number of open
   sessions.
  </para>

  <para>
   The list is divided into two tables: one for &mon;s that
   <emphasis>are</emphasis> in quorum, and the second one for &mon;s that
   <emphasis>are not</emphasis> in quorum.
  </para>

  <para>
   Click a node name in the <guimenu>Name</guimenu> column to view the related
   &mon; configuration.
  </para>

  <para>
   The <guimenu>Status</guimenu> table shows general statistics about the
   running &mon;s.
  </para>

  <figure>
   <title>&mon;s</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-cluster-osds">
  <title>&osd;s</title>

  <para>
   Click
   <menuchoice><guimenu>Cluster</guimenu><guimenu>OSDs</guimenu></menuchoice>
   to view a list of nodes with running OSD daemons/disks. The list includes
   each node's name, status, number of placement groups, size, usage,
   reads/writes chart in time, and the rate of read/write operations per
   second.
  </para>

  <figure>
   <title>&osd;s</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   Click <guimenu>Set Cluster-wide Flags</guimenu> in the table heading to pop
   up a window with a list of flags that apply to the whole cluster. You can
   activate or deactivate individual flags, and confirm with
   <guimenu>Submit</guimenu>.
  </para>

  <figure>
   <title>OSD Flags</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   Click <guimenu>Set Cluster-wide Recovery Priority</guimenu> in the table
   heading to open a pop-up window with a list of OSD recovery priorities that
   apply to the whole cluster. You can activate the preferred priority profile,
   and fine tune the individual values below. Confirm with
   <guimenu>Submit</guimenu>.
  </para>

  <figure>
   <title>OSD Recovery Priority</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   Click a node name in the <guimenu>Host</guimenu> column to view an extended
   table with details about the OSD setting and performance. Browsing through
   several tabs, you can see lists of <guimenu>Attributes</guimenu>,
   <guimenu>Metadata</guimenu>, <guimenu>Performance counter</guimenu>, and a
   graphical <guimenu>Histogram</guimenu> of reads and writes.
  </para>

  <figure>
   <title>OSD Details</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <tip>
   <title>Perform Specific Tasks on OSDs</title>
   <para>
    After you click an OSD node name, its table row changes color slightly,
    meaning that you can now perform a task on the node. Click the down arrow
    in the top left of the table heading and select a task to perform, such as
    <guimenu>Deep Scrub</guimenu>. Optionally enter a required value for the
    task, and confirm to run it on the node.
   </para>
  </tip>
 </sect1>
 <sect1 xml:id="dashboard-cluster-config">
  <title>Cluster Configuration</title>

  <para>
   Click
   <menuchoice><guimenu>Cluster</guimenu><guimenu>Configuration</guimenu></menuchoice>
   to view a complete list of &ceph; cluster configuration options. The list
   contains the name of the option, its short description, and its current and
   default values.
  </para>

  <figure>
   <title>Cluster Configuration</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   Click a specific option row to highlight and see detailed information about
   the option, such as its type of value, minimum and maximum permitted values,
   whether it can be updated at runtime, and many more.
  </para>

  <para>
   After highlighting a specific option, you can edit its value(s) by clicking
   the <guimenu>Edit</guimenu> button in the top left of the table heading.
   Confirm changes with <guimenu>Save</guimenu>.
  </para>
 </sect1>
 <sect1 xml:id="dashboard-cluster-crushmap">
  <title>&crushmap;</title>

  <para>
   Click <menuchoice><guimenu>Cluster</guimenu><guimenu>CRUSH
   map</guimenu></menuchoice> to view a &crushmap; of the cluster. For more
   general information on &crushmap;s, refer to <xref linkend="op-crush" />.
  </para>

  <para>
   Click the root, nodes, or individual OSDs to view more detailed information,
   such as crush weight, depth in the map tree, device class of the OSD, and
   many more.
  </para>

  <figure>
   <title>&crushmap;</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="dashboard-cluster-mgr-plugins">
  <title>Manager Modules</title>

  <para>
   Click <menuchoice><guimenu>Cluster</guimenu><guimenu>Manager
   modules</guimenu></menuchoice> to view a list of available &mgr; modules.
   Each line consists of a module name and information on whether it is
   currently enabled or not.
  </para>

  <figure>
   <title>Manager Modules</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   After highlighting a specific module, you can see its detailed settings in
   the <guimenu>Details</guimenu> table below. Edit them by clicking the
   <guimenu>Edit</guimenu> button in the top left of the table heading. Confirm
   changes with <guimenu>Update</guimenu>.
  </para>
 </sect1>
 <sect1 xml:id="dashboard-cluster-logs">
  <title>Logs</title>

  <para>
   Click
   <menuchoice><guimenu>Cluster</guimenu><guimenu>Logs</guimenu></menuchoice>
   to view a list of cluster's recent log entries. Each line consists of a time
   stamp, the type of the log entry, and the logged message itself.
  </para>

  <para>
   Click the <guimenu>Audit Logs</guimenu> tab to view log entries of the
   auditing subsystem. Refer to <xref linkend="dashboard-auditing" /> for
   commands to enable or disable auditing.
  </para>

  <figure>
   <title>Logs</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
</chapter>
