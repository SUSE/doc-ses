<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="ceph-dashboard">
 <title>&dashboard;</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/master/xml/</dm:editurl>
   <dm:translation>yes</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  The &dashboard; is a module that adds a built-in Web based monitoring and
  administration application to the &mgr; (refer to
  <xref linkend="storage-intro-core-nodes" /> for more details on &mgr;). You
  no longer need to know complex &ceph; related commands to manage and monitor
  your &ceph; cluster. You can either use the &dashboard;'s intuitive Web
  interface, or its built-in REST API.
 </para>
 <para>
  The &dashboard; is automatically enabled and configured with &deepsea;'s
  stage 3 during the deployment procedure (see
  <xref linkend="ceph-install-stack" />). In a &ceph; cluster with multiple
  &mgr; instances, only the dashboard running on the currently active &mgr;
  daemon will serve incoming requests. Accessing the dashboard's TCP port on
  any of the other &mgr; instances that are currently on standby will perform
  an HTTP redirect (303) to the currently active &mgr;'s dashboard URL. This
  way, you can point your browser to any of the &mgr; instances in order to
  access the dashboard. Consider this behavior when securing access with
  firewall or planning for HA setup.
 </para>
 <sect1 xml:id="dashboard-webui-general">
  <title>Dashboard's Web User Interface</title>

  <sect2 xml:id="dashboard-webui-login">
   <title>Log In</title>
   <para>
    To log in to the dashboard Web application, point your browser to its URL
    including the port number. You can find its address by running
   </para>
<screen>
&prompt.cephuser;ceph mgr services | grep dashboard
"dashboard": "https://ses-dash-node.example.com:8443/",
</screen>
   <figure>
    <title>&dashboard; Login Screen</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dashboard_login.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dashboard_login.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    You need a user account in order to log in to the dashboard Web
    application. &deepsea; creates a default user 'admin' with administrator
    privileges for you. If you decide to log in with the default 'admin' user,
    retrieve the corresponding password by running
   </para>
<screen>
&prompt.smaster;salt-call grains.get dashboard_creds
</screen>
   <tip>
    <title>Custom User Account</title>
    <para>
     If you do not want to use the default 'admin' account to access the
     &dashboard;, create a custom user account with administrator privileges.
     Refer to <xref linkend="dashboard-user-roles" /> for more details.
    </para>
   </tip>
   <para>
    The dashboard user interface is graphically divided into several
    <emphasis>blocks</emphasis>: the <emphasis>utility menu</emphasis>, the
    <emphasis>main menu</emphasis>, and the main <emphasis>content
    pane</emphasis>.
   </para>
   <figure>
    <title>&dashboard; Home Page</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dashboard_homepage.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dashboard_homepage.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-util-menu">
   <title>Utility Menu</title>
   <para>
    The top right part of the screen contains a utility menu. It includes
    general tasks related more to the dashboard than to the &ceph; cluster. By
    clicking its items, you can access the following topics:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Change the language of the dashboard's user interface. You can choose
      from Czech, English, German, Spanish, French, Portuguese, Chinese, or
      Indonesian.
     </para>
    </listitem>
    <listitem>
     <para>
      Display a list of &ceph; related tasks that are running in the
      background.
     </para>
    </listitem>
    <listitem>
     <para>
      View and erase recent dashboard notifications.
     </para>
    </listitem>
    <listitem>
     <para>
      Display a list of links that refer to the information about the
      dashboard, its complete documentation, and an overview of its REST API.
     </para>
    </listitem>
    <listitem>
     <para>
      Manage the dashboard's users and user roles. Refer to
      <xref linkend="dashboard-user-roles" /> for more detailed command line
      descriptions.
     </para>
    </listitem>
    <listitem>
     <para>
      Log out of the dashboard.
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="dashboard-main-menu">
   <title>Main Menu</title>
   <para>
    The dashboard's main menu occupies the top left part of the screen. It
    covers the following topics:
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>Dashboard</guimenu></term>
     <listitem>
      <para>
       Return to &dashboard;'s home page.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Cluster</guimenu></term>
     <listitem>
      <para>
       View detailed information about overall cluster configuration and
       &crushmap;, its hosts, &osd;s, &mon;s, and the content of a log file.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Pools</guimenu></term>
     <listitem>
      <para>
       View and manage cluster pools.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Block</guimenu></term>
     <listitem>
      <para>
       View and manage block devices and their &iscsi; exports.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>NFS</guimenu></term>
     <listitem>
      <para>
       View and manage &ganesha; deployments.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Filesystems</guimenu></term>
     <listitem>
      <para>
       View and manage &cephfs;s.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Object Gateway</guimenu></term>
     <listitem>
      <para>
       View and manage &ogw;'s daemons, users, and buckets.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard-cpane">
   <title>The Content Pane</title>
   <para>
    The content pane occupies the main part of the dashboard's screen. The
    dashboard home page shows plenty of helpful widgets to inform you briefly
    about the current status of the cluster, capacity, and performance
    information.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-ui-common">
   <title>Common Web UI Features</title>
   <para>
    In &dashboard;, you often work with <emphasis>lists</emphasis>&mdash;for
    example, lists of pools, OSD nodes, or RBD devices. All lists will
    automatically refresh themselves by default every 5 seconds. The following
    common widgets help you manage or adjust these list:
   </para>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> to trigger a manual refresh of the list.
   </para>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> to display or hide individual table columns.
   </para>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> and select how many rows to display on a single page.
   </para>
   <para>
    Click inside <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> and filter the rows by typing the string to search
    for.
   </para>
   <para>
    Use <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> to change the currently displayed page if the list
    spans across multiple pages.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-widgets">
   <title>Dashboard Widgets</title>
   <para>
    Each dashboard widget shows specific status information related to a
    specific aspect of a running &ceph; cluster. Some widgets are active links
    and after clicking them, they will redirect you to a related detailed page
    of the topic they represent.
   </para>
   <tip>
    <title>More Details on Mouse Over</title>
    <para>
     Some graphical widgets show you more detail when you move the mouse over
     them.
    </para>
   </tip>
   <sect3 xml:id="dashboard-widgets-status">
    <title>Status Widgets</title>
    <para>
     <guimenu>Status</guimenu> widgets give you a brief overview about the
     cluster's current status.
    </para>
    <figure>
     <title>Status Widgets</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_status.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_status.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>Cluster Status</guimenu></term>
      <listitem>
       <para>
        Presents basic information about the cluster's health.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Monitors</guimenu></term>
      <listitem>
       <para>
        Shows the number of running monitors and their quorum.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>OSDs</guimenu></term>
      <listitem>
       <para>
        Shows the total number of OSDs, as well as the number of 'up' and 'in'
        OSDs.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Manager Daemons</guimenu></term>
      <listitem>
       <para>
        Shows the number of active and standby &mgr; daemons.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Hosts</guimenu></term>
      <listitem>
       <para>
        Shows the total number of cluster nodes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Object Gateways</guimenu></term>
      <listitem>
       <para>
        Shows the number of running &ogw;s.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Metadata Servers</guimenu></term>
      <listitem>
       <para>
        Shows the number of &mds;s.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>iSCSI Gateway</guimenu></term>
      <listitem>
       <para>
        Shows the number of configured &iscsi; gateways.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3 xml:id="dashboard-widgets-performance">
    <title>Performance Widgets</title>
    <para>
     <guimenu>Performance</guimenu> widgets refer to basic performance data of
     &ceph; clients.
    </para>
    <figure>
     <title>performance Widgets</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_perf.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_perf.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>Client IOPS</guimenu></term>
      <listitem>
       <para>
        The amount of clients' read and write operations per second.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Client Throughput</guimenu></term>
      <listitem>
       <para>
        The sum of clients' read and write operations per second.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Client Read/Write</guimenu></term>
      <listitem>
       <para>
        Visualizes clients' read/write ratio.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Recovery Throughput</guimenu></term>
      <listitem>
       <para>
        The throughput of data recovered per second.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Scrub</guimenu></term>
      <listitem>
       <para>
        Shows the scrub (see <xref linkend="op-pg-scrubpg"/>) status. It is either disabled, enabled, or active.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3 xml:id="dashboard-widgets-capacity">
    <title>Capacity Widgets</title>
    <para>
     <guimenu>Capacity</guimenu> widgets show brief information about the
     storage capacity.
    </para>
    <figure>
     <title>Capacity Widgets</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dashboard_widgets_capacity.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dashboard_widgets_capacity.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <variablelist>
     <varlistentry>
      <term><guimenu>Pools</guimenu></term>
      <listitem>
       <para>
        Shows the number of pools in the cluster.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Raw Capacity</guimenu></term>
      <listitem>
       <para>
        Shows the ratio of used and available raw storage capacity.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Objects</guimenu></term>
      <listitem>
       <para>
        Shows the number of data objects stored in the cluster.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>PGs per OSD</guimenu></term>
      <listitem>
       <para>
        Shows the number of placement groups per OSD.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>PG Status</guimenu></term>
      <listitem>
       <para>
        Displays a chart of the placement groups according to their status.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-user-mgmt">
  <title>Managing Dashboard Users and Roles</title>

  <para>
   Dashboard user management performed by &ceph; commands on the command line
   was already introduced in <xref linkend="dashboard-user-roles" />.
  </para>

  <para>
   This section describes how to manage user accounts by using the Dashboard
   Web user interface.
  </para>

  <sect2 xml:id="dashboard-listing-users">
   <title>Listing Users</title>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> in the utility menu and select <guimenu>User
    Management</guimenu>.
   </para>
   <para>
    The list contains each user's user name, full name, e-mail, and list of
    assigned roles.
   </para>
   <figure>
    <title>User Management</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_users.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_users.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-adding-users">
   <title>Adding New Users</title>
   <para>
    Click <guimenu>Add</guimenu> in the top left of the table heading to add a
    new user. Enter their user name, password, and optionally a full name and
    an e-mail.
   </para>
   <figure>
    <title>Adding a User</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_user_add.png" width="50%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_user_add.png" width="50%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Click the little pen icon to assign predefined roles to the user. Confirm
    with <guimenu>Create User</guimenu>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-editing-users">
   <title>Editing Users</title>
   <para>
    Click a user's table row and then select <guimenu>Edit</guimenu> to edit
    details about the user. Confirm with <guimenu>Update User</guimenu>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-deleting-users">
   <title>Deleting Users</title>
   <para>
    Click a user's table row and then select <guimenu>Delete</guimenu> to
    delete the user account. Activate the <guimenu>Yes, I am sure</guimenu>
    check box and confirm with <guimenu>Delete User</guimenu>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-listing-user-roles">
   <title>Listing User Roles</title>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_icon_gear.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> in the utility menu and select <guimenu>User
    Management</guimenu>. Then click the <guimenu>Roles</guimenu> tab.
   </para>
   <para>
    The list contains each role's name, description, and whether it is a system
    role.
   </para>
   <figure>
    <title>User Roles</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_roles.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_roles.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-adding-roles">
   <title>Adding Custom Roles</title>
   <para>
    Click <guimenu>Add</guimenu> in the top left of the table heading to add a
    new custom role. Enter its name, description, and set required permissions
    for individual topics.
   </para>
   <tip>
    <title>Purging Custom Roles</title>
    <para>
     If you create custom user roles and intend to remove the &ceph; cluster
     with the <command>ceph.purge</command> runner later on, you need to purge
     the custom roles first. Find more details in
     <xref linkend="deepsea-ceph-purge"/>.
    </para>
   </tip>
   <figure>
    <title>Adding a Role</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_roles_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_roles_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <tip>
    <title>Multiple Activation</title>
    <para>
     By activating the check box that precedes the topic name, you activate all
     permissions for that topic. By activating the <guimenu>All</guimenu> check
     box, you activate all permissions for all the topics.
    </para>
   </tip>
   <para>
    Confirm with <guimenu>Create Role</guimenu>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-editing-roles">
   <title>Editing Custom Roles</title>
   <para>
    Click a custom role's table row and then select <guimenu>Edit</guimenu> in
    the top left of the table heading to edit a description and permissions of
    the custom role. Confirm with <guimenu>Update Role</guimenu>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-deleting-roles">
   <title>Deleting Custom Roles</title>
   <para>
    Click a role's table row and then select <guimenu>Delete</guimenu> to
    delete the role. Activate the <guimenu>Yes, I am sure</guimenu> check box
    and confirm with <guimenu>Delete Role</guimenu>.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-cluster">
  <title>Viewing Cluster Internals</title>

  <para>
   The <guimenu>Cluster</guimenu> menu item lets you view detailed information
   about &ceph; cluster hosts, OSDs, MONs, &crushmap;, and the content of log
   files.
  </para>

  <sect2 xml:id="dashboard-cluster-hosts">
   <title>Cluster Nodes</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>Hosts</guimenu></menuchoice>
    to view a list of cluster nodes.
   </para>
   <figure>
    <title>Hosts</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_hosts.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Click a node name in the <guimenu>Hostname</guimenu> column to view
    performance details of the node.
   </para>
   <para>
    The <guimenu>Services</guimenu> column lists all daemons that are running
    on each related node. Click a daemon name to view its detailed
    configuration.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-monitors">
   <title>&mon;s</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>Monitors</guimenu></menuchoice>
    to view a list of cluster nodes with running &ceph; monitors. The list
    includes each monitor's rank number, public IP address, and number of open
    sessions.
   </para>
   <para>
    The list is divided into two tables: one for &mon;s that
    <emphasis>are</emphasis> in quorum, and the second one for &mon;s that
    <emphasis>are not</emphasis> in quorum.
   </para>
   <para>
    Click a node name in the <guimenu>Name</guimenu> column to view the related
    &mon; configuration.
   </para>
   <para>
    The <guimenu>Status</guimenu> table shows general statistics about the
    running &mon;s.
   </para>
   <figure>
    <title>&mon;s</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_mons.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-cluster-osds">
   <title>&osd;s</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>OSDs</guimenu></menuchoice>
    to view a list of nodes with running OSD daemons/disks. The list includes
    each node's name, status, number of placement groups, size, usage,
    reads/writes chart in time, and the rate of read/write operations per
    second.
   </para>
   <figure>
    <title>&osd;s</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Click <guimenu>Set Cluster-wide Flags</guimenu> in the table heading to pop
    up a window with a list of flags that apply to the whole cluster. You can
    activate or deactivate individual flags, and confirm with
    <guimenu>Submit</guimenu>.
   </para>
   <figure>
    <title>OSD Flags</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds_flags.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Click <guimenu>Set Cluster-wide Recovery Priority</guimenu> in the table
    heading to open a pop-up window with a list of OSD recovery priorities that
    apply to the whole cluster. You can activate the preferred priority
    profile, and fine tune the individual values below. Confirm with
    <guimenu>Submit</guimenu>.
   </para>
   <figure>
    <title>OSD Recovery Priority</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_osds_recover.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Click a node name in the <guimenu>Host</guimenu> column to view an extended
    table with details about the OSD setting and performance. Browsing through
    several tabs, you can see lists of <guimenu>Attributes</guimenu>,
    <guimenu>Metadata</guimenu>, <guimenu>Performance counter</guimenu>, and a
    graphical <guimenu>Histogram</guimenu> of reads and writes.
   </para>
   <figure>
    <title>OSD Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_isd_details.png" width="80%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <tip>
    <title>Perform Specific Tasks on OSDs</title>
    <para>
     After you click an OSD node name, its table row changes color slightly,
     meaning that you can now perform a task on the node. Click the down arrow
     in the top left of the table heading and select a task to perform, such as
     <guimenu>Deep Scrub</guimenu>. Optionally enter a required value for the
     task, and confirm to run it on the node.
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dahsboard-cluster-config">
   <title>Cluster Configuration</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>Configuration</guimenu></menuchoice>
    to view a complete list of &ceph; cluster configuration options. The list
    contains the name of the option, its short description, and its current and
    default values.
   </para>
   <figure>
    <title>Cluster Configuration</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_cluster_config.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Click a specific option row to highlight and see detailed information about
    the option, such as its type of value, minimum and maximum permitted
    values, whether it can be updated at runtime, and many more.
   </para>
   <para>
    After highlighting a specific option, you can edit its value(s) by clicking
    the <guimenu>Edit</guimenu> button in the top left of the table heading.
    Confirm changes with <guimenu>Save</guimenu>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-crushmap">
   <title>&crushmap;</title>
   <para>
    Click <menuchoice><guimenu>Cluster</guimenu><guimenu>CRUSH
    map</guimenu></menuchoice> to view a &crushmap; of the cluster. For more
    general information on &crushmap;s, refer to <xref linkend="op-crush" />.
   </para>
   <para>
    Click the root, nodes, or individual OSDs to view more detailed
    information, such as crush weight, depth in the map tree, device class of
    the OSD, and many more.
   </para>
   <figure>
    <title>&crushmap;</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_crushmap.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-cluster-mgr-plugins">
   <title>Manager Modules</title>
   <para>
    Click <menuchoice><guimenu>Cluster</guimenu><guimenu>Manager
    modules</guimenu></menuchoice> to view a list of available &mgr; modules.
    Each line consists of a module name and information on whether it is
    currently enabled or not.
   </para>
   <figure>
    <title>Manager Modules</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_mgr_modules.png" width="50%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    After highlighting a specific module, you can see its detailed settings in
    the <guimenu>Details</guimenu> table below. Edit them by clicking the
    <guimenu>Edit</guimenu> button in the top left of the table heading.
    Confirm changes with <guimenu>Update</guimenu>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-cluster-logs">
   <title>Logs</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>Logs</guimenu></menuchoice>
    to view a list of cluster's recent log entries. Each line consists of a
    time stamp, the type of the log entry, and the logged message itself.
   </para>
   <para>
    Click the <guimenu>Audit Logs</guimenu> tab to view log entries of the
    auditing subsystem. Refer to <xref linkend="dashboard-auditing" /> for
    commands to enable or disable auditing.
   </para>
   <figure>
    <title>Logs</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_logs.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-pools">
  <title>Managing Pools</title>

  <tip>
   <title>More Information on Pools</title>
   <para>
    For more general information about &ceph; pools, refer to
    <xref linkend="ceph-pools"/>. For information specific to erasure code
    pools, refer to <xref linkend="cha-ceph-erasure"/>.
   </para>
  </tip>

  <para>
   To list all available pools, click <guimenu>Pools</guimenu> from the main
   menu.
  </para>

  <para>
   The list shows each pool's name, type, related application, placement group
   status, replica size, erasure coded profile, usage, and read/write
   statistics.
  </para>

  <figure>
   <title>List of Pools</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   To view more detailed information about a pool, activate its table row.
  </para>

  <sect2 xml:id="dashboard-pools-create">
   <title>Adding a New Pool</title>
   <para>
    To add a new pool, click <guimenu>Add</guimenu> in the top left of the
    pools table. In the pool form you can enter the pool's name, type, number
    of placement groups, and additional information, such as pool's
    applications, and compression mode and algorithm. The pool form itself
    pre-calculates the number of placement groups that best suited to this
    specific pool. The calculation is based on the amount of OSDs in the
    cluster and the selected pool type with its specific settings. As soon as a
    placement groups number is set manually, it will be replaced by a
    calculated number. Confirm with <guimenu>Create pool</guimenu>.
   </para>
   <figure>
    <title>Adding a New Pool</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-pools-delete">
   <title>Deleting Pools</title>
   <para>
    To delete a pool, click its table row and click <guimenu>Delete</guimenu>
    in the top left of the pools table.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-pools-edit">
   <title>Editing a Pool's Options</title>
   <para>
    To edit a pool's options, click its table row and select
    <guimenu>Edit</guimenu> in the top left of the pools table.
   </para>
   <para>
    You can change the name of the pool, increase the number of placement
    groups, change the list of the pool's applications and compression
    settings. Confirm with <guimenu>Edit pool</guimenu>.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-rbds">
  <title>Managing &rbd;s</title>

  <para>
   To list all available &rbd;s (RBDs), click
   <menuchoice><guimenu>Block</guimenu><guimenu>Images</guimenu></menuchoice>
   from the main menu.
  </para>

  <para>
   The list shows brief information about the device, such as the device's
   name, the related pool name, size of the device, number and size of objects
   on the device.
  </para>

  <figure>
   <title>List of RBD Images</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="dash_rbd_images.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="dash_rbd_images.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="dashboard-rbds-details">
   <title>Viewing Details about RBDs</title>
   <para>
    To view more detailed information about a device, click its row in the
    table:
   </para>
   <figure>
    <title>RBD Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_details.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_details.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-rbds-configuration">
   <title>Viewing RBD's Configuration</title>
   <para>
    To view detailed configuration of a device, click its row in the table and
    then the <guimenu>Configuration</guimenu> tab in the lower table:
   </para>
   <figure>
    <title>RBD Configuration</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_config.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_config.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-rbds-create">
   <title>Creating RBDs</title>
   <para>
    To add a new device, click <guimenu>Add</guimenu> in the top left of the
    table heading and do the following on the <guimenu>Create RBD</guimenu>
    screen:
   </para>
   <figure>
    <title>Adding a New RBD</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbd_add.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbd_add.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      Enter the name of the new device. Refer to
      <xref linkend="sysreq-naming"/> for naming limitations.
     </para>
    </step>
    <step>
     <para>
      Select the pool with the 'rbd' application assigned from which the new
      RBD device will be created.
     </para>
    </step>
    <step>
     <para>
      Specify the size of the new device.
     </para>
    </step>
    <step>
     <para>
      Specify additional options for the device. To fine-tune the device
      parameters, click <guimenu>Advanced</guimenu> and enter values for object
      size, stripe unit, or stripe count. To enter Quality of Service (QoS)
      limits, click <guimenu>Quality of Service</guimenu> and enter them.
     </para>
    </step>
    <step>
     <para>
      Confirm with <guimenu>Create RBD</guimenu>.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dashboard-rbd-delete">
   <title>Deleting RBDs</title>
   <para>
    To delete a device, click its row in the table and select
    <guimenu>Delete</guimenu> in the top left of the table heading. Confirm the
    deletion with <guimenu>Delete RBD</guimenu>.
   </para>
   <tip>
    <title>Moving RBDs to Trash</title>
    <para>
     Deleting an RBD is an irreversible action. If you <guimenu>Move to
     Trash</guimenu> instead, you can restore the device later on by selecting
     it on the <guimenu>Trash</guimenu> tab of the main table and clicking
     <guimenu>Restore</guimenu> in the top left of the table heading.
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dashboard-rbds-snapshots">
   <title>&rbd; Snapshots</title>
   <para>
    To create a &rbd; snapshot, click the device's table row and in the
    <guimenu>Snapshots</guimenu> tab below the main table, click
    <guimenu>Create</guimenu> in the top left of the table heading. Enter the
    snapshot's name and confirm with <guimenu>Create Snapshot</guimenu>.
   </para>
   <para>
    After selecting a snapshot, you can perform additional actions on the
    device, such as rename, protect, clone, copy, or delete.
    <guimenu>Rollback</guimenu> restores the device's state from the current
    snapshot.
   </para>
   <figure>
    <title>RBD Snapshots</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_rbd_images_snapshots.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_rbd_images_snapshots.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-iscsi">
   <title>Managing &igw;s</title>
   <tip>
    <title>More Information on &igw;s</title>
    <para>
     For more general information about &igw;s, refer to
     <xref linkend="cha-ceph-as-iscsi"/> and <xref linkend="cha-ceph-iscsi"/>.
    </para>
   </tip>
   <para>
    To list all available gateways and mapped images, click
    <menuchoice><guimenu>Block</guimenu><guimenu>iSCSI</guimenu></menuchoice>
    from the main menu. An <guimenu>Overview</guimenu> tab opens, listing
    currently configured &igw;s and mapped RBD images.
   </para>
   <para>
    The <guimenu>Gateways</guimenu> table lists each gateway's state, number of
    &iscsi; targets, and number of sessions. The <guimenu>Images</guimenu>
    table lists each mapped image's name, related pool name backstore type, and
    other statistical details.
   </para>
   <para>
    The <guimenu>Targets</guimenu> tab lists currently configured &iscsi;
    targets.
   </para>
   <figure>
    <title>List of &iscsi; Targets</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_igws.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_igws.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    To view more detailed information about a target, click its table row. A
    tree-structured schema opens, listing disks, portals, initiators, and
    groups. Click an item to expand it and view its detailed contents,
    optionally with a related configuration in the table on the right.
   </para>
   <figure>
    <title>&iscsi; Target Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3 xml:id="dashboard-iscsi-create">
    <title>Adding &iscsi; Targets</title>
    <para>
     To add a new &iscsi; target, click <guimenu>Add</guimenu> in the top left
     of the <guimenu>Targets</guimenu> table and enter the required
     information.
    </para>
    <figure>
     <title>Adding a New Target</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       Enter the target address of the new gateway.
      </para>
     </step>
     <step>
      <para>
       Click <guimenu>Add portal</guimenu> and select one or multiple iSCSI
       portals from the list.
      </para>
     </step>
     <step>
      <para>
       Click <guimenu>Add image</guimenu> and select one or multiple RBD images
       for the gateway.
      </para>
     </step>
     <step>
      <para>
       If you need to use authentication to access the gateway, activate the
       <guimenu>Authentication</guimenu> check box and enter the credentials.
       You can find more advanced authentication options after activating
       <guimenu>Mutual authentication</guimenu> and <guimenu>Discovery
       authentication</guimenu>.
      </para>
     </step>
     <step>
      <para>
       Confirm with <guimenu>Create Target</guimenu>.
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="dashboard-iscsi-edit">
    <title>Editing &iscsi; Targets</title>
    <para>
     To edit an existing &iscsi; target, click its row in the
     <guimenu>Targets</guimenu> table and click <guimenu>Edit</guimenu> in the
     top left of the table.
    </para>
    <para>
     You can then modify the &iscsi; target, add or delete portals, and add or
     delete related RBD images. You can also adjust authentication information
     for the gateway.
    </para>
   </sect3>
   <sect3 xml:id="dashboard-iscsi-delete">
    <title>Deleting &iscsi; Targets</title>
    <para>
     To delete an &iscsi; target, click its table row and select
     <guimenu>Delete</guimenu> in the top left of the gateways table. Activate
     <guimenu>Yes, I am sure</guimenu> and confirm with <guimenu>Delete
     iSCSI</guimenu>.
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dash-rbd-qos">
   <title>RBD Quality of Service (QoS)</title>
   <tip>
    <title>For More Information</title>
    <para>
     For more general information and a description of RBD QoS configuration
     options, refer to <xref linkend="rbd-qos" />.
    </para>
   </tip>
   <para>
    The QoS options can be configured at different levels.
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Globally
     </para>
    </listitem>
    <listitem>
     <para>
      On a per-pool basis
     </para>
    </listitem>
    <listitem>
     <para>
      On a per-image basis
     </para>
    </listitem>
   </itemizedlist>
   <para>
    The <emphasis>global</emphasis> configuration is at the top of the list and
    will be used for all newly created RBD images and for those images that do
    not override these values on the pool or RBD image layer. An option value
    specified globally can be overridden on a per-pool or per-image basis.
    Options specified on a pool will be applied to all RBD images of that pool
    unless overridden by a configuration option set on an image. Options
    specified on an image will override options specified on a pool and will
    override options specified globally.
   </para>
   <para>
    This way it is possible to define defaults globally, adapt them for all RBD
    images of a specific pool, and override the pool configuration for
    individual RBD images.
   </para>
   <sect3 xml:id="dash-rbd-qos-global">
    <title>Configuring Options Globally</title>
    <para>
     To configure RBD options globally, select
     <menuchoice><guimenu>Cluster</guimenu>
     <guimenu>Configuration</guimenu></menuchoice> from the main menu.
    </para>
    <para>
     To list all available global configuration options, click
     <menuchoice><guimenu>Level</guimenu>
     <guimenu>Advanced</guimenu></menuchoice>. Then filter the results of the
     table by filtering for 'rbd_qos' in the search field. This lists all
     available configuration options for QoS. To change a value, click its row
     in the table, then select <guimenu>Edit</guimenu> at the top left of the
     table. The <guimenu>Edit</guimenu> dialog contains six different fields
     for specifying values. The RBD configuration option values are required in
     the <guimenu>mgr</guimenu> text box. Note that unlike the other dialogs,
     this one does not allow you to specify the value in convenient units. You
     need to set these values in either bytes or IOPS, depending on the option
     you are editing.
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-pool-create">
    <title>Configuring Options on a New Pool</title>
    <para>
     To create a new pool and configure RBD configuration options on it, click
     <menuchoice><guimenu>Pools</guimenu>
     <guimenu>Create</guimenu></menuchoice>. Select
     <guimenu>replicated</guimenu> as pool type. You will then need to add the
     <guimenu>rbd</guimenu> application tag to the pool to be able to configure
     the RBD QoS options.
    </para>
    <note>
     <para>
      It is not possible to configure RBD QoS configuration options on an
      erasure coded pool. To configure the RBD QoS options for erasure coded
      pools, you need to edit the replicated metadata pool of an RBD image. The
      configuration will then be applied to the erasure coded data pool of that
      image.
     </para>
    </note>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-pool-edit">
    <title>Configuring Options on an Existing Pool</title>
    <para>
     To configure RBD QoS options on an existing pool, click
     <guimenu>Pools</guimenu>, then click the pool's table row and select
     <guimenu>Edit</guimenu> at the top left of the table.
    </para>
    <para>
     You should see the <guimenu>RBD Configuration</guimenu> section in the
     dialog, followed by a <guimenu>Quality of Service</guimenu> section.
    </para>
    <note>
     <para>
      If you see neither the <guimenu>RBD Configuration</guimenu> nor the
      <guimenu>Quality of Service</guimenu> section, you are likely either
      editing an <emphasis>erasure coded</emphasis> pool, which cannot be used
      to set RBD configuration options, or the pool is not configured to be
      used by RBD images. In the latter case, assign the <guimenu>rbd</guimenu>
      application tag to the pool and the corresponding configuration sections
      will show up.
     </para>
    </note>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-qos">
    <title>Configuration Options</title>
    <para>
     Click <guimenu>Quality of Service +</guimenu> to expand the configuration
     options. A list of all available options will show up. The units of the
     configuration options are already shown in the text boxes. In case of any
     bytes per second (BPS) option, you are free to use shortcuts such as '1M'
     or '5G'. They will be automatically converted to '1 MB/s' and '5 GB/s'
     respectively.
    </para>
    <para>
     By clicking the reset button to the right of each text box, any value set
     on the pool will be removed. This does not remove configuration values of
     options configured globally or on an RBD image.
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-create">
    <title>Creating RBD QoS Options with a New RBD Image</title>
    <para>
     To create an RBD image with RBD QoS options set on that image, select
     <menuchoice><guimenu>Block</guimenu>
     <guimenu>Images</guimenu></menuchoice> and then click
     <guimenu>Create</guimenu>. Click <guimenu>Advanced</guimenu> to expand the
     advanced configuration section. Click <guimenu>Quality of
     Service</guimenu> to open all available configuration options.
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-edit">
    <title>Editing RBD QoS Options on Existing Images</title>
    <para>
     To edit RBD QoS options on an existing image, select
     <menuchoice><guimenu>Block</guimenu>
     <guimenu>Images</guimenu></menuchoice>, then click the pool's table row,
     and lastly click <guimenu>Edit</guimenu>. The edit dialog will show up.
     Click <guimenu>Advanced</guimenu> to expand the advanced configuration
     section. Click <guimenu>Quality of Service</guimenu> to open all available
     configuration options.
    </para>
   </sect3>
   <sect3 xml:id="dash-rbd-qos-image-copy">
    <title>Changing Configuration Options When Copying or Cloning Images</title>
    <para>
     If an RBD image is cloned or copied, the values set on that particular
     image will be copied too, by default. If you want to change them while
     copying or cloning, you can do so by specifying the updated configuration
     values in the copy/clone dialog, the same way as when creating or editing
     an RBD image. Doing so will only set (or reset) the values for the RBD
     image that is copied or cloned. This operation changes neither the source
     RBD image configuration, nor the global configuration.
    </para>
    <para>
     If you choose to reset the option value on copying/cloning, no value for
     that option will be set on that image. This means that any value of that
     option specified for the parent pool will be used if the parent pool has
     the value configured. Otherwise, the global default will be used.
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dash-rbd-mirror">
   <title>RBD Mirroring</title>
   <tip>
    <title>General Information</title>
    <para>
     For general information and the command line approach to &rbd; mirroring,
     refer to <xref linkend="ceph-rbd-mirror" />.
    </para>
   </tip>
   <para>
    You can use the &dashboard; to configure replication of RBD images between
    two or more clusters.
   </para>
   <sect3 xml:id="rbd-mirror-primary-secondary">
    <title>Primary Cluster and Secondary Cluster(s)</title>
    <para>
     <emphasis>Primary</emphasis> cluster is where the original pool with
     images is created. <emphasis>Secondary</emphasis> cluster(s) is where the
     pool/images are replicated from the <emphasis>primary</emphasis> cluster.
    </para>
    <note>
     <title>Relative Naming</title>
     <para>
      The <emphasis>primary</emphasis> and <emphasis>secondary</emphasis> terms
      can be relative in the context of replication because they relate more to
      individual pools than to clusters. For example, in two-way replication,
      one pool can be mirrored from the <emphasis>primary</emphasis> cluster to
      the <emphasis>secondary</emphasis> one, while another pool can be
      mirrored from the <emphasis>secondary</emphasis> cluster to the
      <emphasis>primary</emphasis> one.
     </para>
    </note>
   </sect3>
   <sect3 xml:id="rbd-mirroring-replication-modes">
    <title>Replication Modes</title>
    <para>
     There are two modes of data replication:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       Using the <emphasis>pool</emphasis> mode, you replicate all the RBD
       images in a pool.
      </para>
     </listitem>
     <listitem>
      <para>
       Using the <emphasis>image</emphasis> mode, you can activate mirroring
       only for specific image(s) in a pool.
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="rbd-mirror-gui-daemon">
    <title>Configure the <systemitem class="daemon">rbd-mirror</systemitem> Daemon</title>
    <para>
     The <systemitem class="daemon">rbd-mirror</systemitem> daemon performs the
     actual cluster data replication. To install, configure, and run it, follow
     these steps:
    </para>
    <procedure>
     <step>
      <para>
       The <systemitem class="daemon">rbd-mirror</systemitem> daemon needs to
       run on one of the nodes on the <emphasis>secondary</emphasis> cluster
       other than the &adm;. Because it is not installed by default, install
       it:
      </para>
<screen>&prompt.sminion;zypper install rbd-mirror</screen>
     </step>
     <step>
      <para>
       On the <emphasis>primary</emphasis> cluster, create a unique &ceph; user
       ID for the <systemitem class="daemon">rbd-mirror</systemitem> daemon
       process. In this example, we will use 'uid1' as the user ID:
      </para>
<screen>&prompt.cephuser;ceph auth get-or-create client.rbd-mirror.uid1 \
 mon 'profile rbd-mirror' osd 'profile rbd'
[client.rbd-mirror.uid1]
	key = AQBbDJddZKLBIxAAdsmSCCjXoKwzGkGmCpUQ9g==</screen>
     </step>
     <step>
      <para>
       On the node where you previously installed the
       <package>rbd-mirror</package> package on the
       <emphasis>secondary</emphasis> cluster, create the same &ceph; user and
       save the output to a keyring:
      </para>
<screen>&prompt.sminion;ceph auth get-or-create client.rbd-mirror.uid1 \
 mon 'profile rbd-mirror' osd 'profile rbd' \
 > /etc/ceph/ceph.client.rbd-mirror.uid1.keyring</screen>
     </step>
     <step>
      <para>
       On the same node, enable and run the
       <systemitem class="daemon">rbd-mirror</systemitem> service:
      </para>
<screen>&prompt.sminion;systemctl enable ceph-rbd-mirror@rbd-mirror.uid1
&prompt.sminion;systemctl start ceph-rbd-mirror@rbd-mirror.uid1
&prompt.sminion;systemctl status ceph-rbd-mirror@rbd-mirror.uid1
● ceph-rbd-mirror@rbd-mirror.uid1.service - Ceph rbd mirror daemon
   Loaded: loaded (/usr/lib/systemd/system/ceph-rbd-mirror@.service; enabled; vendor preset: disabled)
   Active: active (running) since Fri 2019-10-04 07:48:53 EDT; 2 days ago
 Main PID: 212434 (rbd-mirror)
    Tasks: 47
   CGroup: /system.slice/system-ceph\x2drbd\x2dmirror.slice/ceph-rbd-mirror@rbd-mirror.uid1.service
           └─212434 /usr/bin/rbd-mirror -f --cluster ceph --id rbd-mirror.test --setuser ceph --setgroup ceph

Oct 04 07:48:53 doc-ses6min4 systemd[1]: Started Ceph rbd mirror daemon.
</screen>
     </step>
     <step>
      <para>
       On the <emphasis>secondary</emphasis> cluster's &dashboard;, navigate to
       <menuchoice><guimenu>Block</guimenu><guimenu>Mirroring</guimenu></menuchoice>.
       The <guimenu>Daemons</guimenu> table to the left shows actively running
       <systemitem>rbd-mirror</systemitem> daemons and their health.
      </para>
      <figure>
       <title>Running <systemitem class="daemon">rbd-mirror</systemitem> Daemons</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-daemon.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-daemon.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="rbd-mirror-gui">
    <title>Configure Pool Replication in &dashboard;</title>
    <para>
     The <systemitem class="daemon">rbd-mirror</systemitem> daemon needs to
     have access to the primary cluster to be able to mirror RBD images.
     Therefore you need to create a <emphasis>peer</emphasis> &ceph; user
     account on the primary cluster and let the secondary cluster know about
     its keyring:
    </para>
    <procedure>
     <step>
      <para>
       On the <emphasis>primary</emphasis> cluster, create a new
       'client.rbd-mirror-peer' user that will be used for data replication:
      </para>
<screen>&prompt.cephuser;ceph auth get-or-create client.rbd-mirror-peer \
 mon 'profile rbd' osd 'profile rbd'
[client.rbd-mirror-peer]
	key = AQBbDJddZKLBIxAAdsmSCCjXoKwzGkGmCpUQ9g==</screen>
     </step>
     <step>
      <para>
       On both the <emphasis>primary</emphasis> and
       <emphasis>secondary</emphasis> cluster, create a pool with an identical
       name and assign the 'rbd' application to it. Refer to
       <xref linkend="dashboard-pools-create"/> for more details on creating a
       new pool.
      </para>
      <figure>
       <title>Creating a Pool with RBD Application</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       On both the <emphasis>primary</emphasis> and
       <emphasis>secondary</emphasis> cluster's dashboards, navigate to
       <menuchoice><guimenu>Block</guimenu><guimenu>Mirroring</guimenu></menuchoice>.
       In the <guimenu>Pools</guimenu> table on the right, click the name of
       the pool to replicate, and after clicking <guimenu>Edit Mode</guimenu>,
       select the replication mode. In this example, we will work with a
       <emphasis>pool</emphasis> replication mode, which means that all images
       within a given pool will be replicated. Confirm with
       <guimenu>Update</guimenu>.
      </para>
      <figure>
       <title>Configuring the Replication Mode</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-mode.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-mode.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <important>
       <title>Error or Warning on the Primary Cluster</title>
       <para>
        After updating the replication mode, an error or warning flag will
        appear in the corresponding right column. That is because the pool has
        no peer user for replication assigned yet. Ignore this flag for the
        <emphasis>primary</emphasis> cluster as we assign a peer user to the
        <emphasis>secondary</emphasis> cluster only.
       </para>
      </important>
     </step>
     <step>
      <para>
       On the <emphasis>secondary</emphasis> cluster's Dashboard, navigate to
       <menuchoice><guimenu>Block</guimenu><guimenu>Mirroring</guimenu></menuchoice>.
       Register the 'client.rbd-mirror-peer' user keyring to the mirrored pool
       by clicking the pool's name and selecting <guimenu>Add Peer</guimenu>.
       Provide the <emphasis>primary</emphasis> cluster's details:
      </para>
      <figure>
       <title>Adding Peer Credentials</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-peer.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-peer.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <variablelist>
       <varlistentry>
        <term><guimenu>Cluster Name</guimenu></term>
        <listitem>
         <para>
          An arbitrary unique string that identifies the primary cluster, such
          as 'primary'. The cluster name needs to be different from the real
          secondary cluster's name.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>CephX ID</guimenu></term>
        <listitem>
         <para>
          The &ceph; user ID that you created as a mirroring peer. In this
          example it is 'rbd-mirror-peer'.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>Monitor Addresses</guimenu></term>
        <listitem>
         <para>
          Comma separated list of IP addresses/host names of the primary
          cluster's &mon; nodes.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>CephX Key</guimenu></term>
        <listitem>
         <para>
          The key related to the peer user ID. You can retrieve it by running
          the following example command on the primary cluster:
         </para>
<screen>&prompt.cephuser;ceph auth print_key client.rbd-mirror-peer</screen>
        </listitem>
       </varlistentry>
      </variablelist>
      <para>
       Confirm with <guimenu>Submit</guimenu>.
      </para>
      <figure>
       <title>List of Replicated Pools</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-list.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-list.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="rbd-mirror-test">
    <title>Verify That RBD Image Replication Works</title>
    <para>
     When the <systemitem class="daemon">rbd-mirror</systemitem> daemon is
     running and RBD image replication is configured on the &dashboard;, it is
     time to verify whether the replication actually works:
    </para>
    <procedure>
     <step>
      <para>
       On the <emphasis>primary</emphasis> cluster's &dashboard;, create an RBD
       image so that its parent pool is the pool that you already created for
       replication purposes. Enable the <option>Exclusive lock</option> and
       <option>Journaling</option> features for the image. Refer to
       <xref linkend="dashboard-rbds-create"/> for details on how to create RBD
       images.
      </para>
      <figure>
       <title>New RBD Image</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-image.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-image.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       After you create the image that you want to replicate, open the
       <emphasis>secondary</emphasis> cluster's &dashboard; and navigate to
       <menuchoice><guimenu>Block</guimenu><guimenu>Mirroring</guimenu></menuchoice>.
       The <guimenu>Pools</guimenu> table on the right will reflect the change
       in the number of <guimenu># Remote</guimenu> images and synchronize the
       number of <guimenu># Local</guimenu> images.
      </para>
      <figure>
       <title>New RBD Image Synchronized</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="rbd-mirror-pool-list-1.png" width="75%"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="rbd-mirror-pool-list-1.png" width="75%"/>
        </imageobject>
       </mediaobject>
      </figure>
      <tip>
       <title>Replication Progress</title>
       <para>
        The <guimenu>Images</guimenu> table at the bottom of the page shows the
        status of replication of RBD images. The <guimenu>Issues</guimenu> tab
        includes possible problems, the <guimenu>Syncing</guimenu> tab displays
        the progress of image replication, and the <guimenu>Ready</guimenu> tab
        lists all images with successful replication.
       </para>
       <figure>
        <title>RBD Images' Replication Status</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="rbd-mirror-images-status.png" width="75%"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="rbd-mirror-images-status.png" width="75%"/>
         </imageobject>
        </mediaobject>
       </figure>
      </tip>
     </step>
     <step>
      <para>
       On the <emphasis>primary</emphasis> cluster, write data to the RBD
       image. On the <emphasis>secondary</emphasis> cluster's &dashboard;,
       navigate to
       <menuchoice><guimenu>Block</guimenu><guimenu>Images</guimenu></menuchoice>
       and monitor whether the corresponding image's size is growing as the
       data on the primary cluster is written.
      </para>
     </step>
    </procedure>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dash-webui-nfs">
  <title>Managing &ganesha;</title>

  <tip>
   <title>More Information on &ganesha;</title>
   <para>
    For more general information about &ganesha;, refer to
    <xref linkend="cha-ceph-nfsganesha"/>.
   </para>
  </tip>

  <para>
   To list all available NFS exports, click <guimenu>NFS</guimenu> from the
   main menu.
  </para>

  <para>
   The list shows each export's directory, daemon host name, type of storage
   back-end, and access type.
  </para>

  <figure>
   <title>List of NFS Exports</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   To view more detailed information about an NFS export, click its table row
   in the table.
  </para>

  <figure>
   <title>NFS Export Details</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="dash-webui-nfs-create">
   <title>Adding NFS Exports</title>
   <para>
    To add a new NFS export, click <guimenu>Add</guimenu> in the top left of
    the exports table and enter the required information.
   </para>
   <figure>
    <title>Adding a New NFS Export</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      Select one or more &ganesha; daemons that will run the export.
     </para>
    </step>
    <step>
     <para>
      Select a storage back-end&mdash;either <guimenu>CephFS</guimenu> or
      <guimenu>Object Gateway</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Select a user ID and other back-end related options.
     </para>
    </step>
    <step>
     <para>
      Enter the directory path for the NFS export. If the directory does not
      exist on the server, it will be created.
     </para>
    </step>
    <step>
     <para>
      Specify other NFS related options, such as supported NFS protocol
      version, pseudo, access type, squashing, or transport protocol.
     </para>
    </step>
    <step>
     <para>
      If you need to limit access to specific clients only, click <guimenu>Add
      clients</guimenu> and add their IP addresses together with access type
      and squashing options.
     </para>
    </step>
    <step>
     <para>
      Confirm with <guimenu>Submit</guimenu>.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="dash-webui-nfs-delete">
   <title>Deleting NFS Exports</title>
   <para>
    To delete an export, click its table row and select
    <guimenu>Delete</guimenu> in the top left of the exports table.
   </para>
  </sect2>

  <sect2 xml:id="dash-webui-nfs-edit">
   <title>Editing NFS Exports</title>
   <para>
    To edit an existing export, click its table row and click
    <guimenu>Edit</guimenu> in the top left of the exports table.
   </para>
   <para>
    You can then adjust all the details of the NFS export.
   </para>
   <figure>
    <title>Editing an NFS Export</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-mds">
  <title>Managing &ceph; File Systems</title>

  <tip>
   <title>For More Information</title>
   <para>
    To find detailed information about &cephfs;, refer to
    <xref linkend="cha-ceph-cephfs" />.
   </para>
  </tip>

  <sect2 xml:id="dashboard-mds-overview">
   <title>Viewing &cephfs; Overview</title>
   <para>
    Click <guimenu>Filesystems</guimenu> from the main menu to view the
    overview of configured file systems. The main table shows each file
    system's name, date of creation, and whether it is enabled or not.
   </para>
   <para>
    By clicking on a file system's table row, you reveal details about its rank
    and pools added to the file system.
   </para>
   <figure>
    <title>&cephfs; Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_cephfs_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_cephfs_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    At the bottom of the screen, you can see statistics counting the number of
    related MDS inodes and client requests, collected in real time.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-ogw">
  <title>Managing &ogw;s</title>

  <tip>
   <title>More Information on &ogw;</title>
   <para>
    For more general information about &ogw;, refer to
    <xref linkend="cha-ceph-gw" />.
   </para>
  </tip>

  <sect2 xml:id="dashboard-ogw-view">
   <title>Viewing &ogw;s</title>
   <para>
    To view a list of configured &ogw;s, click <menuchoice><guimenu>Object
    Gateway</guimenu><guimenu>Daemons</guimenu></menuchoice>. The list includes
    the ID of the gateway, host name of the cluster node where the gateway
    daemon is running, and the gateway's version number.
   </para>
   <para>
    Click a gateway's table row to view detailed information about the gateway.
    The <guimenu>Performance Counters</guimenu> tab shows details about
    read/write operations and cache statistics.
   </para>
   <figure>
    <title>Gateway's Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_ogw_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_ogw_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="dashboard-ogw-user">
   <title>Managing &ogw; Users</title>
   <para>
    Click <menuchoice><guimenu>Object
    Gateway</guimenu><guimenu>Users</guimenu></menuchoice> to view a list of
    existing &ogw; users.
   </para>
   <para>
    Click a user's table row to view details about the user account, such as
    status information or the user and bucket quota details.
   </para>
   <figure>
    <title>Gateway Users</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="dash_ogw_users_details.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="dash_ogw_users_details.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3 xml:id="dashboard-ogw-user-create">
    <title>Adding a New Gateway User</title>
    <para>
     To add a new gateway user, click <guimenu>Add</guimenu> in the top left of
     the table heading. Fill in their credentials, details about the S3 key and
     user/bucket quota, then confirm with <guimenu>Add</guimenu>.
    </para>
    <figure>
     <title>Adding a New Gateway User</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_ogw_user_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_ogw_user_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3 xml:id="dashboard-ogw-user-delete">
    <title>Deleting Gateway Users</title>
    <para>
     To delete a gateway user, click the user's table row and select
     <guimenu>Delete</guimenu> in the top left of the table heading. Activate
     the <guimenu>Yes, I am sure</guimenu> check box and confirm with
     <guimenu>Delete User</guimenu>.
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-user-edit">
    <title>Editing Gateway User Details</title>
    <para>
     To change gateway user details, click the user's table row and select
     <guimenu>Edit</guimenu> in the top left of the table heading.
    </para>
    <para>
     Modify basic or additional user information, such as their capabilities,
     keys, sub-users, and quota information. Confirm with
     <guimenu>Update</guimenu>.
    </para>
    <para>
     The <guimenu>Keys</guimenu> tab includes a read-only list of the gateway's
     users and their access and secret keys. To view the keys, click a user
     name in the list and then select <guimenu>Show</guimenu> in the top left
     of the table heading. In the <guimenu>S3 Key</guimenu> dialog, click the
     'eye' icon to unveil the keys, or click the clipboard icon to copy the
     related key to the clipboard.
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-ogw-bucket">
   <title>Managing the &ogw; Buckets</title>
   <para>
    &ogw; (OGW) buckets implement the functionality of &ostack; &swift;
    containers. &ogw; buckets serve as containers for storing data objects.
   </para>
   <para>
    Click <menuchoice><guimenu>Object
    Gateway</guimenu><guimenu>Buckets</guimenu></menuchoice> to view a list of
    OGW buckets.
   </para>
   <sect3 xml:id="dashboard-ogw-bucket-create">
    <title>Adding a New Bucket</title>
    <para>
     To add a new OGW bucket, click <guimenu>Add</guimenu> in the top left of
     the table heading. Enter the bucket's name and select its owner. Confirm
     with <guimenu>Add</guimenu>.
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-view">
    <title>Viewing Bucket Details</title>
    <para>
     To view detailed information about an OGW bucket, click its table row.
    </para>
    <figure>
     <title>Gateway Bucket Details</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="dash_ogw_bucket_details.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="dash_ogw_bucket_details.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <tip>
     <title>Bucket Quota</title>
     <para>
      Below the <guimenu>Details</guimenu> table, you can find details about
      the bucket quota settings.
     </para>
    </tip>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-edit">
    <title>Updating the Owner of a Bucket</title>
    <para>
     Click a bucket table row, then select <guimenu>Edit</guimenu> in the top
     left of the table heading.
    </para>
    <para>
     Update the owner of the bucket and confirm with <guimenu>Update</guimenu>.
    </para>
   </sect3>
   <sect3 xml:id="dashboard-ogw-bucket-delete">
    <title>Deleting a Bucket</title>
    <para>
     To delete an OGW bucket, click its table row and select
     <guimenu>Delete</guimenu> in the top left of the table heading. Activate
     the <guimenu>Yes, I am sure</guimenu> check box, and confirm with
     <guimenu>Delete bucket</guimenu>.
    </para>
   </sect3>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-initial-configuration">
  <title>Manual Configuration</title>

  <para>
   This section introduces advanced information for users that prefer
   configuring dashboard's settings manually on the command line.
  </para>

  <sect2 xml:id="dashboard-ssl">
   <title>TLS/SSL Support</title>
   <para>
    All HTTP connections to the dashboard are secured with SSL/TLS by default.
    A secure connection requires an SSL certificate. You can either use a
    self-signed certificate, or generate a certificate and have a well known
    certificate authority (CA) sign it.
   </para>
   <tip>
    <title>Disabling SSL</title>
    <para>
     You may want to disable the SSL support for a specific reason. For
     example, if the dashboard is running behind a proxy that does not support
     SSL.
    </para>
    <para>
     Use caution when disabling SSL as <emphasis role="bold">user names and
     passwords</emphasis> will be sent to the dashboard
     <emphasis role="bold">unencrypted</emphasis>.
    </para>
    <para>
     To disable SSL, run:
    </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/ssl false
</screen>
   </tip>
   <tip>
    <title>Restart &mgr; Processes</title>
    <para>
     You need to restart the &mgr; processes manually after changing the SSL
     certificate and key. You can do so by either running
    </para>
<screen>&prompt.cephuser;ceph mgr fail<replaceable>ACTIVE-MANAGER-NAME</replaceable></screen>
    <para>
     or by disabling and re-enabling the dashboard module, which also triggers
     the manager to respawn itself:
    </para>
<screen>
&prompt.cephuser;ceph mgr module disable dashboard
&prompt.cephuser;ceph mgr module enable dashboard
</screen>
   </tip>
   <sect3 xml:id="self-sign-certificates">
    <title>Self-signed Certificates</title>
    <para>
     Creating a self-signed certificate for secure communication is simple.
     This way you can get the dashboard running quickly.
    </para>
    <note>
     <title>Web Browsers Complain</title>
     <para>
      Most Web browsers will complain about a self-signed certificate and
      require explicit confirmation before establishing a secure connection to
      the dashboard.
     </para>
    </note>
    <para>
     To generate and install a self-signed certificate, use the following
     built-in command:
    </para>
<screen>
&prompt.cephuser;ceph dashboard create-self-signed-cert
</screen>
   </sect3>
   <sect3 xml:id="cert-sign-CA">
    <title>Certificates Signed by CA</title>
    <para>
     To properly secure the connection to the dashboard and to eliminate Web
     browser complaints about a self-signed certificate, we recommend using a
     certificate that is signed by a CA.
    </para>
    <para>
     You can generate a certificate key pair with a command similar to the
     following:
    </para>
<screen>
&prompt.root;openssl req -new -nodes -x509 \
  -subj "/O=IT/CN=ceph-mgr-dashboard" -days 3650 \
  -keyout dashboard.key -out dashboard.crt -extensions v3_ca
</screen>
    <para>
     The above command outputs <filename>dashboard.key</filename> and
     <filename>dashboard.crt</filename> files. After you get the
     <filename>dashboard.crt</filename> file signed by a CA, enable it for all
     &mgr; instances by running the following commands:
    </para>
<screen>
&prompt.cephuser;ceph config-key set mgr/dashboard/crt -i dashboard.crt
&prompt.cephuser;ceph config-key set mgr/dashboard/key -i dashboard.key
</screen>
    <tip>
     <title>Different Certificates for Each Manager Instance</title>
     <para>
      If you require different certificates for each &mgr; instance, modify the
      commands and include the name of the instance as follows. Replace
      <replaceable>NAME</replaceable> with the name of the &mgr; instance
      (usually the related host name):
     </para>
<screen>
&prompt.cephuser;ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/crt -i dashboard.crt
&prompt.cephuser;ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/key -i dashboard.key
</screen>
    </tip>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-hostname-port">
   <title>Host Name and Port Number</title>
   <para>
    The &dashboard; Web application binds to a specific TCP/IP address and TCP
    port. By default, the currently active &mgr; that hosts the dashboard binds
    to TCP port 8443 (or 8080 when SSL is disabled).
   </para>
   <para>
    The dashboard Web application binds to "::" by default, which corresponds
    to all available IPv4 and IPv6 addresses. You can change the IP address and
    port number of the Web application so that they apply to all &mgr;
    instances by using the following commands:
   </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/server_addr <replaceable>IP_ADDRESS</replaceable>
&prompt.cephuser;ceph config set mgr mgr/dashboard/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   <tip>
    <title>Configure &mgr; Instances Separately</title>
    <para>
     Since each <systemitem class="daemon">ceph-mgr</systemitem> daemon hosts
     its own instance of the dashboard, you may need to configure them
     separately. Change the IP address and port number for a specific manager
     instance by using the following commands (replace
     <replaceable>NAME</replaceable> with the ID of the
     <systemitem class="daemon">ceph-mgr</systemitem> instance):
    </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_addr <replaceable>IP_ADDRESS</replaceable>
&prompt.cephuser;ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   </tip>
   <tip>
    <title>List Configured Endpoints</title>
    <para>
     The <command>ceph mgr services</command> command displays all endpoints
     that are currently configured. Look for the 'dashboard' key to obtain the
     URL for accessing the dashboard.
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dashboard-username-password">
   <title>User Name and Password</title>
   <para>
    If you do not want to use the default administrator account, create a
    different user account and associate it with at least one role. We provide
    a set of predefined system roles that you can use. For more details refer
    to <xref linkend="dashboard-user-roles" />.
   </para>
   <para>
    To create a user with administrator privileges, use the following command:
   </para>
<screen>
&prompt.cephuser;ceph dashboard ac-user-create <replaceable>USER_NAME</replaceable> <replaceable>PASSWORD</replaceable> administrator
</screen>
  </sect2>

  <sect2 xml:id="dashboard-ogw-enabling">
   <title>Enabling the &ogw; Management Front-end</title>
   <para>
    To use the &ogw; management functionality of the dashboard, you need to
    provide the login credentials of a user with the 'system' flag enabled:
   </para>
   <procedure>
    <step>
     <para>
      If you do not have a user with the 'system' flag, create one:
     </para>
<screen>
&prompt.cephuser;radosgw-admin user create --uid=<replaceable>USER_ID</replaceable> --display-name=<replaceable>DISPLAY_NAME</replaceable> --system
</screen>
     <para>
      Take note of the 'access_key' and 'secret_key' keys in the output of the
      command.
     </para>
    </step>
    <step>
     <para>
      You can also obtain the credentials of an existing user by using the
      <command>radosgw-admin</command> command:
     </para>
<screen>
&prompt.cephuser;radosgw-admin user info --uid=<replaceable>USER_ID</replaceable>
</screen>
    </step>
    <step>
     <para>
      Provide the received credentials to the dashboard:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-access-key <replaceable>ACCESS_KEY</replaceable>
&prompt.cephuser;ceph dashboard set-rgw-api-secret-key <replaceable>SECRET_KEY</replaceable>
</screen>
    </step>
   </procedure>
   <para>
    There are several points to consider:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      The host name and port number of the &ogw; are determined automatically.
     </para>
    </listitem>
    <listitem>
     <para>
      If multiple zones are used, it will automatically determine the host
      within the master zonegroup and master zone. This is sufficient for most
      setups, but in some circumstances you may want to set the host name and
      port manually:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-host <replaceable>HOST</replaceable>
&prompt.cephuser;ceph dashboard set-rgw-api-port <replaceable>PORT</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      These are additional settings that you may need:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-scheme <replaceable>SCHEME</replaceable>  # http or https
&prompt.cephuser;ceph dashboard set-rgw-api-admin-resource <replaceable>ADMIN_RESOURCE</replaceable>
&prompt.cephuser;ceph dashboard set-rgw-api-user-id <replaceable>USER_ID</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      If you are using a self-signed certificate
      (<xref linkend="dashboard-ssl" />) in your &ogw; setup, disable
      certificate verification in the dashboard to avoid refused connections
      caused by certificates signed by an unknown CA or not matching the host
      name:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-ssl-verify False
</screen>
    </listitem>
    <listitem>
     <para>
      If the &ogw; takes too long to process requests and the dashboard runs
      into timeouts, the timeout value can be adjusted (default is 45 seconds):
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rest-requests-timeout <replaceable>SECONDS</replaceable>
</screen>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="dashboard-sso">
   <title>Enable &sso;</title>
   <para>
    <emphasis>&sso;</emphasis> (SSO) is an access control method that enables
    users to log in with a single ID and password to multiple applications
    simultaneously.
   </para>
   <para>
    The &dashboard; supports external authentication of users via the SAML 2.0
    protocol. Because <emphasis>authorization</emphasis> is still performed by
    the dashboard, you first need to create user accounts and associate them
    with the desired roles. However, the <emphasis>authentication</emphasis>
    process can be performed by an existing <emphasis>Identity
    Provider</emphasis> (IdP).
   </para>
   <para>
    To configure &sso;, use the following command:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso setup saml2 <replaceable>CEPH_DASHBOARD_BASE_URL</replaceable> \
 <replaceable>IDP_METADATA</replaceable> <replaceable>IDP_USERNAME_ATTRIBUTE</replaceable> \
 <replaceable>IDP_ENTITY_ID</replaceable> <replaceable>SP_X_509_CERT</replaceable> \
 <replaceable>SP_PRIVATE_KEY</replaceable>
</screen>
   <para>
    Parameters:
   </para>
   <variablelist>
    <varlistentry>
     <term><replaceable>CEPH_DASHBOARD_BASE_URL</replaceable></term>
     <listitem>
      <para>
       Base URL where &dashboard; is accessible (for example,
       'https://cephdashboard.local').
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_METADATA</replaceable></term>
     <listitem>
      <para>
       URL, file path, or content of the IdP metadata XML (for example,
       'https://myidp/metadata').
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_USERNAME_ATTRIBUTE</replaceable></term>
     <listitem>
      <para>
       Optional. Attribute that will be used to get the user name from the
       authentication response. Defaults to 'uid'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_ENTITY_ID</replaceable></term>
     <listitem>
      <para>
       Optional. Use when more than one entity ID exists on the IdP metadata.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>SP_X_509_CERT</replaceable> / <replaceable>SP_PRIVATE_KEY</replaceable></term>
     <listitem>
      <para>
       Optional. File path or content of the certificate that will be used by
       &dashboard; (Service Provider) for signing and encryption.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <note>
    <title>SAML Requests</title>
    <para>
     The issuer value of SAML requests will follow this pattern:
    </para>
<screen>
<replaceable>CEPH_DASHBOARD_BASE_URL</replaceable>/auth/saml2/metadata
</screen>
   </note>
   <para>
    To display the current SAML 2.0 configuration, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso show saml2
</screen>
   <para>
    To disable &sso;, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso disable
</screen>
   <para>
    To check if SSO is enabled, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso status
</screen>
   <para>
    To enable SSO, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso enable saml2
</screen>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard-user-roles">
  <title>Managing Users and Roles on the Command Line</title>

  <para>
   This section describes how to manage user accounts used by the &dashboard;.
   It helps you create or modify user accounts, as well as set proper user
   roles and permissions.
  </para>

  <sect2 xml:id="dahsboard-user-accounts">
   <title>User Accounts</title>
   <para>
    The &dashboard; supports managing multiple user accounts. Each user account
    consists of a user name, a password (stored in encrypted form using
    <literal>bcrypt</literal>), an optional name, and an optional e-mail
    address.
   </para>
   <para>
    User accounts are stored in &mon;’s configuration database and are
    globally shared across all &mgr; instances.
   </para>
   <para>
    Use the following commands to manage user accounts:
   </para>
   <variablelist>
    <varlistentry>
     <term>Show existing users:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-show [<replaceable>USERNAME</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Create a new user:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-create <replaceable>USERNAME</replaceable> [<replaceable>PASSWORD</replaceable>] [<replaceable>ROLENAME</replaceable>] [<replaceable>NAME</replaceable>] [<replaceable>EMAIL</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Delete a user:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-delete <replaceable>USERNAME</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Change a user's password:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-password <replaceable>USERNAME</replaceable> <replaceable>PASSWORD</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Modify a user's name and email:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-info <replaceable>USERNAME</replaceable> <replaceable>NAME</replaceable> <replaceable>EMAIL</replaceable>
</screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard-permissions">
   <title>User Roles and Permissions</title>
   <para>
    This section describes what security scopes you can assign to a user role,
    how to manage user roles and assign them to user accounts.
   </para>
   <sect3>
    <title>Security Scopes</title>
    <para>
     User accounts are associated with a set of roles that define which parts
     of the dashboard can be accessed by the user. The dashboard parts are
     grouped within a <emphasis>security</emphasis> scope. Security scopes are
     predefined and static. The following security scopes are currently
     available:
    </para>
    <variablelist>
     <varlistentry>
      <term>hosts</term>
      <listitem>
       <para>
        Includes all features related to the <guimenu>Hosts</guimenu> menu
        entry.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>config-opt</term>
      <listitem>
       <para>
        Includes all features related to the management of &ceph; configuration
        options.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool</term>
      <listitem>
       <para>
        Includes all features related to pool management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>osd</term>
      <listitem>
       <para>
        Includes all features related to the &osd; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>monitor</term>
      <listitem>
       <para>
        Includes all features related to the &mon; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-image</term>
      <listitem>
       <para>
        Includes all features related to the &rbd; image management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-mirroring</term>
      <listitem>
       <para>
        Includes all features related to the &rbd; mirroring management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>iscsi</term>
      <listitem>
       <para>
        Includes all features related to &iscsi; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw</term>
      <listitem>
       <para>
        Includes all features related to the &ogw; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs</term>
      <listitem>
       <para>
        Includes all features related to &cephfs; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>manager</term>
      <listitem>
       <para>
        Includes all features related to the &mgr; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>log</term>
      <listitem>
       <para>
        Includes all features related to &ceph; logs management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>grafana</term>
      <listitem>
       <para>
        Includes all features related to the &grafana; proxy.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>dashboard-settings</term>
      <listitem>
       <para>
        Allows changing dashboard settings.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>User Roles</title>
    <para>
     A <emphasis>role</emphasis> specifies a set of mappings between a
     <emphasis>security scope</emphasis> and a set of
     <emphasis>permissions</emphasis>. There are four types of permissions:
     'read', 'create', 'update', and 'delete'.
    </para>
    <para>
     The following example specifies a role where a user has 'read' and
     'create' permissions for features related to pool management, and has full
     permissions for features related to RBD image management:
    </para>
<screen>
{
  'role': 'my_new_role',
  'description': 'My new role',
  'scopes_permissions': {
    'pool': ['read', 'create'],
    'rbd-image': ['read', 'create', 'update', 'delete']
  }
}
</screen>
    <para>
     The dashboard already provides a set of predefined roles that we call
     <emphasis>system roles</emphasis>. You can instantly use them after a
     fresh &dashboard; installation:
    </para>
    <variablelist>
     <varlistentry>
      <term>administrator</term>
      <listitem>
       <para>
        Provides full permissions for all security scopes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>read-only</term>
      <listitem>
       <para>
        Provides read permission for all security scopes except the dashboard
        settings.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>block-manager</term>
      <listitem>
       <para>
        Provides full permissions for 'rbd-image', 'rbd-mirroring', and 'iscsi'
        scopes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'rgw' scope.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cluster-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'hosts', 'osd', 'monitor', 'manager',
        and 'config-opt' scopes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'pool' scope.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'cephfs' scope.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <sect4>
     <title>Managing Custom Roles</title>
     <para>
      You can create new user roles by using the following commands:
     </para>
     <variablelist>
      <varlistentry>
       <term>Create a new role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-create <replaceable>ROLENAME</replaceable> [<replaceable>DESCRIPTION</replaceable>]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Delete a role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-delete <replaceable>ROLENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Add scope permissions to a role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-add-scope-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable> <replaceable>PERMISSION</replaceable> [<replaceable>PERMISSION</replaceable>...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Delete scope permissions from a role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-del-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
    </sect4>
    <sect4>
     <title>Assigning Roles to User Accounts</title>
     <para>
      Use the following commands to assign roles to users:
     </para>
     <variablelist>
      <varlistentry>
       <term>Set user roles:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Add additional roles to a user:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-add-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Delete roles from a user:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-del-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
     <tip>
      <title>Purging Custom Roles</title>
      <para>
       If you create custom user roles and intend to remove the &ceph; cluster
       with the <command>ceph.purge</command> runner later on, you need to
       purge the custom roles first. Find more details in
       <xref linkend="deepsea-ceph-purge"/>.
      </para>
     </tip>
    </sect4>
    <sect4>
     <title>Example: Creating a User and a Custom Role</title>
     <para>
      This section illustrates a procedure for creating a user account capable
      of managing RBD images, viewing and creating &ceph; pools, and having
      read-only access to any other scopes.
     </para>
     <procedure>
      <step>
       <para>
        Create a new user named 'tux':
       </para>
<screen>
 &prompt.cephuser;ceph dashboard ac-user-create tux <replaceable>PASSWORD</replaceable>
</screen>
      </step>
      <step>
       <para>
        Create a role and specify scope permissions:
       </para>
<screen>
&prompt.cephuser;ceph dashboard ac-role-create rbd/pool-manager
&prompt.cephuser;ceph dashboard ac-role-add-scope-perms rbd/pool-manager \
 rbd-image read create update delete
&prompt.cephuser;ceph dashboard ac-role-add-scope-perms rbd/pool-manager pool read create
</screen>
      </step>
      <step>
       <para>
        Associate the roles with the 'tux' user:
       </para>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-roles tux rbd/pool-manager read-only
</screen>
      </step>
     </procedure>
    </sect4>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard-proxy">
   <title>Reverse Proxies</title>
   <para>
    If you are accessing the dashboard via a reverse proxy configuration, you
    may need to service it under a URL prefix. To get the dashboard to use
    hyperlinks that include your prefix, you can set the
    <option>url_prefix</option> setting:
   </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/url_prefix <replaceable>URL_PREFIX</replaceable>
</screen>
   <para>
    Then you can access the dashboard at
    <literal>http://<replaceable>HOST_NAME</replaceable>:<replaceable>PORT_NUMBER</replaceable>/<replaceable>URL_PREFIX</replaceable>/</literal>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard-auditing">
   <title>Auditing</title>
   <para>
    The &dashboard;'s REST API can log PUT, POST, and DELETE requests to the
    &ceph; audit log. Logging is disabled by default, but you can enable it
    with the following command:
   </para>
<screen>
&prompt.cephuser;ceph dashboard set-audit-api-enabled true
</screen>
   <para>
    If enabled, the following parameters are logged per each request:
   </para>
   <variablelist>
    <varlistentry>
     <term>from</term>
     <listitem>
      <para>
       The origin of the request, for example 'https://[::1]:44410'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>path</term>
     <listitem>
      <para>
       The REST API path, for example '/api/auth'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>method</term>
     <listitem>
      <para>
       'PUT', 'POST', or 'DELETE'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>user</term>
     <listitem>
      <para>
       The name of the user (or ‘None’).
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    An example log entry looks like this:
   </para>
<screen>
2019-02-06 10:33:01.302514 mgr.x [INF] [DASHBOARD] \
 from='https://[::ffff:127.0.0.1]:37022' path='/api/rgw/user/exu' method='PUT' \
 user='admin' params='{"max_buckets": "1000", "display_name": "Example User", "uid": "exu", "suspended": "0", "email": "user@example.com"}'
</screen>
   <tip>
    <title>Disable Logging of Request Payload</title>
    <para>
     The logging of the request payload (the list of arguments and their
     values) is enabled by default. You can disable it as follows:
    </para>
<screen>
&prompt.cephuser;ceph dashboard set-audit-api-log-payload false
</screen>
   </tip>
  </sect2>
 </sect1>
</chapter>
