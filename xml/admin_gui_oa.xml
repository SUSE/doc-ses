<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="ceph-oa">
 <title>&oa;</title>
 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/maintenance/ses5.5/xml/</dm:editurl>
        <dm:translation>yes</dm:translation>
        <dm:release>SES 5</dm:release>
      </dm:docmanager>
    </info>
    <tip>
  <title>Calamari Removed</title>
  <para>
   Calamari used to be the preferred Web UI application for managing and
   monitoring the &ceph; cluster. Since &productname; &productnumber;, Calamari has been removed
   in favor of the more advanced &oa;.
  </para>
 </tip>
 <para>
  &oa; is a central storage management system which supports &ceph; storage
  cluster. With &oa;, you can control everything from a central management
  interface. It is no longer necessary to be familiar with the inner workings
  of the &ceph; storage tools. Cluster management tasks can be carried out
  either by using &oa;'s intuitive Web interface, or via its REST API.
 </para>
 <sect1 xml:id="ceph-oa-installation">
  <title>&oa; Deployment and Configuration</title>

  <para>
   This section introduces steps to deploy and configure &oa; and its supported
   features so that you can administer your &ceph; cluster using a
   user-friendly Web interface.
  </para>

  <sect2 xml:id="oa-ssl">
   <title>Enabling Secure Access to &oa; using SSL</title>
   <para>
    Access to the &oa; Web application uses non-secure HTTP protocol by
    default. To enable secure access to &oa;, you need to configure the Apache
    Web server manually:
   </para>
   <procedure>
    <step>
     <para>
      If you do not have an SSL certificate signed by a well known certificate
      authority (CA), create a self-signed SSL certificate and copy its files
      to the directory where the Web server expects it, for example:
     </para>
<screen>
&prompt.root;openssl req -newkey rsa:2048 -new -nodes -x509 -days 3650 \
 -keyout key.pem -out cert.pem
&prompt.root;cp cert.pem /etc/ssl/certs/servercert.pem
&prompt.root;cp key.pem /etc/ssl/certs/serverkey.pem
</screen>
     <para>
      Refer to
      <link xlink:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/sec_apache2_ssl.html"/>
      for more details on creating SSL certificates.
     </para>
    </step>
    <step>
     <para>
      Add 'SSL' to the <option>APACHE_SERVER_FLAGS</option> option in the
      <filename>/etc/sysconfig/apache2</filename> configuration file. You can
      do it manually, or run the following commands:
     </para>
<screen>
&prompt.root;a2enmod ssl
&prompt.root;a2enflag SSL
</screen>
    </step>
    <step>
     <para>
      Create <filename>/etc/apache2/vhosts.d/vhost-ssl.conf</filename> for a
      new Apache virtual host with the following content:
     </para>
<screen>
&lt;IfDefine SSL&gt;
&lt;IfDefine !NOSSL&gt;
&lt;VirtualHost *:80&gt;
 ServerName <replaceable>OA_HOST_NAME</replaceable>
 Redirect "/" "https://<replaceable>OA_HOST_NAME</replaceable>/"
&lt;/VirtualHost&gt;
&lt;VirtualHost _default_:443&gt;
 ServerName <replaceable>OA_HOST_NAME</replaceable>
 DocumentRoot "/srv/www/htdocs"
 ErrorLog /var/log/apache2/error_log
 TransferLog /var/log/apache2/access_log
 SSLEngine on
 SSLCertificateFile /etc/ssl/certs/servercert.pem
 SSLCertificateKeyFile /etc/ssl/certs/serverkey.pem
 CustomLog /var/log/apache2/ssl_request_log ssl_combined
&lt;/VirtualHost&gt;
&lt;/IfDefine&gt;
&lt;/IfDefine&gt;
</screen>
    </step>
    <step>
     <para>
      Restart the Web server to reload the new virtual host definition together
      with the certificate files:
     </para>
<screen>
&prompt.root;systemctl restart apache2.service
</screen>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="oa-deploy">
   <title>Deploying &oa;</title>
   <para>
    Since &productname; &productnumber;, &oa; has been deployed as a &deepsea; role. Refer to
    <xref linkend="storage-salt-cluster"/> for a general procedure.
   </para>
  </sect2>

  <sect2 xml:id="ceph-oa-install-oa">
   <title>&oa; Initial Setup</title>
   <para>
    By default, <command>oaconfig</command> creates an administrative user
    account, <systemitem>openattic</systemitem>, with the same password as the
    user name. As a security precaution, we strongly recommend changing this
    password immediately:
   </para>
<screen>&prompt.cephuser;oaconfig changepassword openattic
Changing password for user 'openattic'
Password: &lt;enter password&gt;
Password (again): &lt;re-enter password&gt;
Password changed successfully for user 'openattic'
</screen>
  </sect2>

  <sect2 xml:id="oa-ds">
   <title>&deepsea; Integration in &oa;</title>
   <para>
    Some &oa; features, such as &igw; and &ogw; management, make use of the
    &deepsea; REST API. It is enabled and configured by default. If you need to
    override its default settings for debugging purposes, edit
    <filename>/etc/sysconfig/openattic</filename> and add or change the
    following lines:
   </para>
<screen>SALT_API_HOST="<replaceable>salt_api_host</replaceable>"
SALT_API_PORT=8001
SALT_API_USERNAME="example_user"
SALT_API_PASSWORD="password"</screen>
   <important>
    <title><command>oaconfig restart</command></title>
    <para>
     Remember to run <command>oaconfig restart</command> after you make changes
     to the <filename>/etc/sysconfig/openattic</filename> file.
    </para>
   </important>
   <important>
    <title>File Syntax</title>
    <para>
     <filename>/etc/sysconfig/openattic</filename> is used in Python as well as
     Bash. Therefore, the files need to be in a format which Bash can
     understand, and it is not possible to have spaces before or after the
     'equals' signs.
    </para>
   </important>
  </sect2>

  <sect2 xml:id="oa-rgw">
   <title>&ogw; Management</title>
   <para>
    &ogw; management features in &oa; are enabled by default. If you need to
    override the default values for &ogw; API as discovered from &deepsea;,
    include the following options with relevant values in
    <filename>/etc/sysconfig/openattic</filename>. For example:
   </para>
<screen>RGW_API_HOST="<replaceable>rgw_api_host</replaceable>"
RGW_API_PORT=80
RGW_API_SCHEME="http"
RGW_API_ACCESS_KEY="VFEG733GBY0DJCIV6NK0"
RGW_API_SECRET_KEY="lJzPbZYZTv8FzmJS5eiiZPHxlT2LMGOMW8ZAeOAq"</screen>
   <note>
    <title>Default Resource for &ogw;</title>
    <para>
     If your &ogw; admin resource is not configured to use the default value
     'admin' as used in 'http://rgw_host:80/admin', you need to also set the
     <option>RGW_API_ADMIN_RESOURCE</option> option appropriately.
    </para>
   </note>
   <para>
    To obtain &ogw; credentials, use the <command>radosgw-admin</command>
    command:
   </para>
<screen>&prompt.cephuser;radosgw-admin user info --uid=admin</screen>
  </sect2>

  <sect2 xml:id="oa-igw">
   <title>&igw; Management</title>
   <para>
    &igw; management features in &oa; are enabled by default. If you need
    override the default &salt; API host name, change the
    <option>SALT_API_HOST</option> value as described in
    <xref linkend="oa-ds"/>.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="ceph-oa-install-webui">
  <title>&oa; Web User Interface</title>

  <para>
   &oa; can be managed using a Web user interface. Open a Web browser and
   navigate to http://<replaceable>SERVER_HOST</replaceable>/openattic. To log
   in, use the default user name <emphasis>openattic</emphasis> and the
   corresponding password.
  </para>

  <figure>
   <title>&oa; Login Screen</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_login.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_login.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   The &oa; user interface is graphically divided into a top menu pane and a
   content pane.
  </para>

  <para>
   The right part of the top pane includes a link to the current user settings,
   and a <guimenu>Logout</guimenu> link, and links to the list of existing
   <guimenu>Background tasks</guimenu> and system
   <guimenu>Notifications</guimenu>. The rest of the top pane includes the main
   &oa; menu.
  </para>

  <para>
   The content pane changes depending on which item menu is activated. By
   default, a <guimenu>Dashboard</guimenu> is displayed showing a number
   widgets to inform you about the status of the cluster.
  </para>

  <figure>
   <title>&oa; Dashboard</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_dashboard.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_dashboard.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="ceph-oa-webui-dash">
  <title>Dashboard</title>

  <para>
   Each <guimenu>Dashboard</guimenu> widget shows specific status information
   related to the running &ceph; cluster. After clicking the title of a widget,
   the widget spreads across the whole content pane, possibly showing more
   details. A list of several widgets follows:
  </para>

  <para>
   The <guimenu>Status</guimenu> widget tells whether the cluster is operating
   correctly. In case a problem is detected, you can view the detailed error
   message by clicking the subtitle inside the widget.
  </para>

  <para>
   The <guimenu>Monitors in Quorum</guimenu>, <guimenu>Pools</guimenu>,
   <guimenu>OSDs In</guimenu>, <guimenu>OSDs Out</guimenu>, <guimenu>OSDs
   Up</guimenu>, <guimenu>OSDs Down</guimenu>, and <guimenu>Average PGs per
   OSD</guimenu> widgets simply show the related numbers.
  </para>

  <figure>
   <title>Basic Widgets</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_basic_widgets.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_basic_widgets.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   The following widgets deal with total and available storage capacity:
   <guimenu>Cluster Capacity</guimenu>, <guimenu>Available Capacity</guimenu>,
   <guimenu>Used Capacity</guimenu>, and <guimenu>Capacity</guimenu>.
  </para>

  <figure>
   <title>Capacity Widgets</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_capacity_widgets.png" width="75%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_capacity_widgets.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   The following widgets deal with OSD and monitor node latency:
   <guimenu>Average OSD Apply Latency</guimenu>, <guimenu>Average OSD Commit
   Latency</guimenu>, and <guimenu>Average Monitor Latency</guimenu>:
  </para>

  <figure>
   <title>Latency Widgets</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_latency_widgets.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_latency_widgets.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   The <guimenu>Throughput</guimenu> widget shows the read and write per second
   statistics in time.
  </para>

  <figure>
   <title>Throughput</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_io.png" width="60%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_io.png" width="60%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <tip>
   <title>More Details on Mouse Over</title>
   <para>
    If you move the mouse pointer over any of the displayed charts, you will be
    shown more details related to the date and time pointed at in a pop-up
    window.
   </para>
   <para>
    If you click in the chart area and then drag the mouse pointer to the left
    or right along the time axis, the time interval on the axis will be zoomed
    in to the interval you marked by moving the mouse. To zoom out back to the
    original scale, double-click the chart.
   </para>
  </tip>
  <para>Within &oa; there are options to display graphs for longer than
    15 days. However, by default &prometheus; only stores history for 15 days.
    You can adjust this behavior in <filename>/etc/systemd/system/multi-user.target.wants/prometheus.service</filename>.</para>
  <procedure>
    <step>
      <para>
        Open <filename>/etc/systemd/system/multi-user.target.wants/prometheus.service</filename>.
      </para>
    </step>
    <step>
      <para>
        This file should reference the following:
      </para>
      <screen>
        EnvironmentFile=-/etc/sysconfig/prometheus
        ExecStart=/usr/bin/prometheus $ARGS
      </screen>
      <para>If not does not, add the above two lines and include
        the following:</para>
      <screen>
        ARGS="--storage.tsdb.retention=90d" \
              --log.level=warn"
      </screen>
      <tip>
        <para>Ensure <literal>ARGS</literal> is a multiline bash string.
        This enables &prometheus; to store up to 90 days of data.</para>
        <para>If you want other time options, the format is as follows:
          <replaceable>number</replaceable> X <replaceable>time multiplier</replaceable>
          (where <replaceable>time multiplier</replaceable> can be h[ours], d[ays], w[eeks],
          y[ears]).</para>
      </tip>
    </step>
    <step>
      <para>
        Restart the &prometheus; service.
      </para>
    </step>
  </procedure>
 </sect1>

 <sect1 xml:id="ceph-oa-webui-ceph">
  <title>&ceph; Related Tasks</title>

  <para>
   &oa;'s main menu lists &ceph; related tasks. Currently, the following tasks
   are relevant: <guimenu>OSDs</guimenu>, <guimenu>RBDs</guimenu>,
   <guimenu>Pools</guimenu>, <guimenu>Nodes</guimenu>,
   <guimenu>iSCSI</guimenu>, <guimenu>NFS</guimenu>, <guimenu>CRUSH
   Map</guimenu>, and <guimenu>Object Gateway</guimenu>.
  </para>

  <sect2>
   <title>Common Web UI Features</title>
   <para>
    In &oa;, you often work with <emphasis>lists</emphasis>&mdash;for example,
    lists of pools, OSD nodes, or RBD devices. The following common widgets
    help you manage or adjust these list:
   </para>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> to refresh the list of items.
   </para>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> to display or hide individual table columns.
   </para>
   <para>
    Click <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> and select how many rows to display on a single page.
   </para>
   <para>
    Click inside <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> and filter the rows by typing the string to search
    for.
   </para>
   <para>
    Use <inlinemediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
    </imageobject>
    </inlinemediaobject> to change the currently displayed page if the list
    spans across multiple pages.
   </para>
  </sect2>

  <sect2>
   <title>Listing OSD Nodes</title>
   <para>
    To list all available OSD nodes, click <guimenu>OSDs</guimenu> from the
    main menu.
   </para>
   <para>
    The list shows each OSD's name, host name, status, weight, and storage
    back-end.
   </para>
   <figure>
    <title>List of OSD nodes</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_osds.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_osds.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="oa-rbds">
   <title>Managing RADOS Block Devices (RBDs)</title>
   <para>
    To list all available &rbd;s, click <guimenu>RBDs</guimenu> from the main
    menu.
   </para>
   <para>
    The list shows each device's name, the related pool name, size of the
    device, and, if 'fast-diff' was enabled during the &rbd; creation, the
    percentage that is already occupied.
   </para>
   <figure>
    <title>List of RBDs</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbds.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbds.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3>
    <title>Status Information</title>
    <para>
     To view more detailed information about a device, activate its check box
     in the very left column:
    </para>
    <figure>
     <title>RBD Details</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_rbd_status.png" width="40%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_rbd_status.png" width="40%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3>
    <title>Statistics</title>
    <para>
     Click the <guimenu>Statistics</guimenu> tab of an &rbd; to view the
     statistics of transferred data. You can zoom in and out the time range
     either by highlighting the time range with a mouse, or by selecting it
     after clicking the date in the top left corner of the tab.
    </para>
   </sect3>
   <sect3>
    <title>&rbd; Snapshots</title>
    <para>
     To create an &rbd; snapshot, click its <guimenu>Snapshots</guimenu> tab
     and select <guimenu>Create</guimenu> from the left top drop-down box.
    </para>
    <para>
     After selecting a snapshot, you can rename, protect, clone, or delete it.
     Deletion also works if you select multiple snapshots.
     <guimenu>Rollback</guimenu> restores the device's state from the current
     snapshot.
    </para>
    <figure>
     <title>RBD Snapshots</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_rbd_snapshots.png" width="90%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_rbd_snapshots.png" width="90%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3>
    <title>Deleting RBDs</title>
    <para>
     To delete a device or a group of devices, activate their check boxes in
     the very left column and click <guimenu>Delete</guimenu> in the top-left
     of the RBDs table:
    </para>
    <figure>
     <title>Deleting RBD</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_rbd_delete.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_rbd_delete.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3>
    <title>Adding RBDs</title>
    <para>
     To add a new device, click <guimenu>Add</guimenu> in the top left of the
     RBDs table and do the following on the <guimenu>Create RBD</guimenu>
     screen:
    </para>
    <figure>
     <title>Adding a New RBD</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_rbd_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_rbd_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       Enter the name of the new device. Refer to
       <xref linkend="sysreq-naming"/> for naming limitations.
      </para>
     </step>
     <step>
      <para>
       Select the cluster that will store the new pool.
      </para>
     </step>
     <step>
      <para>
       Select the pool from which the new RBD device will be created.
      </para>
     </step>
     <step>
      <para>
       Specify the size of the new device. If you click the <guimenu>use
       max</guimenu> link above, the maximum pool size is populated.
      </para>
     </step>
     <step>
      <para>
       To fine-tune the device parameters, click <guimenu>Expert
       settings</guimenu> and activate or deactivate the displayed options.
      </para>
     </step>
     <step>
      <para>
       Confirm with <guimenu>Create</guimenu>.
      </para>
     </step>
    </procedure>
   </sect3>
  </sect2>

  <sect2>
   <title>Managing Pools</title>
   <tip>
    <title>More Information on Pools</title>
    <para>
     For more general information about &ceph; pools, refer to
     <xref linkend="ceph-pools"/>. For information specific to erasure coded
     pools, refer to <xref linkend="cha-ceph-erasure"/>.
    </para>
   </tip>
   <para>
    To list all available pools, click <guimenu>Pools</guimenu> from the main
    menu.
   </para>
   <para>
    The list shows each pool's name, ID, the percentage of used space, the
    number of placement groups, replica size, type ('replicated' or 'erasure'),
    erasure code profile, and the CRUSH ruleset.
   </para>
   <figure>
    <title>List of Pools</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    To view more detailed information about a pool, activate its check box in
    the very left column:
   </para>
   <figure>
    <title>Pool Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_pools_status.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_pools_status.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3>
    <title>Deleting Pools</title>
    <para>
     To delete a pool or a group of pools, activate their check boxes in the
     very left column and click <guimenu>Delete</guimenu> in the top left of
     the pools table:
    </para>
    <figure>
     <title>Deleting Pools</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_pools_delete.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_pools_delete.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3>
    <title>Adding Pools</title>
    <para>
     To add a new pool, click <guimenu>Add</guimenu> in the top left of the
     pools table and do the following on the <guimenu>Create Ceph
     pool</guimenu> screen:
    </para>
    <figure>
     <title>Adding a New Pool</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       Enter the name of the new pool. Refer to <xref linkend="sysreq-naming"/>
       for naming limitations.
      </para>
     </step>
     <step>
      <para>
       Select the cluster that will store the new pool.
      </para>
     </step>
     <step>
      <para>
       Select the pool type. Pools can be either replicated or erasure coded.
      </para>
     </step>
     <step>
      <substeps>
       <step>
        <para>
         For a replicated pool, specify the replica size and the number of
         placement groups.
        </para>
       </step>
       <step>
        <para>
         For an erasure code pool, specify the number of placement groups and
         erasure code profile. You can add your custom profile by clicking the
         plus '+' sign and specifying the profile name, data and coding chunks,
         and a ruleset failure domain.
        </para>
       </step>
      </substeps>
     </step>
     <step>
      <para>
       Confirm with <guimenu>Create</guimenu>.
      </para>
     </step>
    </procedure>
   </sect3>
  </sect2>

  <sect2 xml:id="ceph-oa-minions">
   <title>Listing Nodes</title>
   <para>
    Click <guimenu>Nodes</guimenu> from the main menu to view the list of nodes
    available on the cluster.
   </para>
   <figure>
    <title>List of Nodes</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_minion.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_minion.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Each node is represented by its host name, public IP address, cluster ID it
    belongs to, node role (for example, 'admin', 'storage', or 'master'), and
    key acceptance status.
   </para>
  </sect2>

  <sect2 xml:id="oa-webui-nfs">
   <title>Managing &ganesha;</title>
   <tip>
    <title>More Information on &ganesha;</title>
    <para>
     For more general information about &ganesha;, refer to
     <xref linkend="cha-ceph-nfsganesha"/>.
    </para>
   </tip>
   <para>
    To list all available NFS exports, click <guimenu>NFS</guimenu> from the
    main menu.
   </para>
   <para>
    The list shows each export's directory, host name, status, type of storage
    back-end, and access type.
   </para>
   <figure>
    <title>List of NFS Exports</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    To view more detailed information about an NFS export, activate its check
    box in the very left column:
   </para>
   <figure>
    <title>NFS Export Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <tip>
    <title>NFS Mount Command</title>
    <para>
     At the bottom of the export detailed view, there is a mount command for
     you to be able to easily mount the related NFS export from a client
     machine.
    </para>
   </tip>
   <sect3>
    <title>Adding NFS Exports</title>
    <para>
     To add a new NFS export, click <guimenu>Add</guimenu> in the top left of
     the exports table and enter the required information.
    </para>
    <figure>
     <title>Adding a New NFS Export</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       Select a server host for the NFS export.
      </para>
     </step>
     <step>
      <para>
       Select a storage back-end&mdash;either <guimenu>CephFS</guimenu> or
       <guimenu>Object Gateway</guimenu>.
      </para>
     </step>
     <step>
      <para>
       Enter the directory path for the NFS export. If the directory does not
       exist on the server, it will be created.
      </para>
     </step>
     <step>
      <para>
       Specify other NFS related options, such as supported NFS protocol
       version, access type, squashing, or transport protocol.
      </para>
     </step>
     <step>
      <para>
       If you need to limit access to specific clients only, click <guimenu>Add
       clients</guimenu> and add their IP addresses together with access type
       and squashing options.
      </para>
     </step>
     <step>
      <para>
       Confirm with <guimenu>Submit</guimenu>.
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3>
    <title>Cloning and Deleting NFS Exports</title>
    <para>
     To delete an export or a group of exports, activate their check boxes in
     the very left column and select <guimenu>Delete</guimenu> in the top left
     of the exports table.
    </para>
    <para>
     Similarly, you can select <guimenu>Clone</guimenu> to clone the activated
     gateway.
    </para>
   </sect3>
   <sect3>
    <title>Editing NFS Exports</title>
    <para>
     To edit an existing export, either click its name in the exports table, or
     activate its check box and click <guimenu>Edit</guimenu> in the top left
     of the exports table.
    </para>
    <para>
     You can then adjust all the details of the NFS export.
    </para>
    <figure>
     <title>Editing an NFS Export</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
  </sect2>

  <sect2 xml:id="oa-webui-iscsi">
   <title>Managing &igw;s</title>
   <tip>
    <title>More Information on &igw;s</title>
    <para>
     For more general information about &igw;s, refer to
     <xref linkend="cha-ceph-as-iscsi"/> and <xref linkend="cha-ceph-iscsi"/>.
    </para>
   </tip>
   <para>
    To list all available gateways, click <guimenu>iSCSI</guimenu> from the
    main menu.
   </para>
   <para>
    The list shows each gateway's target, state, and related portals and RBD
    images.
   </para>
   <figure>
    <title>List of &igw;s</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_igws.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_igws.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    To view more detailed information about a gateway, activate its check box
    in the very left column:
   </para>
   <figure>
    <title>Gateway Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_igws_status.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3>
    <title>Adding &igw;s</title>
    <para>
     To add a new &igw;, click <guimenu>Add</guimenu> in the top left of the
     gateways table and enter the required information.
    </para>
    <figure>
     <title>Adding a New &igw;</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_igws_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       Enter the target address of the new gateway.
      </para>
     </step>
     <step>
      <para>
       Click <guimenu>Add portal</guimenu> and select one or multiple iSCSI
       portals from the list.
      </para>
     </step>
     <step>
      <para>
       Click <guimenu>Add image</guimenu> and select one or multiple RBD images
       for the gateway.
      </para>
     </step>
     <step>
      <para>
       If you need to use authentication to access the gateway, activate the
       <guimenu>Authentication</guimenu> check box and enter the credentials.
       You can find more advanced authentication options after activating
       <guimenu>Mutual authentication</guimenu> and <guimenu>Discovery
       authentication</guimenu>.
      </para>
     </step>
     <step>
      <para>
       Confirm with <guimenu>Submit</guimenu>.
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3>
    <title>Editing &igw;s</title>
    <para>
     To edit an existing &igw;, either click its name in the gateways table, or
     activate its check box and click <guimenu>Edit</guimenu> in the top left
     of the gateways table.
    </para>
    <para>
     You can then modify the &iscsi; target, add or delete portals, and add or
     delete related RBD images. You can also adjust authentication information
     for the gateway.
    </para>
   </sect3>
   <sect3>
    <title>Cloning and Deleting &igw;s</title>
    <para>
     To delete a gateway or a group of gateways, activate their check boxes in
     the very left column and select <guimenu>Delete</guimenu> in the top left
     of the gateways table.
    </para>
    <para>
     Similarly, you can select <guimenu>Clone</guimenu> to clone the activated
     gateway.
    </para>
   </sect3>
   <sect3>
    <title>Starting and Stopping &igw;s</title>
    <para>
     To start all gateways, select <guimenu>Start all</guimenu> in the top left
     of the gateways table. To stop all gateways, select <guimenu>Stop
     all</guimenu>.
    </para>
   </sect3>
  </sect2>

  <sect2 xml:id="ceph-oa-crushmap">
   <title>Viewing the Cluster &crushmap;</title>
   <para>
    Click <guimenu>CRUSH Map</guimenu> from the main menu to view cluster
    &crushmap;.
   </para>
   <figure>
    <title>CRUSH Map</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_crush.png" width="60%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_crush.png" width="60%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    In the <guimenu>Physical setup</guimenu> pane, you can see the structure of
    the cluster as described by the &crushmap;.
   </para>
   <para>
    In the <guimenu>Replication rules</guimenu> pane, you can view individual
    rulesets after selecting one of them from the <guimenu>Content</guimenu>
    drop-down box.
   </para>
   <figure>
    <title>Replication rules</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_crush_rulesets.png" width="60%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_crush_rulesets.png" width="60%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="oa-webui-rgw-users">
   <title>Managing &ogw; Users and Buckets</title>
   <tip>
    <title>More Information on &ogw;s</title>
    <para>
     For more general information about &ogw;s, refer to
     <xref linkend="cha-ceph-gw"/>.
    </para>
   </tip>
   <para>
    To list &ogw; users, select <menuchoice><guimenu>Object
    Gateway</guimenu><guimenu>Users</guimenu></menuchoice> from the main menu.
   </para>
   <para>
    The list shows each user's ID, display name, e-mail address, if the user is
    suspended, and the maximum number of buckets for the user.
   </para>
   <figure>
    <title>List of &ogw; Users</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rgw_users_list.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rgw_users_list.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <sect3 xml:id="oa-rgw-user-add">
    <title>Adding a New &ogw; User</title>
    <para>
     To add a new &ogw; user, click <guimenu>Add</guimenu> in the top left of
     the users' table and enter the relevant information.
    </para>
    <tip>
     <title>More Information</title>
     <para>
      Find more information about &ogw; user accounts in
      <xref linkend="s3-swift-accounts-managment"/>.
     </para>
    </tip>
    <figure>
     <title>Adding a New &ogw; User</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_rgw_users_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_rgw_users_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <procedure>
     <step>
      <para>
       Enter the user name, full name, and optionally an e-mail address and the
       maximum number of buckets for the user.
      </para>
     </step>
     <step>
      <para>
       If the user should be initially suspended, activate the
       <guimenu>Suspended</guimenu> check box.
      </para>
     </step>
     <step>
      <para>
       Specify the access and secret keys for the S3 authentication. If you
       want &oa; to generate the keys for you, activate <guimenu>Generate
       key</guimenu>.
      </para>
     </step>
     <step>
      <para>
       In the <guimenu>User quota</guimenu> section, set quota limits for the
       current user.
      </para>
      <para>
       Check <guimenu>Enabled</guimenu> to activate the user quota limits. You
       can either specify the <guimenu>Maximum size</guimenu> of the disk space
       the user can use within the cluster, or check <guimenu>Unlimited
       size</guimenu> for no size limit.
      </para>
      <para>
       Similarly, specify <guimenu>Maximum objects</guimenu> that the user can
       store on the cluster storage, or <guimenu>Unlimited objects</guimenu> if
       the user may store any number of objects.
      </para>
      <figure>
       <title>User quota</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="oa_rgw_userquota.png" width="70%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="oa_rgw_userquota.png" width="70%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       In the <guimenu>Bucket Quota</guimenu> section, set the bucket quota
       limits for the current user.
      </para>
      <figure>
       <title>Bucket Quota</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="oa_rgw_bucketquota.png" width="70%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="oa_rgw_bucketquota.png" width="70%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
     <step>
      <para>
       Confirm with <guimenu>Submit</guimenu>.
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3>
    <title>Deleting &ogw; Users</title>
    <para>
     To delete one or more &ogw; users, activate their check boxes in the very
     left column and select <guimenu>Delete</guimenu> in the top left of the
     users table.
    </para>
   </sect3>
   <sect3 xml:id="oa-user-edit">
    <title>Editing &ogw; Users</title>
    <para>
     To edit the user information of an &ogw; user, either activate their check
     box in the very left column and select <guimenu>Edit</guimenu> in the top
     left of the users table, or click their ID. You can change the information
     you entered when adding the user in <xref linkend="oa-rgw-user-add"/>,
     plus the following additional information:
    </para>
    <variablelist>
     <varlistentry>
      <term>Subusers</term>
      <listitem>
       <para>
        Add, remove, or edit subusers of the currently edited user.
       </para>
       <figure>
        <title>Adding a Subuser</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="oa_rgw_subuser_add.png" width="70%" format="PNG"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="oa_rgw_subuser_add.png" width="70%" format="PNG"/>
         </imageobject>
        </mediaobject>
       </figure>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Keys</term>
      <listitem>
       <para>
        Add, remove, or view access and secret keys of the currently edited
        user.
       </para>
       <para>
        You can add S3 keys for the currently edited user, or view Swift keys
        for their subusers.
       </para>
       <figure>
        <title>View S3 keys</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="oa_rgw_user_s3key_edit.png" width="70%" format="PNG"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="oa_rgw_user_s3key_edit.png" width="70%" format="PNG"/>
         </imageobject>
        </mediaobject>
       </figure>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Capabilities</term>
      <listitem>
       <para>
        Add or remove user's capabilities. The capabilities apply to
        <guimenu>buckets</guimenu>, <guimenu>zone</guimenu>,
        <guimenu>users</guimenu>, <guimenu>metadata</guimenu>, and
        <guimenu>usage</guimenu>. Each capability value can be one of 'read',
        'write', or '*' for read and write privilege.
       </para>
       <figure>
        <title>Capabilities</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="oa_rgw_user_capabs.png" width="70%" format="PNG"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="oa_rgw_user_capabs.png" width="70%" format="PNG"/>
         </imageobject>
        </mediaobject>
       </figure>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3 xml:id="oa-ogw-bucket-list">
    <title>Listing Buckets for &ogw; Users</title>
    <tip>
     <para>
      A bucket is a mechanism for storing data objects. A user account may have
      many buckets, but bucket names must be unique. Although the term 'bucket'
      is normally used within the Amazon S3 API, the term 'container' is used
      in the &ostack; Swift API context.
     </para>
    </tip>
    <para>
     Click <menuchoice><guimenu>Object
     Gateway</guimenu><guimenu>Buckets</guimenu></menuchoice> to list all
     available &ogw; buckets.
    </para>
    <figure>
     <title>&ogw; Buckets</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="os_ogw_bucket_list.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="os_ogw_bucket_list.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3 xml:id="oa-ogw-bucket-add">
    <title>Adding Buckets for &ogw; Users</title>
    <para>
     To add a new bucket, click <guimenu>Add</guimenu> in the top left of the
     buckets table and enter the new bucket name and the related &ogw; user.
     Confirm with <guimenu>Submit</guimenu>.
    </para>
    <figure>
     <title>Adding a New Bucket</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_ogw_bucket_add.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_ogw_bucket_add.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3 xml:id="oa-ogw-bucket-view">
    <title>Viewing Bucket Details</title>
    <para>
     To view detailed information about an &ogw; bucket, activate its check box
     in the very left column of the buckets table.
    </para>
    <figure>
     <title>Bucket Details</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_ogw_bucket_view.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_ogw_bucket_view.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect3>
   <sect3 xml:id="oa-ogw-bucket-edit">
    <title>Editing Buckets</title>
    <para>
     To edit a bucket, either activate its check box in the very left column
     and select <guimenu>Edit</guimenu> in the top left of the buckets table,
     or click its name.
    </para>
    <figure>
     <title>Editing an &ogw; Bucket</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_ogw_bucket_edit.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_ogw_bucket_edit.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <para>
     On the edit screen, you can change the user to which the bucket belongs.
    </para>
   </sect3>
   <sect3 xml:id="oa-ogw-bucket-delete">
    <title>Deleting Buckets</title>
    <para>
     To delete one or more &ogw; buckets, activate their check boxes in the
     very left column of the buckets table, and select
     <guimenu>Delete</guimenu> in the top left of the table.
    </para>
    <figure>
     <title>Deleting Buckets</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="oa_ogw_buckets_delete.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="oa_ogw_buckets_delete.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <para>
     To confirm the deletion, type 'yes' in the <guimenu>Delete
     buckets</guimenu> pop-up window, and click <guimenu>Delete</guimenu>.
    </para>
    <warning>
     <title>Careful Deletion</title>
     <para>
      When deleting an &ogw; bucket, it is currently not verified if the bucket
      is actually in use, for example by &ganesha; via the S3 storage back-end.
     </para>
    </warning>
   </sect3>
  </sect2>
 </sect1>
</chapter>
